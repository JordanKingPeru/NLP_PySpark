{"paragraphs":[{"text":"%md\n# Migración del código elaborado en R Studio al notebook de Zeppelin\nLa fomra de migración se realizará en bloques. ","dateUpdated":"2019-03-13T15:39:30-0400","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Migración del código elaborado en R Studio al notebook de Zeppelin</h1>\n<p>La fomra de migración se realizará en bloques.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1552505970490_-773431333","id":"20190219-171706_1639802652","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:77578"},{"text":"%livy2.pyspark\nActividades_riesgo = spark.createDataFrame([\n    (\"55205\",\"RESTAURANTES, BARES Y CANTINAS.\"),\n    (\"92123\",\"EXHIBICION FILMES Y VIDEOS\"),\n    (\"92149\",\"ACTIV.TEATRALES, MUSICALES Y OTRAS.\"),\n    (\"92192\",\"OTRAS ACTIVID.ENTRETENIMIENTO NCP.\"),\n    (\"92413\",\"ACTIVIDADES DEPORTIVAS\"),\n    (\"92495\",\"OTRAS ACTIVIDADES DE ESPARCIMIENTO\"),\n    (\"85111\",\"ACTIVIDADES DE HOSPITALES\"),\n    (\"85124\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGO\"),\n    (\"85193\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANA\"),\n    (\"55104\",\"HOTELES, CAMPAMENTOS Y OTROS.\"),\n    (\"63040\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.\")\n], [\"cod_act_princ\", \"actividad_principal\"])\n\nActividades_riesgo.createOrReplaceTempView(\"act_riesgo\")","dateUpdated":"2019-03-13T15:39:30-0400","config":{"tableHide":false,"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970493_-776124575","id":"20190313-105939_346753455","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77579"},{"text":"%livy2.pyspark\nEmpresas_riesgo = spark.createDataFrame([\n(\"20427799973\",\"MODA\",\"Calzado\",\"Passarela\"),\n(\"20514811271\",\"MODA\",\"Calzado\",\"Hush Puppies\"),\n(\"20523991141\",\"MODA\",\"Calzado\",\"Gorillas\"),\n(\"20101951872\",\"MODA\",\"Calzado\",\"Bata Kids\"),\n(\"20374412524\",\"MODA\",\"Calzado\",\"Azaleia\"),\n(\"20555448750\",\"MODA\",\"Deportes\",\"CitySports\"),\n(\"20417531026\",\"MODA\",\"Deportes\",\"Triathlon\"),\n(\"20600892470\",\"MODA\",\"Deportes\",\"Nike\"),\n(\"20467015347\",\"MODA\",\"Deportes\",\"Marathon\"),\n(\"20554468579\",\"MODA\",\"Deportes\",\"Lippi\"),\n(\"20459980963\",\"MODA\",\"Deportes\",\"Coliseum Sport.\"),\n(\"20108022702\",\"MODA\",\"Deportes\",\"Armaq.\"),\n(\"20347100316\",\"MODA\",\"Deportes\",\"Adidas\"),\n(\"20348525531\",\"MODA\",\"Moda\",\"STRATA Store\"),\n(\"20492016307\",\"MODA\",\"Moda\",\"Maloko\"),\n(\"20505773170\",\"MODA\",\"carteras y Maletas\",\"Porta\"),\n(\"20520673670\",\"MODA\",\"Moda Hombre\",\"dc shoes\"),\n(\"20101958451\",\"MODA\",\"Moda Hombre\",\"Trial\"),\n(\"20516463121\",\"MODA\",\"Moda Hombre\",\"BROOKS BROTHERS\"),\n(\"20504116728\",\"MODA\",\"Moda Hombre\",\"nautica\"),\n(\"20521886448\",\"MODA\",\"Moda Hombre\",\"do it accesorios\"),\n(\"20100199158\",\"MODA\",\"Tiendas x Departamento\",\"Estilos\"),\n(\"20109072177\",\"MODA\",\"Tiendas x Departamento\",\"paris\"),\n(\"20109072177\",\"MODA\",\"Tiendas x Departamento\",\"wong\"),\n(\"20492092313\",\"MODA\",\"Tiendas x Departamento\",\"makro\"),\n(\"20109072177\",\"MODA\",\"Tiendas x Departamento\",\"metro\"),\n(\"20431062870\",\"MODA\",\"articulos infantiles\",\"Baby infanti Store\"),\n(\"20431062870\",\"MODA\",\"articulos infantiles\",\"Lego\"),\n(\"20374412524\",\"MODA\",\"Calzado\",\"Olympikus\"),\n(\"20601668999\",\"MODA\",\"Calzado\",\"BAMERS\"),\n(\"20388121816\",\"MODA\",\"Calzado\",\"Sdely\"),\n(\"20100490081\",\"MODA\",\"Calzado\",\"Foresta\"),\n(\"20427799973\",\"MODA\",\"Calzado\",\"Top Model\"),\n(\"20600983360\",\"MODA\",\"Calzado\",\"Payless Shoesource\"),\n(\"20101941991\",\"MODA\",\"Calzado\",\"Guante\"),\n(\"20102097069\",\"MODA\",\"Calzado\",\"Ecco\"),\n(\"20101951872\",\"MODA\",\"Calzado\",\"Bata\"),\n(\"20101920721\",\"MODA\",\"Calzado\",\"Platanitos\"),\n(\"20340155115\",\"MODA\",\"Calzado\",\"Viale\"),\n(\"20600508548\",\"MODA\",\"Calzado\",\"Skechers\"),\n(\"20100282721\",\"MODA\",\"Calzado\",\"Calimod Store\"),\n(\"20562780361\",\"MODA\",\"Deportes\",\"The Roller Factory\"),\n(\"20555435348\",\"MODA\",\"Deportes\",\"Under Armour\"),\n(\"20100004756\",\"MODA\",\"Deportes\",\"Monark\"),\n(\"20502485009\",\"MODA\",\"Deportes\",\"Big head\"),\n(\"20512002685\",\"MODA\",\"Deportes\",\"The Athletes Foot\"),\n(\"20303672606\",\"MODA\",\"Moda\",\"Moda y CIA\"),\n(\"20524257514\",\"MODA\",\"Moda\",\"Colloky\"),\n(\"20522936694\",\"MODA\",\"Moda\",\"Meylin\"),\n(\"20510983662\",\"MODA\",\"Moda\",\"Moixx\"),\n(\"20102266359\",\"MODA\",\"Moda\",\"Kids Made Here\"),\n(\"20600364376\",\"MODA\",\"Moda\",\"Brunella Horna\"),\n(\"20100108616\",\"MODA\",\"Moda\",\"Adams\"),\n(\"20390148314\",\"MODA\",\"Moda\",\"Joaquim Miro\"),\n(\"20100089051\",\"MODA\",\"Moda\",\"Lancaster\"),\n(\"20117470271\",\"MODA\",\"Moda\",\"Baby Club Chic\"),\n(\"20555881551\",\"MODA\",\"Moda\",\"H y M\"),\n(\"20544014189\",\"MODA\",\"Moda\",\"Woallance\"),\n(\"20100047056\",\"MODA\",\"Moda\",\"Topi Top\"),\n(\"20503800331\",\"MODA\",\"Moda\",\"The Cult.\"),\n(\"20430772873\",\"MODA\",\"Moda\",\"Pierre Cardin\"),\n(\"20549705449\",\"MODA\",\"Moda\",\"Mundo Comics\"),\n(\"20144422199\",\"MODA\",\"Moda\",\"Mentha y Chocolate\"),\n(\"20432759335\",\"MODA\",\"Moda\",\"Mentha y Chocolate\"),\n(\"20506877327\",\"MODA\",\"Moda\",\"Camila Viali\"),\n(\"20348233166\",\"MODA\",\"Moda\",\"DVK by Dunkelvolk\"),\n(\"20295798140\",\"MODA\",\"Moda\",\"You Too\"),\n(\"20522936694\",\"MODA\",\"Moda\",\"Pionier\"),\n(\"20507590323\",\"MODA\",\"Moda\",\"Kukuli\"),\n(\"20102309180\",\"MODA\",\"Moda\",\"Koketa\"),\n(\"20492465527\",\"MODA\",\"Moda\",\"Kayser\"),\n(\"20296897338\",\"MODA\",\"Moda\",\"Michelle Belau\"),\n(\"20100108705\",\"MODA\",\"Moda\",\"EL\"),\n(\"20418567695\",\"MODA\",\"Moda\",\"Brujhas\"),\n(\"20138998780\",\"MODA\",\"carteras y Maletas\",\"Renzo Costa\"),\n(\"20600788729\",\"MODA\",\"Moda Hombre\",\"Totto\"),\n(\"20100128056\",\"MODA\",\"Moda Hombre\",\"la martina\"),\n(\"20509240257\",\"MODA\",\"Moda Infantil\",\"infanti\"),\n(\"20337564373\",\"MODA\",\"Moda Infantil\",\"mothercare\"),\n(\"20553224145\",\"MODA\",\"Moda Infantil\",\"nua\"),\n(\"20102234236\",\"MODA\",\"Moda Infantil\",\"nunu\"),\n(\"20348233166\",\"MODA\",\"Moda Hombre\",\"dunkelvolk\"),\n(\"20102266359\",\"MODA\",\"Moda Infantil\",\"kids made here\"),\n(\"20102309180\",\"MODA\",\"Moda\",\"koketa\"),\n(\"20301409151\",\"MODA\",\"Moda\",\"leonisa\"),\n(\"20100128056\",\"MODA\",\"Moda\",\"Mango\"),\n(\"10411021233\",\"ENTRETENIMIENTO\",\"Discoteka\",\"Chango\"),\n(\"20101062148\",\"ENTRETENIMIENTO\",\"Juego nino\",\"Play Land Park\"),\n(\"20108254743\",\"ENTRETENIMIENTO\",\"Discoteka\",\"Moon Light\"),\n(\"20108254743\",\"ENTRETENIMIENTO\",\"Discoteka\",\"Star Light\"),\n(\"20112378864\",\"ENTRETENIMIENTO\",\"Juego nino\",\"La granja azul\"),\n(\"20200565178\",\"ENTRETENIMIENTO\",\"Discoteka\",\"Ucucus\"),\n(\"20306713923\",\"ENTRETENIMIENTO\",\"Juego nino\",\"Coney Park\"),\n(\"20414686614\",\"ENTRETENIMIENTO\",\"Juego nino\",\"Granja Aventura Park\"),\n(\"20450763854\",\"ENTRETENIMIENTO\",\"Discoteka\",\"Caos\"),\n(\"20490338692\",\"ENTRETENIMIENTO\",\"Discoteka\",\"Mitology\"),\n(\"20504875718\",\"ENTRETENIMIENTO\",\"Juego nino\",\"Zoologico de Huachipa\"),\n(\"20516822032\",\"ENTRETENIMIENTO\",\"Discoteka\",\"Discoteca Seven (Alredodores de Megaplaza)\"),\n(\"20524790298\",\"ENTRETENIMIENTO\",\"Discoteka\",\"PK2\"),\n(\"20527067007\",\"ENTRETENIMIENTO\",\"Discoteka\",\"Fallen angel\"),\n(\"20527187754\",\"ENTRETENIMIENTO\",\"Discoteka\",\"Muky\"),\n(\"20543849716\",\"ENTRETENIMIENTO\",\"Spa\",\"Smik\"),\n(\"20555396008\",\"ENTRETENIMIENTO\",\"Discoteka\",\"Discoteca Magno\"),\n(\"20561167886\",\"ENTRETENIMIENTO\",\"Discoteka\",\"Night Disco\"),\n(\"20566286221\",\"ENTRETENIMIENTO\",\"Discoteka\",\"Discoteca Voce\"),\n(\"20450295818\",\"ENTRETENIMIENTO\",\"Discoteka\",\"Discoteca Anaconda\")\n\n], [\"ruc\", \"actividad_principal\",\"detalle\",\"nombre_comercial\"])\n\nEmpresas_riesgo.createOrReplaceTempView(\"emp_riesgo\")","dateUpdated":"2019-03-13T15:39:30-0400","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970497_-789975536","id":"20190313-110513_1936916548","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77580"},{"text":"%livy2.sql\nselect cod_tipcomp,count(*) from factura_electronica.t4241detcpe_2018_11 group by 1 order by 2 desc","user":"jrodriguez","dateUpdated":"2019-03-13T16:41:29-0400","config":{"tableHide":false,"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"cod_tipcomp\tcount(1)\n01\t73444510"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970500_-791129783","id":"20190313-121837_1039321960","dateCreated":"2019-03-13T15:39:30-0400","dateStarted":"2019-03-13T16:41:29-0400","dateFinished":"2019-03-13T16:41:43-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:77581"},{"text":"%livy2.pyspark\nfrom pyspark.sql.functions import * \ndf_header = spark.read.option(\"header\", False).option(\"delimiter\",\"|\").csv(\"hdfs:///user/lchacon/detalle_noviembre_02.unl\")\ndf_final = df_header.select(col(\"_c0\").alias(\"num_ruc\"), col(\"_c1\").alias(\"cod_tipcomp\"), col(\"_c2\").alias(\"num_serie_cpe\"),col(\"_c3\").alias(\"num_cpe\"),col(\"_c7\").alias(\"des_detalle_item\"))\ndf_final.write.format(\"parquet\").saveAsTable(\"factura_electronica.t4241detcpe_2018_11\")\n\n","dateUpdated":"2019-03-13T15:39:30-0400","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970502_-790360285","id":"20190312-183148_1151810250","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77582"},{"text":"%livy2.pyspark\nfrom pyspark.sql.functions import * \ndf_final = spark.read.option(\"header\", False).option(\"delimiter\",\"|\").csv(\"hdfs:///user/lchacon/cab_noviembre.unl\")\ndf_final = df_final.select(col(\"_c0\").alias(\"num_ruc\"), col(\"_c1\").alias(\"cod_cpe\"), col(\"_c2\").alias(\"num_serie_cpe\"),col(\"_c3\").alias(\"num_cpe\"),col(\"_c4\").alias(\"cod_tipo_cpe\"),\ncol(\"_c5\").alias(\"cod_docide_recep\"),col(\"_c6\").alias(\"num_docide_recep\"),col(\"_c7\").alias(\"cod_moneda\"),col(\"_c8\").alias(\"mto_importe_totaL\"),col(\"_c9\").alias(\"fec_emision\"),col(\"_c10\").alias(\"mto_total_igv\"),col(\"_c11\").alias(\"mto_total_venta\"),col(\"_c12\").alias(\"num_cuo_regven\"))\ndf_final.write.format(\"parquet\").saveAsTable(\"factura_electronica.t4241cabcpe_2018_11\")","dateUpdated":"2019-03-13T15:39:30-0400","config":{"tableHide":true,"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970504_-792668778","id":"20190312-183338_998426837","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77583"},{"text":"%livy2.pyspark\nfrom pyspark.sql.functions import * \ndf_final = spark.read.option(\"header\", False).option(\"delimiter\",\"|\").csv(\"hdfs:///user/lchacon/ficha_nacional_luis.unl\")\ndf_final = df_final.select(col(\"_c0\").alias(\"ruc\"), col(\"_c1\").alias(\"razon_social\"), col(\"_c2\").alias(\"dependencia\"),col(\"_c3\").alias(\"condicion\"),col(\"_c4\").alias(\"estado\"),\ncol(\"_c5\").alias(\"nom_comercial\"),col(\"_c6\").alias(\"tipo_emp\"),col(\"_c7\").alias(\"tamano\"),col(\"_c8\").alias(\"cod_act_princ\"),col(\"_c9\").alias(\"act_principal\"),col(\"_c10\").alias(\"act_secun1\"),col(\"_c11\").alias(\"act_secun2\"),col(\"_c12\").alias(\"cond_domicilio\"),col(\"_c13\").alias(\"ubigeo\"),col(\"_c14\").alias(\"telef_1\"),col(\"_c15\").alias(\"correo_1\"),col(\"_c16\").alias(\"correo_2\"),col(\"_c17\").alias(\"correo_1\"),col(\"_c16\").alias(\"correo_2\"))\ndf_final.show()\n","dateUpdated":"2019-03-13T15:39:30-0400","config":{"tableHide":true,"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+--------------------+----+--------------------+---------------+--------------------+--------------------+---------+-----+--------------------+--------------------+----+-----+------+-------+-------+--------------------+--------------------+----+\n|        _c0|                 _c1| _c2|                 _c3|            _c4|                 _c5|                 _c6|      _c7|  _c8|                 _c9|                _c10|_c11| _c12|  _c13|   _c14|   _c15|                _c16|                _c17|_c18|\n+-----------+--------------------+----+--------------------+---------------+--------------------+--------------------+---------+-----+--------------------+--------------------+----+-----+------+-------+-------+--------------------+--------------------+----+\n|20251357413|        E & M S.R.L.|0011|              HABIDO|         ACTIVO|          E & M  SRL|SOC.COM.RESPONS. ...|PRINCIPAL|51906|VTA. MAY. DE OTRO...|                null|null|PROPI|150140|4254429|      -|pedrojacinto@eymp...|contabilidad.sap@...|null|\n|20100287448|CRUZ Y COMPA�IA S...|0023|          NO HABIDO.| BAJA DE OFICIO|CRUZ&CIA SAC EDIT...|SOCIEDAD ANONIMA ...|    RESTO|22214|ACTIVIDADES DE IM...|                null|null|ALQUI|150116| 312158|      -|cruzcia@speedy.co...| cruzcia@cruzcia.com|null|\n|20100367476|LUBRICENTRO SAN J...|0023|              HABIDO| BAJA DE OFICIO|            LUBRISAJ|SOC.COM.RESPONS. ...|    RESTO|50304|VENTA PARTES, PIE...|OTRAS ACTIVID.DE ...|null|PROPI|150133|4662962|      -|serviciosjcr@hotm...|                   -|null|\n|10091820400|BUSTINZA CUENTAS ...|0023|              HABIDO|         ACTIVO|                   -|PERSONA NATURAL S...|    RESTO|70109|ACTIVIDADES INMOB...|                null|null|OTROS|150130|      -|      -|                   -|                   -|null|\n|20155008165|INTERNATIONAL EXP...|0011|              HABIDO|BAJA DEFINITIVA|INTERNATIONAL EXP...|  SOCIEDAD IRREGULAR|  MEDIANO|63093|ORGANIZACION DEL ...|                null|null| null|070101|      -|       |                   -|                   -|null|\n|20101293115|COATS CADENA SOCI...|0023|              HABIDO|         ACTIVO|    COATS CADENA S A|    SOCIEDAD ANONIMA|  MEDIANO|51313|VTA. MAY. PRODUCT...|                null|null|OTROS|150131|      -|      -|francined.guerrer...|estuardo.ledesma@...|null|\n|20100056632|CIA MINERA ALGAMA...|0023|          NO HABIDO.| BAJA DE OFICIO|                   -|    SOCIEDAD ANONIMA|    RESTO|13200|EXT. DE MIN. META...|                null|null|ALQUI|150117|4763891|4449825|domingosilva2005@...|                   -|null|\n|17250004982| TAYPE CERRENOS JUAN|0023|NO HALLADO RECHAZADO| BAJA DE OFICIO|             MI PERU|PERSONA NATURAL C...|    RESTO|55205|RESTAURANTES, BAR...|                null|null| null|150104|      -|      -|                   -|                   -|null|\n|20440360701|MADERERA VH INTER...|0023|          NO HABIDO.| BAJA DE OFICIO|           VH S.A.C.|SOCIEDAD ANONIMA ...|    RESTO|51906|VTA. MAY. DE OTRO...|                null|null|ALQUI|150142|2911802| 201895|christian_cordero...|                   -|null|\n|10325440274|GOMEZ IPANAQUE WI...|0083|              HABIDO|         ACTIVO|                   -|PERSONA NATURAL S...|    RESTO|74996|OTRAS ACTIVIDADES...|                null|null|OTROS|200401|      -|      -|WILLIANCETPRO@HOT...|                   -|null|\n|20101478913|EDIFICIOS PRIVADO...|0023|          NO HABIDO.| BAJA DE OFICIO|EDIFICIOS PRIVADO...|    SOCIEDAD ANONIMA|    RESTO|74996|OTRAS ACTIVIDADES...|                null|null| null|150131|4412201|      -|acanturin@GWIESE.COM|                   -|null|\n|10441144151|MARREROS MESTANZA...|0063|              HABIDO|         ACTIVO|                   -|PERSONA NATURAL S...|    RESTO|93098|OTRAS ACTIVID.DE ...|                null|null|PROPI|130101|      -|      -|                   -|                   -|null|\n|10079910100|IGREDA HUAMAN MAN...|0023|              HABIDO|         ACTIVO|                   -|PERSONA NATURAL S...|    RESTO|93098|OTRAS ACTIVID.DE ...|                null|null|PROPI|150117|      -|       |                   -|                   -|null|\n|20100074886|CIA NYLON PERUANA...|0011|              HABIDO|BAJA DEFINITIVA|CIA NYLON PERUANA SA|    SOCIEDAD ANONIMA|PRINCIPAL|17306|FAB. TEJIDOS Y AR...|                null|null| null|150105|4330131|4333836|                   -|                   -|null|\n|20391323381|CORPORACION TRANS...|0023|          NO HABIDO.|BAJA DEFINITIVA|      TRANSCONT PERU|SOCIEDAD ANONIMA ...|    RESTO|51225|VTA. MAY. ALIMENT...|                null|null|ALQUI|150122|4720909|      -|lguerrero@mlv.com.pe| fmunayco@mlv.com.pe|null|\n|20122482538|TEXTIL SANTA ANIT...|0023|              HABIDO|         ACTIVO|                   -|    SOCIEDAD ANONIMA|    RESTO|17117|PREP Y TEJ DE FIB...|                null|null|ALQUI|150114|3624187|      -| fdiaalf@hotmail.com|                   -|null|\n|10461920581|DELGADO MEZA CRIS...|0023|              HABIDO|         ACTIVO|                   -|PERSONA NATURAL S...|    RESTO|74996|OTRAS ACTIVIDADES...|                null|null|OTROS|070103|      -|      -| cmeza2022@gmail.com|cristian18096@gma...|null|\n|20490363883|HUACOCCORY - INGE...|0093|              HABIDO| BAJA DE OFICIO|                   -|EMPRESA INDIVIDUA...|    RESTO|74218|ACTIV.DE ARQUITEC...|                null|null|OTROS|030213|      -|      -|  ke_thy@hotmail.com|                   -|null|\n|10093699021|FIERRO JOYO ULISE...|0023|              HABIDO| BAJA DE OFICIO|                   -|PERSONA NATURAL C...|    RESTO|15202|ELAB DE PRODUCTOS...|                null|null| null|150137|      -|      -|                   -|                   -|null|\n|10079436319|MOSCOSO CAVALLINI...|0023|              HABIDO|         ACTIVO|                   -|PERSONA NATURAL S...|    RESTO|93098|OTRAS ACTIVID.DE ...|                null|null|OTROS|150121|      -|      -|                   -|                   -|null|\n+-----------+--------------------+----+--------------------+---------------+--------------------+--------------------+---------+-----+--------------------+--------------------+----+-----+------+-------+-------+--------------------+--------------------+----+\nonly showing top 20 rows"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0682<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0682/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0682/</a>"}]},"apps":[],"jobName":"paragraph_1552505970505_-793053527","id":"20190313-113247_834179845","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77584"},{"text":"%livy2.sql\nselect * from ds02_gastos_no_deducibles.t4241cabcpe_2018_11\n\n","dateUpdated":"2019-03-13T15:39:30-0400","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(1)\n26536507"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0682<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0682/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0682/</a>"}]},"apps":[],"jobName":"paragraph_1552505970506_-791899280","id":"20190312-183314_1039396784","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77585"},{"title":"01.Ficha Nacional de Receptores","text":"%livy2.sql\ncreate table ds02_gastos_no_deducibles.201811_rec_ficha_nacional as \nselect a.ruc as rec_ruc, razon_social as rec_razon_social,nom_comercial as rec_nom_comercial,dependencia as rec_dependencia,condicion as rec_condicion,estado as rec_estado,tipo_emp as rec_tipo_emp,tamano as rec_tamano,cod_act_princ as rec_cod_act_princ, act_principal as rec_act_principal,act_secun1 as rec_act_secun1,act_secun2 as rec_act_secun2,contabilidad as rec_contabilidad,facturacion as rec_facturacion, comercio_ext as rec_comercio_ext,cond_domicilio as rec_cond_domicilio,ubigeo as rec_ubigeo,desc_ubigeo as rec_desc_ubigeo,telef_1 as rec_telef_1,telef_2 as rec_telef_2,telef_3 as rec_telef_3,fax_1 as rec_fax_1,correo_1 as rec_correo_1,correo_2 as rec_correo_2  \nfrom db_tributario.mod_ficha_nacional_20190208 a\ninner join (select distinct trim(num_docide_recep) as num_docide_recep from factura_electronica.t4241cabcpe_2018_11 where cod_cpe = \"01\") b on a.ruc = trim(b.num_docide_recep)\nwhere tipo_emp not in ('ASOCIACION','GOBIERNO REGIONAL, LOCAL','EMPRESA DE DERECHO PUBLICO','SOCIEDAD CIVIL','COOPERATIVAS, SAIS, CAPS','FUNDACION','INSTITUCIONES RELIGIOSAS','SOCIEDAD DE BENEFICIENCIA','ENT.INST.COOPERAC.TECNICA - ENIEX','SINDICATOS Y FEDERACIONES','JUNTA DE PROPIETARIOS','EMPRESA DE PROPIEDAD SOCIAL')","dateUpdated":"2019-03-13T15:39:30-0400","config":{"tableHide":true,"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970508_-794207774","id":"20190227-103736_1706090981","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77586"},{"text":"%livy2.sql\nselect count(distinct rec_ruc), count(*) from ds02_gastos_no_deducibles.201811_rec_ficha_nacional","dateUpdated":"2019-03-13T15:39:30-0400","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"table","height":84,"optionOpen":false}}},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(DISTINCT rec_ruc)\tcount(1)\n1053790\t1053790"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970509_-794592523","id":"20190313-133118_1322283270","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77587"},{"title":"02.Ficha Nacional de Emisores","text":"%livy2.sql\ncreate table ds02_gastos_no_deducibles.201811_emi_ficha_nacional as \nselect distinct ruc as emi_ruc, a.razon_social as emi_razon_social,nom_comercial as emi_nom_comercial,dependencia as emi_dependencia,condicion as emi_condicion,estado as emi_estado,tipo_emp as emi_tipo_emp,tamano as emi_tamano,cod_act_princ as emi_cod_act_princ, act_principal as emi_act_principal,act_secun1 as emi_act_secun1,act_secun2 as emi_act_secun2,contabilidad as emi_contabilidad,facturacion as emi_facturacion, comercio_ext as emi_comercio_ext,cond_domicilio as emi_cond_domicilio,ubigeo as emi_ubigeo,desc_ubigeo as emi_desc_ubigeo,telef_1 as emi_telef_1,telef_2 as emi_telef_2,telef_3 as emi_telef_3,fax_1 as emi_fax_1,correo_1 as emi_correo_1,correo_2 as emi_correo_2  \n\nfrom (select a.*\n    from db_tributario.mod_ficha_nacional_20190208 a\n    inner join emp_riesgo c on a.ruc = c.ruc\n    \n    union\n    \n    select a.*\n    from db_tributario.mod_ficha_nacional_20190208 a\n    inner join act_riesgo c on a.cod_act_princ = c.cod_act_princ) a\ninner join (select distinct num_ruc from factura_electronica.t4241cabcpe_2018_11 where cod_cpe = \"01\") b on a.ruc = b.num_ruc","dateUpdated":"2019-03-13T15:39:30-0400","config":{"tableHide":true,"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970511_-793823025","id":"20190227-114343_1142669847","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77588"},{"text":"%livy2.sql\nselect count(distinct emi_ruc), count(*) from ds02_gastos_no_deducibles.201811_emi_ficha_nacional","dateUpdated":"2019-03-13T15:39:30-0400","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"table","height":84,"optionOpen":false}}},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(DISTINCT emi_ruc)\tcount(1)\n14242\t14242"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970512_-783434805","id":"20190313-133316_1831492877","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77589"},{"title":"03.MD_Factura","text":"%livy2.sql\ncreate table ds02_gastos_no_deducibles.201811_md_factura as \nselect concat(cod_tipocomp,'_',num_ruc,'_',num_seriecpe,'_',num_cpe) as llave_cpe,a.*,\n        case when cod_moneda = 'USD' then mto_impcpe*3.35 else mto_impcpe end as mto_impcpe_soles,\n        case when cod_moneda = 'USD' then mto_igvcpe*3.35 else mto_igvcpe end as mto_igvcpe_soles,\n        case when cod_moneda = 'USD' then mto_vtacpe*3.35 else mto_vtacpe end as mto_vtacpe_soles,\n        date_format(cast(to_date(from_unixtime(unix_timestamp(fec_emicpe, 'yyyy-MM-dd'))) as date),'u') as dia_semana_cpe,\n        date_format(cast(to_date(from_unixtime(unix_timestamp(fec_emicpe, 'yyyy-MM-dd'))) as date),'d') as dia_mes_cpe,\n        case when date_format(cast(to_date(from_unixtime(unix_timestamp(fec_emicpe, 'yyyy-MM-dd'))) as date),'d')<=3 then 'Inicio_mes[1-3]'\n             when date_format(cast(to_date(from_unixtime(unix_timestamp(fec_emicpe, 'yyyy-MM-dd'))) as date),'d')>=25 then 'Fin_mes[25-31]' \n             else \"Otros[4-24]\"\n        end as dia_mes_cat,\n        b.*,c.*\nfrom (select cod_cpe as cod_tipocomp,num_ruc,num_serie_cpe as num_seriecpe,num_cpe,num_docide_recep as num_docidenti, cod_moneda,mto_importe_total as mto_impcpe,mto_total_igv as mto_igvcpe,mto_total_venta as mto_vtacpe,fec_emision as fec_emicpe from factura_electronica.t4241cabcpe_2018_11 where cod_cpe = \"01\") a\ninner join ds02_gastos_no_deducibles.201811_emi_ficha_nacional b on trim(a.num_ruc) = b.emi_ruc\ninner join ds02_gastos_no_deducibles.201811_rec_ficha_nacional c on trim(a.num_docidenti) = c.rec_ruc\nwhere (rec_act_principal != emi_act_principal) and (rec_act_principal != nvl(emi_act_secun1,'emi_null1')) and (rec_act_principal != nvl(emi_act_secun2,'emi_null2')) and (nvl(rec_act_secun1,'rec_null1') != emi_act_principal) and (nvl(rec_act_secun1,'rec_null1') != nvl(emi_act_secun1,'emi_null1')) and (nvl(rec_act_secun1,'rec_null1') != nvl(emi_act_secun2,'emi_null2')) and (nvl(rec_act_secun2,'rec_null2') != emi_act_principal) and (nvl(rec_act_secun2,'rec_null2') != nvl(emi_act_secun1,'emi_null1')) and (nvl(rec_act_secun2,'rec_null2') != nvl(emi_act_secun2,'emi_null2'))","dateUpdated":"2019-03-13T15:39:30-0400","config":{"tableHide":true,"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970514_-782665307","id":"20190227-171129_1353741576","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77590"},{"text":"%livy2.sql\nselect count(distinct llave_cpe), count(*) from ds02_gastos_no_deducibles.201811_md_factura","dateUpdated":"2019-03-13T15:39:30-0400","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"table","height":84,"optionOpen":false}}},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(DISTINCT llave_cpe)\tcount(1)\n408150\t408150"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970515_-783050056","id":"20190313-134107_1746510114","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77591"},{"title":"04.MD Detalle","text":"%livy2.sql\ncreate table ds02_gastos_no_deducibles.201811_md_detalle as \nselect a.des_detalle_item as des_detitm, b.*\nfrom factura_electronica.t4241detcpe_2018_11 a \ninner join ds02_gastos_no_deducibles.201811_md_factura b on a.num_ruc = b.num_ruc and a.num_serie_cpe = b.num_seriecpe and a.num_cpe = b.num_cpe  \nwhere des_detalle_item not in (\"\\\\N\",\"\")","dateUpdated":"2019-03-13T15:39:30-0400","config":{"tableHide":true,"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970516_-784973800","id":"20190228-120030_251572520","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77592"},{"text":"%livy2.sql\nselect count(distinct llave_cpe), count(*), count(distinct emi_ruc),count(distinct rec_ruc) from ds02_gastos_no_deducibles.201811_md_detalle","dateUpdated":"2019-03-13T15:39:30-0400","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"table","height":88,"optionOpen":false}}},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(DISTINCT llave_cpe)\tcount(1)\tcount(DISTINCT emi_ruc)\tcount(DISTINCT rec_ruc)\n407395\t1930749\t5178\t80313"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970518_-784204302","id":"20190313-150757_2002704021","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77593"},{"title":"05.Palabras llave r","text":"%livy2.sql\ncreate table ds02_gastos_no_deducibles.201811_palabras_llave_r as\nselect llave_cpe,rec_act_principal,rec_act_secun1,rec_act_secun2,nitems,trim(descripcion) as descripcion\nfrom(select llave_cpe,rec_act_principal,rec_act_secun1,rec_act_secun2,count(*) as nitems,concat_ws(' ',collect_list(des_detitm)) as descripcion from ds02_gastos_no_deducibles.201811_md_detalle\n    group by llave_cpe,rec_act_principal,rec_act_secun1,rec_act_secun2) a\nwhere descripcion != \"\"\n\n","dateUpdated":"2019-03-13T15:39:30-0400","config":{"tableHide":true,"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970519_-784589051","id":"20190228-121401_1210212686","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77594"},{"text":"%livy2.sql\nselect count(distinct llave_cpe),count(*),count(distinct rec_act_principal) from ds02_gastos_no_deducibles.201811_palabras_llave_r","dateUpdated":"2019-03-13T15:39:30-0400","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"table","height":84,"optionOpen":false}}},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(DISTINCT llave_cpe)\tcount(1)\tcount(DISTINCT rec_act_principal)\n407395\t407395\t281"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970521_-786897545","id":"20190313-151043_1241942564","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77595"},{"text":"%md\n# Bloque 1\nrm(list = ls())\ngc()\nlibrary(tictoc)\n\n#-------Limpieza detalle------\nlibrary(data.table)\nlibrary(tm)\nlibrary(stringr)\nlibrary(stringi)\n\nmemory.limit(size = 12000)\n\ndetalle <- fread('mod_detalle_cpe.csv',nrows = 1000)\n\ndetalle=detalle[,c(2,1,3,4,8)]\ncolnames(detalle)=c(\"COD_TIPOCOMP\", \"NUM_RUC\", \"NUM_SERIECPE\", \"NUM_CPE\", \"DES_DETITM\")\n\nfwrite(detalle, file = \"cpes.csv\",row.names = F)\n\nrm(list = ls())\ngc()\n\ntopes <- c(1,seq(1000001,90000001, 1000000))\nnombres <- c(\"COD_TIPOCOMP\", \"NUM_RUC\", \"NUM_SERIECPE\", \"NUM_CPE\", \"DES_DETITM\")\n\n\nfor (i in 1:length(topes)) {\n  cpes <- fread(\"mod_detalle_cpe.csv\", nrows = 1000000, skip = topes[i],header =  F)\n  cpes <- unique(cpes)\n  names(cpes) <-  nombres\n  \n  cpes$DES_DETITM <- stri_trim(cpes$DES_DETITM)\n  cpes$DES_DETITM <- stri_trans_tolower(cpes$DES_DETITM)\n  cpes$DES_DETITM <- removeWords(cpes$DES_DETITM, stopwords(kind = \"spanish\"))\n  cpes$DES_DETITM <- removePunctuation(cpes$DES_DETITM, \n                                       preserve_intra_word_contractions = FALSE, \n                                       preserve_intra_word_dashes = FALSE)\n  cpes$DES_DETITM <- removeNumbers(cpes$DES_DETITM)\n  cpes$DES_DETITM <- stripWhitespace(cpes$DES_DETITM)\n  fwrite(cpes, file = paste(\"mod_cpes_\",i,\".csv\",sep=\"\"), row.names = F)\n  print(paste(\"vamos en \", i, \" de \", length(topes)))\n}\n\nrm(cpes)\ngc()\ncpes_l=NULL\n\nfor (j in 1:(i-1)) {\n  #j=1\n  cpes=fread(paste(\"mod_cpes_\",j,\".csv\",sep=\"\"), header = TRUE)\n  cpes_l=rbind(cpes_l, cpes)\n  print(paste(\"vamos en \", j, \" de \", (i-1)))\n}\n\ncpes_l <- unique(cpes_l)\n\nfwrite(cpes_l, file = \"mod_cpes_limpio_enero_19.csv\", row.names = F)\n\n\n\n#-------Emisores de riesgo------\nrm(list = ls())\ngc()\nlibrary(tidyverse)\nlibrary(data.table)\nlibrary(stringi)\nlibrary(corpus)\nlibrary(tictoc)\n\nmemory.limit(size = 12000) #Mejora el rendimiento de la memoria RAM\n\nFichaEmisor_CIIU <- fread(\"mod_FichaEmisor_CIIU.csv\", colClasses = rep(\"character\",13))\n\n# cabecera <- fread(\"cabecera_cpe_octubre2018.unl\")\n# View(head(cabecera,13000))\n# fwrite(cabecera, \"cabecera_cpe_octubre2018.unl\", row.names = F, sep = \"|\")\n\ncabecera <- fread(\"mod_cabecera_cpe.csv\", nrows = 100)\nnombres <- names(cabecera)\nnombres <- nombres[c(2,1,3,4,7,8,12,11,10)]\n\ncabecera <- fread(\"mod_cabecera_cpe.csv\", \n                  sep = \",\", \n                  col.names = nombres, \n                  colClasses=list(character=1:6))\n\nnombres <- c(\"COD_TIPOCOMP\",\"NUM_RUC\",\"NUM_SERIECPE\",\"NUM_CPE\",\n                     \"NUM_DOCIDENTI\", \"COD_MON\",\"MTO_IMPCPE\",\"MTO_IGVCPE\",\"MTO_TOTAL\",\"FEC_EMICPE\")\n\nMD_Factura <- inner_join(cabecera,FichaEmisor_CIIU %>% \n                           select(ruc, cod_act_princ, AP_EMISOR = act_principal, \n                                  AS1_EMISOR = act_secun1, AS2_EMISOR = act_secun2,\n                                  RS_EMISOR = razon_social,\n                                  condicion, estado, tipo_emp, cond_domicilio, \n                                  UBIGEO_EMIS = ubigeo, CATEGO_OBJETIVO, \n                                  Actividad_Economica),by = c(\"NUM_RUC\"=\"ruc\"))\nrm(cabecera,FichaEmisor_CIIU)\ngc()\nMD_Factura$llave <- paste(MD_Factura$COD_TIPOCOMP, MD_Factura$NUM_RUC, MD_Factura$NUM_SERIECPE, \n                          MD_Factura$NUM_CPE, sep = \"_\")\n\n# Limpieza de espacios en nro de documentos (RUCs)\nMD_Factura$NUM_RUC <- stri_trim(MD_Factura$NUM_RUC)\nMD_Factura$NUM_DOCIDENTI <- stri_trim(MD_Factura$NUM_DOCIDENTI)\n\n# Filtros de control a cabecera (RUC: inicien con 1 o 2, con 11 caracteres)\nMD_Factura <- MD_Factura %>% filter(nchar(NUM_DOCIDENTI)==11 & \n                                      (stri_sub(NUM_DOCIDENTI,1,1)==1 | stri_sub(NUM_DOCIDENTI,1,1)==2))\n\n# Actividad principal del receptor  \n\nFicha_Nacional <- fread(\"ficha_nacional.csv\",\n                        select = c(\"ruc\", \"cod_act_princ\",\"act_principal\", \"act_secun1\",\n                                   \"act_secun2\", \"razon_social\", \"ubigeo\", \"cond_domicilio\",\n                                   \"condicion\", \"estado\", \"tipo_emp\"),\n                        colClasses = rep(\"character\", 17))\n\n\n# Ficha_Nacional <- fread(\"ficha_nacional_luis.unl\", sep = \"|\", colClasses = rep(\"character\", 19))\n\n\nMD_Factura <- inner_join(MD_Factura, \n                         Ficha_Nacional %>% select(ruc, cod_ap_recep = cod_act_princ,\n                                                   AP_RECEPTOR = act_principal, \n                                                   AS1_RECEPTOR = act_secun1,\n                                                   AS2_RECEPTOR = act_secun2, \n                                                   RS_RECEPTOR = razon_social,\n                                                   TIP_EMP_RECEP = tipo_emp,\n                                                   UBIGEO_RECEP = ubigeo, cond_dom_recep = cond_domicilio, \n                                                   condicion_recep = condicion, estado_recep = estado),\n                                                   # tel_rec = telef_1, \n                                                   # tel_rec_2 = telef_2, \n                                                   # correo_rec = correo_1, \n                                                   # correo_rec2 = correo_2), \n                         by = c(\"NUM_DOCIDENTI\"=\"ruc\"))\n\nrm(Ficha_Nacional)\ngc()\n\nfwrite(MD_Factura, file = \"mod_MD_Factura.csv\", row.names = F)\n\nMD_Factura$AS1_RECEPTOR <- gsub(\"\\r\", \"\", MD_Factura$AS1_RECEPTOR)\nMD_Factura$AS2_RECEPTOR <- gsub(\"\\r\", \"\", MD_Factura$AS2_RECEPTOR)\n\nMD_Factura <- MD_Factura %>% filter(TIP_EMP_RECEP != \"ASOCIACION\")\nMD_Factura <- MD_Factura %>% filter(TIP_EMP_RECEP != \"GOBIERNO REGIONAL, LOCAL\")\nMD_Factura <- MD_Factura %>% filter(TIP_EMP_RECEP != \"EMPRESA DE DERECHO PUBLICO\")\nMD_Factura <- MD_Factura %>% filter(TIP_EMP_RECEP != \"SOCIEDAD CIVIL\")\nMD_Factura <- MD_Factura %>% filter(TIP_EMP_RECEP != \"COOPERATIVAS, SAIS, CAPS\")\nMD_Factura <- MD_Factura %>% filter(TIP_EMP_RECEP != \"FUNDACION\")\nMD_Factura <- MD_Factura %>% filter(TIP_EMP_RECEP != \"INSTITUCIONES RELIGIOSAS\")\nMD_Factura <- MD_Factura %>% filter(TIP_EMP_RECEP != \"SOCIEDAD DE BENEFICIENCIA\")\nMD_Factura <- MD_Factura %>% filter(TIP_EMP_RECEP != \"ENT.INST.COOPERAC.TECNICA - ENIEX\")\nMD_Factura <- MD_Factura %>% filter(TIP_EMP_RECEP != \"SINDICATOS Y FEDERACIONES\")\nMD_Factura <- MD_Factura %>% filter(TIP_EMP_RECEP != \"JUNTA DE PROPIETARIOS\")\nMD_Factura <- MD_Factura %>% filter(TIP_EMP_RECEP != \"EMPRESA DE PROPIEDAD SOCIAL\")\n\n#CONSULTAR URGENTE\n#MD_Factura$MTO_TOTAL <- MD_Factura$MTO_IMPCPE + MD_Factura$MTO_IGVCPE\n\ncpes3 <- MD_Factura %>% filter((AP_RECEPTOR != AP_EMISOR) & (AP_RECEPTOR != AS1_EMISOR) & (AP_RECEPTOR != AS2_EMISOR) & \n                                 (AS1_RECEPTOR != AP_EMISOR) & (AS1_RECEPTOR != AS1_EMISOR) & (AS1_RECEPTOR != AS2_EMISOR) &\n                                 (AS2_RECEPTOR != AP_EMISOR) & (AS2_RECEPTOR != AS1_EMISOR) & (AS2_RECEPTOR != AS2_EMISOR))\n\nciu1 <- c(\"PLANES DE SEGUROS DE VIDA\", \"PLANES DE SEGUROS GENERALES\", \"ACTIV. FINANC. PLANES SEGUROS Y PENS.\",\n          \"OTRAS ACTIV.RELAC. CON SALUD HUMANA\", \"ACTIVIDADES DE HOSPITALES\", \"RESTAURANTES, BARES Y CANTINAS.\", \n          \"ACTIVIDADES DE MEDICOS Y ODONTOLOGO\", \"AGENCIAS DE VIAJES Y GUIAS TURISTIC.\", \"ACABADO DE PROD. TEXTILES.\", \n          \"HOTELES, CAMPAMENTOS Y OTROS.\", \"VTA. MAY. PRODUCTOS TEXTILES.\", \"FAB. OTROS PROD. TEXTILES NEOP.\", \n          \"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\", \"VTA. MIN. ALIMENTOS, BEBIDAS, TABACO.\", \"VTA. MIN. EN ALMACENES NO ESPECIALIZ.\",\n          \"VTA. MIN. OTROS PRODUCTOS EN ALMACEN.\", \"VTA. MIN. EN PUESTOS DE VENTA.\", \"VTA. MAY. ALIMENTOS, BEBIDAS Y TABACO.\", \n          \"FAB. DE PRENDAS DE VESTIR.\")\nvec1 <- list(c(\"ACTIVIDADES DE HOSPITALES\", \"OTRAS ACTIV.RELAC. CON SALUD HUMANA\", \"ACTIVIDADES DE MEDICOS Y ODONTOLOGO\"), \n             c(\"ACTIVIDADES DE HOSPITALES\", \"OTRAS ACTIV.RELAC. CON SALUD HUMANA\", \"ACTIVIDADES DE MEDICOS Y ODONTOLOGO\"),\n             c(\"ACTIVIDADES DE HOSPITALES\", \"OTRAS ACTIV.RELAC. CON SALUD HUMANA\", \"ACTIVIDADES DE MEDICOS Y ODONTOLOGO\"), \n             c(\"ACTIVIDADES DE HOSPITALES\", \"OTRAS ACTIV.RELAC. CON SALUD HUMANA\", \"ACTIVIDADES DE MEDICOS Y ODONTOLOGO\"), \n             c(\"ACTIVIDADES DE HOSPITALES\", \"OTRAS ACTIV.RELAC. CON SALUD HUMANA\", \"ACTIVIDADES DE MEDICOS Y ODONTOLOGO\"), \n             c(\"VTA. MIN. OTROS PRODUCTOS EN ALMACEN.\", \"VTA. MIN. EN ALMACENES NO ESPECIALIZ.\", \"VTA. MAY. DE OTROS PRODUCTOS.\", \"OTROS TIPOS DE VENTA AL POR MENOR.\"), \n             c(\"ACTIVIDADES DE HOSPITALES\", \"OTRAS ACTIV.RELAC. CON SALUD HUMANA\", \"ACTIVIDADES DE MEDICOS Y ODONTOLOGO\"), \n             c(\"RESTAURANTES, BARES Y CANTINAS.\", \"HOTELES, CAMPAMENTOS Y OTROS.\", \"OTRAS ACTIVID.ENTRETENIMIENTO NCP.\", \"ACTIV.TEATRALES, MUSICALES Y OTRAS.\", \"OTRAS ACTIVIDADES DE ESPARCIMIENTO\"), \n             c(\"FAB. DE PRENDAS DE VESTIR.\", \"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\", \"FAB. DE ARTICULOS DE PIEL.\"), \n             c(\"VTA. MAY. DE OTROS PRODUCTOS.\", \"RESTAURANTES, BARES Y CANTINAS.\", \"AGENCIAS DE VIAJES Y GUIAS TURISTIC.\", \"VTA. MAY. PRODUCTOS TEXTILES.\", \"ACTIV.TEATRALES, MUSICALES Y OTRAS.\", \"VTA. MIN. EN ALMACENES NO ESPECIALIZ.\"), \n             c(\"FAB. TEJIDOS Y ART DE PUNTO.\", \"VTA. MAY. PRODUCTOS TEXTILES.\"), \n             c(\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\", \"VTA. MAY. PRODUCTOS TEXTILES.\", \"FAB. TEJIDOS Y ART DE PUNTO.\"), \n             c(\"FAB. TEJIDOS Y ART DE PUNTO.\", \"VTA. MAY. PRODUCTOS TEXTILES.\", \"FAB. DE CALZADO.\"), \n             c(\"VTA. MAY. DE OTROS PRODUCTOS.\"),\n             c(\"VTA. MAY. DE OTROS PRODUCTOS.\"),\n             c(\"VTA. MAY. DE OTROS PRODUCTOS.\"),\n             c(\"VTA. MAY. DE OTROS PRODUCTOS.\"), \n             c(\"VTA. MAY. DE OTROS PRODUCTOS.\"),\n             c(\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\", \"VTA. MAY. PRODUCTOS TEXTILES.\", \"FAB. TEJIDOS Y ART DE PUNTO.\"))\n\ncpes3$ind1 <- ifelse(cpes3$AP_RECEPTOR %in% ciu1 | cpes3$AS1_RECEPTOR %in% ciu1 | cpes3$AS2_RECEPTOR %in% ciu1,1,0)\n\naux0 <- cpes3 %>% filter(ind1 == 0)\naux1 <- cpes3 %>% filter(ind1 == 1)\n\n\nfor (i in 1:length(ciu1)) {\n  # i=1\n  aux1 <- aux1 %>% filter(!((AP_RECEPTOR == ciu1[i] | AS1_RECEPTOR == ciu1[i] | AS2_RECEPTOR == ciu1[i]) & \n                              (AP_EMISOR %in% vec1[[i]] | AS1_EMISOR %in% vec1[[i]] | AS2_EMISOR %in% vec1[[i]])))\n}\n\nMD_Factura <- bind_rows(aux1, aux0)\n\n# Creacion y transformacion de varaibles\n# Creacion: Fechas - Dia Semana, Dia Mes\nMD_Factura$FEC_EMICPE <- strptime(MD_Factura$FEC_EMICPE, \"%Y-%m-%d %H:%M:%S\")\n# MD_Factura$FEC_EMICPE <- strptime(MD_Factura$FEC_EMICPE, \"%Y-%m-%d\")\nMD_Factura$dia_semana <- format(MD_Factura$FEC_EMICPE,\"%A\")\nMD_Factura$dia_mes    <- format(MD_Factura$FEC_EMICPE,\"%e\")\nMD_Factura$FEC_EMICPE <- as.character(MD_Factura$FEC_EMICPE)\n\n# Transformacion de montos a variables numericas\nMD_Factura$MTO_IMPCPE <- as.numeric(MD_Factura$MTO_IMPCPE)\nMD_Factura$MTO_IGVCPE <- as.numeric(MD_Factura$MTO_IGVCPE)\n\n# Creacion de variable \"Segmento del mes\" \nMD_Factura$dia_mes <- as.numeric(MD_Factura$dia_mes)\nMD_Factura$dia_mes_cat <- ifelse(MD_Factura$dia_mes<=3, \"Inicio_mes[1-3]\" , #En la ultima semana tratan de igualar los ingresos para disminuir su IGV\n                                 ifelse(MD_Factura$dia_mes>=25, \"Fin_mes[25-31]\", #En la ultima semana tratan de igualar los ingresos para disminuir su IGV\n                                        \"Otros[4-24]\"))\n\n\nfwrite(MD_Factura,\"mod_MD_Factura_enero_19.csv\", row.names = F)\n\n#-------3. Cargar Matriz de Datos (nivel Factura) - Unir facturas con detalle ---------\nrm(list = ls())\ngc()\nlibrary(tidyverse)\nlibrary(data.table)\nlibrary(stringi)\nlibrary(SnowballC)\nlibrary(corpus)\nlibrary(tictoc)\nmemory.limit(size = 12000)\nMatrizD <- fread(\"mod_MD_Factura_enero_19.csv\")\nMatrizD$NUM_RUC=as.character(MatrizD$NUM_RUC)\nMatrizD$NUM_SERIECPE=as.character(MatrizD$NUM_SERIECPE)\nMatrizD$NUM_CPE=as.character(MatrizD$NUM_CPE)\n\ncpes <- fread(\"mod_cpes_limpio_enero_19.csv\", colClasses = list(character=1:5))\n\nCPEjoin <- inner_join(cpes,MatrizD, by = c(\"NUM_RUC\",\"NUM_SERIECPE\",\"NUM_CPE\"))  ### JOINN\n\nCPEjoin <- fread(\"mod_CPEjoin_enero_2019_2.csv\", colClasses = list(character=1:6))\nnames(CPEjoin) <- c(\"NUM_RUC\",\"NUM_SERIECPE\",\"NUM_CPE\",\"COD_TIPOCOMP\",\"NUM_DOCIDENTI\",\"COD_MON\",\"MTO_IMPCPE\",\"MTO_IGVCPE\",\"MTO_TOTAL\",\"FEC_EMICPE\",\"COD_ACT_PRINC\",\"AP_EMISOR\",\"AS1_EMISOR\",\"AS2_EMISOR\",\"RS_EMISOR\",\"CONDICION\",\"ESTADO\" ,\"TIPO_EMP\",\"COND_DOMICILIO\",\"UBIGEO_EMIS\",\"CATEGO_OBJETIVO\",\"ACTIVIDAD_ECONOMICA\",\"LLAVE\",\"COD_AP_RECEP\",\"AP_RECEPTOR\",\"AS1_RECEPTOR\",\"AS2_RECEPTOR\",\"RS_RECEPTOR\",\"TIP_EMP_RECEP\",\"UBIGEO_RECEP\",\"COND_DOM_RECEP\",\"CONDICION_RECEP\",\"ESTADO_RECEP\",\"IND1\",\"DIA_SEMANA\",\"DIA_MES\",\"DES_DETITM\")\n\nCPEjoin <- subset(CPEjoin, DES_DETITM != \"\\\\N\")\nCPEjoin <- subset(CPEjoin, DES_DETITM != \"\")\nrm(MatrizD, cpes)\ngc()\n\nfwrite(CPEjoin, \"mod_CPEjoin_enero_2019_2.csv\", row.names = F)\n\nLlaves <-\n  CPEjoin %>%\n  group_by(LLAVE,AP_RECEPTOR, AS1_RECEPTOR, AS2_RECEPTOR) %>%\n  summarise(Nitems = n(), Descripcion = paste(DES_DETITM, collapse = \" \"))\nrm(CPEjoin)\ngc()\n\nfwrite(Llaves, \"mod_Llaves_2.csv\", row.names = F)\n\nLlaves$Descripcion <- trimws(Llaves$Descripcion)\nLlaves <- Llaves[Llaves$Descripcion != \"\",]\n\n\ndatosLL <- NULL\ntokenLL <- NULL\npalabras_llave_R  <-  list()\n\n\n\nfor (i in 1:length(Llaves$Descripcion)) {\n  datosLL <- data_frame(txt=Llaves$Descripcion[i])\n  tokenLL <- as.data.frame(text_tokens(datosLL$txt, stemmer = \"sp\"))\n  names(tokenLL) <- \"word\"\n  tokenLL$word <- as.character(tokenLL$word)\n  palabras_llave_R[[i]] <- as.data.frame(tokenLL %>% count(word,sort = T))\n  palabras_llave_R[[i]]$llave <- Llaves$LLAVE[i]\n  palabras_llave_R[[i]]$apy <- Llaves$AP_RECEPTOR[i]\n  palabras_llave_R[[i]]$as1 <- Llaves$AS1_RECEPTOR[i]\n  palabras_llave_R[[i]]$as2 <- Llaves$AS2_RECEPTOR[i]\n  if(i%%10000==0) {print(i)}\n}\nsave(palabras_llave_R, file = \"mod_palabras_llave_R_enero_19_1.RData\")\nrm(datosLL, tokenLL, Llaves)\ngc()\n\n#---------- Indicador ProporciÃ³n de DIFERENCIAS (palabrasRECEPTOR vs palabrasCIIU) --------\nrm(list = ls())\ngc()\nlibrary(tidyverse)\nlibrary(data.table)\nlibrary(stringi)\nlibrary(SnowballC)\nlibrary(corpus)\nlibrary(tictoc)\nlibrary(tidytext)\n\n\nmemory.limit(size = 12000)\n\nload(\"mod_palabras_llave_R_enero_19_1.RData\")\nP_ll_r <- do.call(rbind.data.frame, palabras_llave_R)\nP_ll_r <- P_ll_r %>% filter(nchar(word)>=3)\nrm(palabras_llave_R)\ngc()\nWr <- fread(\"Words_gnd2.csv\")\nWr$cwords <- as.character(Wr$cwords)\nWr$APY <- as.character(Wr$APY)\nWr$APY <- stri_trans_tolower(Wr$APY)\nWr$control <- 1\n\nPrWr <- left_join(P_ll_r,Wr,by=c(\"word\"=\"cwords\",\"apy\"=\"APY\"))\nPrWr$control[is.na(PrWr$control)] <- 0\ntable(PrWr$control)\n\nPrWr2 <- left_join(P_ll_r,Wr,by=c(\"word\"=\"cwords\",\"as1\"=\"APY\"))\nPrWr2$control[is.na(PrWr2$control)] <- 0\ntable(PrWr2$control)\n\nPrWr3 <- left_join(P_ll_r,Wr,by=c(\"word\"=\"cwords\",\"as2\"=\"APY\"))\nPrWr3$control[is.na(PrWr3$control)] <- 0\ntable(PrWr3$control)\n\nPrWr$control <- ifelse(PrWr$control + PrWr2$control + PrWr3$control == 0, 0, 1)\n\nLlavesR <- PrWr %>% group_by(llave) %>% summarise(N=n(), Suma = sum(control), PropCom = Suma/n(), PropDif = (n()-Suma)/n() )\nLlavesR <- as.data.frame(LlavesR)\nrm(PrWr, PrWr2, PrWr3, P_ll_r, Wr)\ngc()\nfwrite(LlavesR, \"mod_LlavesR201901.csv\", row.names = F)\n#---------- CosntrucciÃ³n de output Final -------\nfacturas <- fread(\"mod_CPEjoin_enero_2019_2.csv\")\ndetalles <- facturas %>% select(LLAVE, DES_DETITM)\nfacturas <- facturas %>% select(LLAVE, COD_MON,MTO_IMPCPE, MTO_IGVCPE, MTO_TOTAL, FEC_EMICPE, NUM_RUC, AP_EMISOR, AS1_EMISOR, \n                                AS2_EMISOR, RS_EMISOR, CONDICION, ESTADO, TIPO_EMP, #tamano,dia_mes_cat\n                                COND_DOMICILIO, UBIGEO_EMIS, NUM_DOCIDENTI, AP_RECEPTOR, AS1_RECEPTOR, AS2_RECEPTOR, \n                                RS_RECEPTOR, UBIGEO_RECEP, COND_DOM_RECEP, CONDICION_RECEP, ESTADO_RECEP, \n                                DIA_SEMANA, DIA_MES, TIP_EMP_RECEP)\nfacturas <- unique(facturas)\n\ndetalles <-  detalles %>% group_by(LLAVE) %>% summarise(Nitems = n(), \n                                                        Descripcion = paste(DES_DETITM, collapse = \" ** \"))\n\nfacturas <- inner_join(facturas, detalles, by = c(\"LLAVE\"))\nfacturas <- inner_join(facturas, LlavesR, by = c(\"LLAVE\"=\"llave\"))\nfacturas$NUM_RUC <- as.character(facturas$NUM_RUC)\nfacturas$NUM_DOCIDENTI <- as.character(facturas$NUM_DOCIDENTI)\n\nregimen <- fread(\"regimen.txt\")\nfacturas <- inner_join(facturas, regimen, by=c(\"NUM_DOCIDENTI\"=\"vfp_numruc\"))\n\nfacturas <- facturas %>% filter(regimen != \"REGIMEN RUS\")\nfacturas <- facturas %>% filter(regimen != \"REGIMEN ESPECIAL\")\n\nfacturas$MTO_IGVCPE <- as.numeric(facturas$MTO_IGVCPE)\nfacturas$MTO_IMPCPE <- as.numeric(facturas$MTO_IMPCPE)\n#Revisar porque la ecuación está incorrecto debería de ser MTO_TOTAL + MTO_IGVCPE = MTO_IMPCPE\n#facturas$MTO_TOTAL <- facturas$MTO_IGVCPE + facturas$MTO_IMPCPE\n\ntip_camb <- 3.3473 #Promedio diario del mes de enero del tipo de cambio según la SUNAT \nfacturas$MTO_IMPCPE <- ifelse(facturas$COD_MON==\"usd\", facturas$MTO_IMPCPE*tip_camb, facturas$MTO_IMPCPE)\nfacturas$MTO_IGVCPE <- ifelse(facturas$COD_MON==\"usd\", facturas$MTO_IGVCPE*tip_camb, facturas$MTO_IGVCPE)\nfacturas$MTO_TOTAL <- ifelse(facturas$COD_MON==\"usd\", facturas$MTO_TOTAL*tip_camb, facturas$MTO_TOTAL)\n\nfwrite(facturas, \"mod_fact_gnd_enero_2019_3.csv\", row.names = F)\n\n####PRIMERA SALIDA CON LOS FILTROS DE SIEMPRE\n#-----Salida - de 100pre----\nrm(list = ls())\ngc()\nlibrary(tidyverse)\nlibrary(data.table)\nlibrary(stringi)\nlibrary(dummies)\nlibrary(SnowballC)\nlibrary(corpus)\nlibrary(tictoc)\nmemory.limit(size = 12000)\n\nsalida <- fread(\"mod_fact_gnd_enero_2019_3.csv\")\nsalida <- salida %>% filter(MTO_TOTAL>=0.05*4200)\nsalida <- salida %>% filter(PropDif>0.2)\n\ndependencia <- fread(\"dependencia.csv\")\n\nsalida <- inner_join(salida, dependencia,by=c(\"NUM_DOCIDENTI\" = \"RUC\"))\nsalida <- salida %>% filter(DEPENDENCIA!=\"0011\")\nrm(dependencia)\ngc()\n\naux3 <- fread(\"vts_dec_men_pdt.csv\")\n\n# Para las facturas \naux4 <- salida %>% group_by(NUM_DOCIDENTI) %>% summarise(MTO_GND = sum(MTO_TOTAL))\n\naux5 <- inner_join(aux4, aux3, by=c(\"NUM_DOCIDENTI\" = \"n_doc_declado\"))\naux5$rat1 <- ifelse(aux5$MTO_VTAS_DEC==0,1,aux5$MTO_GND/aux5$MTO_VTAS_DEC)\n\nsalida1 <- inner_join(salida, aux5, by = \"NUM_DOCIDENTI\")\nsalida2 <- salida1 %>% filter(rat1>0.1)\n\n\nfwrite(salida2, \"mod_fact_gnd_enero_19_CLASICA.csv\", row.names = F)\n\n\n#-----Otros filtros----\nrm(list = ls())\ngc()\nlibrary(tidyverse)\nlibrary(data.table)\nlibrary(stringi)\nlibrary(dummies)\nlibrary(SnowballC)\nlibrary(corpus)\nlibrary(tictoc)\nmemory.limit(size = 12000)\n\nsalida <- fread(\"mod_fact_gnd_enero_2019_3.csv\")\n\nblanca <- c(\"valor minimo mensual\", \"desarrollo comerc\", \"intercambio tarj\", \n             \"porcentual men\", \"gasto comun fijo\", \"prediales\", \"inversion publicitaria\",\n             \"vales compra\", \"variable mensual\", \"renta fija mensual\", \"adelanto resultado consorcio\", \n            \"venta inmueble\", \"rancho\", \"contrato suscrito\", \"redencion puntos\", \"despacho centralizado\",\n            \"alimentacion personal\", \"comision recaudacion\", \"alimentacion comedor\", \"acuerdo auspicio\",\n            \"alquiler local\", \"publicidad promociones\", \"ambulancia urbana\", \"cesion tda\",\n            \"promociones diversas\", \"renta minima\")\n\n# View(salida[grep(\"cesion tda\", salida$Descripcion),])\n\nquitar <- NULL\nfor (i in blanca) {\n  a <- grep(i, salida$Descripcion)\n  quitar <- c(quitar,a)\n}\nquitar <- unique(quitar)\nsalida <- salida[-quitar,]\n\nactividades <- c(\"EXT. DE MIN. METALIFEROS NO FERROSOS.\", \"CONSTRUCCION EDIFICIOS COMPLETOS.\")\naux1 <- salida %>% filter(AP_RECEPTOR %in% actividades | AS1_RECEPTOR %in% actividades | AS2_RECEPTOR %in% actividades)\naux1 <- aux1[-grep(\"alimentac\", aux1$Descripcion),]\naux2 <- salida %>% filter(!(AP_RECEPTOR %in% actividades | AS1_RECEPTOR %in% actividades | AS2_RECEPTOR %in% actividades))\n\nsalida <- rbind(aux1, aux2)\n\n# fwrite(salida, \"borrar.csv\", row.names = F)\n\n# aux <- salida %>% group_by(AP_RECEPTOR) %>% summarise(Mediana_mto_tot = median(MTO_TOTAL), \n#                                                       Promedio_mto_tot = mean(MTO_TOTAL), \n#                                                       Des_est_mto_to = sd(MTO_TOTAL), \n#                                                       p5 = quantile(MTO_TOTAL,0.05),\n#                                                       p10 = quantile(MTO_TOTAL,0.10), \n#                                                       p15 = quantile(MTO_TOTAL,0.15), \n#                                                       p25 = quantile(MTO_TOTAL,0.25),\n#                                                       p35 = quantile(MTO_TOTAL,0.35), \n#                                                       p45 = quantile(MTO_TOTAL,0.45), \n#                                                       p55 = quantile(MTO_TOTAL,0.55),\n#                                                       p65 = quantile(MTO_TOTAL,0.65), \n#                                                       p75 = quantile(MTO_TOTAL,0.75), \n#                                                       p85 = quantile(MTO_TOTAL,0.85),\n#                                                       p95 = quantile(MTO_TOTAL,0.95), \n#                                                       p99 = quantile(MTO_TOTAL,0.99))\n# fwrite(aux, \"compras_x_ciiu.csv\", row.names = F)\n\nsalida <- salida %>% filter(MTO_TOTAL>5 & MTO_TOTAL<200000)\n\n# salida <- salida %>% filter(MTO_TOTAL>=0.05*4150)\nsalida <- salida %>% filter(PropDif>0.3)\n\ndependencia <- fread(\"dependencia.csv\")\n\nsalida <- inner_join(salida, dependencia,by=c(\"NUM_DOCIDENTI\" = \"RUC\"))\nsalida <- salida %>% filter(DEPENDENCIA!=\"0011\")\nrm(dependencia)\ngc()\n\naux <- salida %>% group_by(NUM_DOCIDENTI) %>% summarise(MTO_TOT_GND = sum(MTO_TOTAL))\nsalida <- inner_join(salida, aux, by = \"NUM_DOCIDENTI\")\n\n\nfwrite(salida, \"mod_salida_gnd_ene_19_I.csv\", row.names = F)\n\nsalida <- fread(\"mod_fact_gnd_enero_2019_3.csv\",colClasses = list(character=7:18))\n\n# Lectura de ficha con correos\nFicha_Nacional <- fread(\"ficha_nacional_luis.unl\", sep = \"|\", colClasses = rep(\"character\", 19),\n                        select = c(\"ruc\", \"telef_1\", \"telef_2\", \"correo_1\", \"correo_2\"))\n\n#Ficha_Nacional <- Ficha_Nacional %>% select(ruc, telef_1, telef_2, correo_1, correo_2)\n\n\nnames(Ficha_Nacional)\ngc()\n#salida$NUM_DOCIDENTI <- as.character(salida$NUM_DOCIDENTI)\n\nsalida2 <- inner_join(salida, Ficha_Nacional, by = c(\"NUM_DOCIDENTI\" = \"ruc\"))\nfwrite(salida2, \"mod_salida_gnd_ene_19_I_I.csv\", row.names = F)\n\nfinal = fread(\"mod_salida_gnd_ene_19_I_I.csv\")\n\naux <- salida2 %>% select(NUM_DOCIDENTI, telef_1, telef_2, correo_1, correo_2)\naux <- unique(aux)\nView(table(aux$correo_1))\n\nView(aux %>% filter(correo_1 == \"janett769@hotmail.com\"))\n\n\n\n\n\naux3 <- fread(\"vts_dec_men_pdt.csv\",colClasses = list(character=1))\n\n# Para las facturas \naux4 <- salida %>% group_by(NUM_DOCIDENTI) %>% summarise(MTO_GND = sum(MTO_TOTAL))\n\naux5 <- inner_join(aux4, aux3, by=c(\"NUM_DOCIDENTI\" = \"n_doc_declado\"))\naux5$rat1 <- ifelse(aux5$MTO_VTAS_DEC==0,1,aux5$MTO_GND/aux5$MTO_VTAS_DEC)\n\nsalida1 <- inner_join(salida, aux5, by = \"NUM_DOCIDENTI\")\nsalida2 <- salida1 %>% filter(rat1>=0.1)\n#salida2$NUM_RUC <- as.character(salida2$NUM_RUC)\n\nsal1 <- salida2 %>% filter(NUM_RUC %in% c(\"20109072177\", \"20100070970\"))\nfiltros <- c(\"alquil\", \"desarrollo comerc\", \"intercambio tarj\", \n             \"porcentual men\", \"gasto comun fijo\", \"prediales\", \"inversion publicitaria\",\n             \"vales compra\", \"variable mensual\", \"renta fija mensual\")\nquitar <- NULL\nfor (i in filtros) {\n  a <- grep(i, sal1$Descripcion)\n  quitar <- c(quitar,a)\n}\nquitar <- unique(quitar)\nsal1 <- sal1[-quitar,]\n\nsal2 <- salida2 %>% filter(!NUM_RUC %in% c(\"20109072177\", \"20100070970\"))\n# aaa <- grep(\"alquil\", sal2$Descripcion)\n# View(sal2[aaa,])\nsalida2 <- rbind(sal1, sal2)\n\nfwrite(salida2, \"mod_fact_gnd_enero_19_5.csv\", row.names = F)\n","dateUpdated":"2019-03-13T15:39:30-0400","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Bloque 1</h1>\n<p>rm(list = ls())<br/>gc()<br/>library(tictoc)</p>\n<p>#&mdash;&mdash;-Limpieza detalle&mdash;&mdash;<br/>library(data.table)<br/>library(tm)<br/>library(stringr)<br/>library(stringi)</p>\n<p>memory.limit(size = 12000)</p>\n<p>detalle &lt;- fread(&lsquo;mod_detalle_cpe.csv&rsquo;,nrows = 1000)</p>\n<p>detalle=detalle[,c(2,1,3,4,8)]<br/>colnames(detalle)=c(&ldquo;COD_TIPOCOMP&rdquo;, &ldquo;NUM_RUC&rdquo;, &ldquo;NUM_SERIECPE&rdquo;, &ldquo;NUM_CPE&rdquo;, &ldquo;DES_DETITM&rdquo;)</p>\n<p>fwrite(detalle, file = &ldquo;cpes.csv&rdquo;,row.names = F)</p>\n<p>rm(list = ls())<br/>gc()</p>\n<p>topes &lt;- c(1,seq(1000001,90000001, 1000000))<br/>nombres &lt;- c(&ldquo;COD_TIPOCOMP&rdquo;, &ldquo;NUM_RUC&rdquo;, &ldquo;NUM_SERIECPE&rdquo;, &ldquo;NUM_CPE&rdquo;, &ldquo;DES_DETITM&rdquo;)</p>\n<p>for (i in 1:length(topes)) {<br/> cpes &lt;- fread(&ldquo;mod_detalle_cpe.csv&rdquo;, nrows = 1000000, skip = topes[i],header = F)<br/> cpes &lt;- unique(cpes)<br/> names(cpes) &lt;- nombres</p>\n<p>cpes$DES_DETITM &lt;- stri_trim(cpes$DES_DETITM)<br/> cpes$DES_DETITM &lt;- stri_trans_tolower(cpes$DES_DETITM)<br/> cpes$DES_DETITM &lt;- removeWords(cpes$DES_DETITM, stopwords(kind = &ldquo;spanish&rdquo;))<br/> cpes$DES_DETITM &lt;- removePunctuation(cpes$DES_DETITM,<br/> preserve_intra_word_contractions = FALSE,<br/> preserve_intra_word_dashes = FALSE)<br/> cpes$DES_DETITM &lt;- removeNumbers(cpes$DES_DETITM)<br/> cpes$DES_DETITM &lt;- stripWhitespace(cpes$DES_DETITM)<br/> fwrite(cpes, file = paste(&ldquo;mod_cpes_&rdquo;,i,&ldquo;.csv&rdquo;,sep=&quot;&ldquo;), row.names = F)<br/> print(paste(&rdquo;vamos en &ldquo;, i, &rdquo; de &quot;, length(topes)))<br/>}</p>\n<p>rm(cpes)<br/>gc()<br/>cpes_l=NULL</p>\n<p>for (j in 1:(i-1)) {<br/> #j=1<br/> cpes=fread(paste(&ldquo;mod_cpes_&rdquo;,j,&ldquo;.csv&rdquo;,sep=&quot;&ldquo;), header = TRUE)<br/> cpes_l=rbind(cpes_l, cpes)<br/> print(paste(&rdquo;vamos en &ldquo;, j, &rdquo; de &quot;, (i-1)))<br/>}</p>\n<p>cpes_l &lt;- unique(cpes_l)</p>\n<p>fwrite(cpes_l, file = &ldquo;mod_cpes_limpio_enero_19.csv&rdquo;, row.names = F)</p>\n<p>#&mdash;&mdash;-Emisores de riesgo&mdash;&mdash;<br/>rm(list = ls())<br/>gc()<br/>library(tidyverse)<br/>library(data.table)<br/>library(stringi)<br/>library(corpus)<br/>library(tictoc)</p>\n<p>memory.limit(size = 12000) #Mejora el rendimiento de la memoria RAM</p>\n<p>FichaEmisor_CIIU &lt;- fread(&ldquo;mod_FichaEmisor_CIIU.csv&rdquo;, colClasses = rep(&ldquo;character&rdquo;,13))</p>\n<h1>cabecera &lt;- fread(&ldquo;cabecera_cpe_octubre2018.unl&rdquo;)</h1>\n<h1>View(head(cabecera,13000))</h1>\n<h1>fwrite(cabecera, &ldquo;cabecera_cpe_octubre2018.unl&rdquo;, row.names = F, sep = &ldquo;|&rdquo;)</h1>\n<p>cabecera &lt;- fread(&ldquo;mod_cabecera_cpe.csv&rdquo;, nrows = 100)<br/>nombres &lt;- names(cabecera)<br/>nombres &lt;- nombres[c(2,1,3,4,7,8,12,11,10)]</p>\n<p>cabecera &lt;- fread(&ldquo;mod_cabecera_cpe.csv&rdquo;,<br/> sep = &ldquo;,&rdquo;,<br/> col.names = nombres,<br/> colClasses=list(character=1:6))</p>\n<p>nombres &lt;- c(&ldquo;COD_TIPOCOMP&rdquo;,&ldquo;NUM_RUC&rdquo;,&ldquo;NUM_SERIECPE&rdquo;,&ldquo;NUM_CPE&rdquo;,<br/> &ldquo;NUM_DOCIDENTI&rdquo;, &ldquo;COD_MON&rdquo;,&ldquo;MTO_IMPCPE&rdquo;,&ldquo;MTO_IGVCPE&rdquo;,&ldquo;MTO_TOTAL&rdquo;,&ldquo;FEC_EMICPE&rdquo;)</p>\n<p>MD_Factura &lt;- inner_join(cabecera,FichaEmisor_CIIU %&gt;%<br/> select(ruc, cod_act_princ, AP_EMISOR = act_principal,<br/> AS1_EMISOR = act_secun1, AS2_EMISOR = act_secun2,<br/> RS_EMISOR = razon_social,<br/> condicion, estado, tipo_emp, cond_domicilio,<br/> UBIGEO_EMIS = ubigeo, CATEGO_OBJETIVO,<br/> Actividad_Economica),by = c(&ldquo;NUM_RUC&rdquo;=&ldquo;ruc&rdquo;))<br/>rm(cabecera,FichaEmisor_CIIU)<br/>gc()<br/>MD_Factura$llave &lt;- paste(MD_Factura$COD_TIPOCOMP, MD_Factura$NUM_RUC, MD_Factura$NUM_SERIECPE,<br/> MD_Factura$NUM_CPE, sep = &quot;_&quot;)</p>\n<h1>Limpieza de espacios en nro de documentos (RUCs)</h1>\n<p>MD_Factura$NUM_RUC &lt;- stri_trim(MD_Factura$NUM_RUC)<br/>MD_Factura$NUM_DOCIDENTI &lt;- stri_trim(MD_Factura$NUM_DOCIDENTI)</p>\n<h1>Filtros de control a cabecera (RUC: inicien con 1 o 2, con 11 caracteres)</h1>\n<p>MD_Factura &lt;- MD_Factura %&gt;% filter(nchar(NUM_DOCIDENTI)==11 &amp;<br/> (stri_sub(NUM_DOCIDENTI,1,1)==1 | stri_sub(NUM_DOCIDENTI,1,1)==2))</p>\n<h1>Actividad principal del receptor</h1>\n<p>Ficha_Nacional &lt;- fread(&ldquo;ficha_nacional.csv&rdquo;,<br/> select = c(&ldquo;ruc&rdquo;, &ldquo;cod_act_princ&rdquo;,&ldquo;act_principal&rdquo;, &ldquo;act_secun1&rdquo;,<br/> &ldquo;act_secun2&rdquo;, &ldquo;razon_social&rdquo;, &ldquo;ubigeo&rdquo;, &ldquo;cond_domicilio&rdquo;,<br/> &ldquo;condicion&rdquo;, &ldquo;estado&rdquo;, &ldquo;tipo_emp&rdquo;),<br/> colClasses = rep(&ldquo;character&rdquo;, 17))</p>\n<h1>Ficha_Nacional &lt;- fread(&ldquo;ficha_nacional_luis.unl&rdquo;, sep = &ldquo;|&rdquo;, colClasses = rep(&ldquo;character&rdquo;, 19))</h1>\n<p>MD_Factura &lt;- inner_join(MD_Factura,<br/> Ficha_Nacional %&gt;% select(ruc, cod_ap_recep = cod_act_princ,<br/> AP_RECEPTOR = act_principal,<br/> AS1_RECEPTOR = act_secun1,<br/> AS2_RECEPTOR = act_secun2,<br/> RS_RECEPTOR = razon_social,<br/> TIP_EMP_RECEP = tipo_emp,<br/> UBIGEO_RECEP = ubigeo, cond_dom_recep = cond_domicilio,<br/> condicion_recep = condicion, estado_recep = estado),<br/> # tel_rec = telef_1,<br/> # tel_rec_2 = telef_2,<br/> # correo_rec = correo_1,<br/> # correo_rec2 = correo_2),<br/> by = c(&ldquo;NUM_DOCIDENTI&rdquo;=&ldquo;ruc&rdquo;))</p>\n<p>rm(Ficha_Nacional)<br/>gc()</p>\n<p>fwrite(MD_Factura, file = &ldquo;mod_MD_Factura.csv&rdquo;, row.names = F)</p>\n<p>MD_Factura$AS1_RECEPTOR &lt;- gsub(&ldquo;\\r&rdquo;, &quot;&ldquo;, MD_Factura$AS1_RECEPTOR)<br/>MD_Factura$AS2_RECEPTOR &lt;- gsub(&rdquo;\\r&ldquo;, &rdquo;&quot;, MD_Factura$AS2_RECEPTOR)</p>\n<p>MD_Factura &lt;- MD_Factura %&gt;% filter(TIP_EMP_RECEP != &ldquo;ASOCIACION&rdquo;)<br/>MD_Factura &lt;- MD_Factura %&gt;% filter(TIP_EMP_RECEP != &ldquo;GOBIERNO REGIONAL, LOCAL&rdquo;)<br/>MD_Factura &lt;- MD_Factura %&gt;% filter(TIP_EMP_RECEP != &ldquo;EMPRESA DE DERECHO PUBLICO&rdquo;)<br/>MD_Factura &lt;- MD_Factura %&gt;% filter(TIP_EMP_RECEP != &ldquo;SOCIEDAD CIVIL&rdquo;)<br/>MD_Factura &lt;- MD_Factura %&gt;% filter(TIP_EMP_RECEP != &ldquo;COOPERATIVAS, SAIS, CAPS&rdquo;)<br/>MD_Factura &lt;- MD_Factura %&gt;% filter(TIP_EMP_RECEP != &ldquo;FUNDACION&rdquo;)<br/>MD_Factura &lt;- MD_Factura %&gt;% filter(TIP_EMP_RECEP != &ldquo;INSTITUCIONES RELIGIOSAS&rdquo;)<br/>MD_Factura &lt;- MD_Factura %&gt;% filter(TIP_EMP_RECEP != &ldquo;SOCIEDAD DE BENEFICIENCIA&rdquo;)<br/>MD_Factura &lt;- MD_Factura %&gt;% filter(TIP_EMP_RECEP != &ldquo;ENT.INST.COOPERAC.TECNICA - ENIEX&rdquo;)<br/>MD_Factura &lt;- MD_Factura %&gt;% filter(TIP_EMP_RECEP != &ldquo;SINDICATOS Y FEDERACIONES&rdquo;)<br/>MD_Factura &lt;- MD_Factura %&gt;% filter(TIP_EMP_RECEP != &ldquo;JUNTA DE PROPIETARIOS&rdquo;)<br/>MD_Factura &lt;- MD_Factura %&gt;% filter(TIP_EMP_RECEP != &ldquo;EMPRESA DE PROPIEDAD SOCIAL&rdquo;)</p>\n<p>#CONSULTAR URGENTE</p>\n<p>#MD_Factura$MTO_TOTAL &lt;- MD_Factura$MTO_IMPCPE + MD_Factura$MTO_IGVCPE</p>\n<p>cpes3 &lt;- MD_Factura %&gt;% filter((AP_RECEPTOR != AP_EMISOR) &amp; (AP_RECEPTOR != AS1_EMISOR) &amp; (AP_RECEPTOR != AS2_EMISOR) &amp;<br/> (AS1_RECEPTOR != AP_EMISOR) &amp; (AS1_RECEPTOR != AS1_EMISOR) &amp; (AS1_RECEPTOR != AS2_EMISOR) &amp;<br/> (AS2_RECEPTOR != AP_EMISOR) &amp; (AS2_RECEPTOR != AS1_EMISOR) &amp; (AS2_RECEPTOR != AS2_EMISOR))</p>\n<p>ciu1 &lt;- c(&ldquo;PLANES DE SEGUROS DE VIDA&rdquo;, &ldquo;PLANES DE SEGUROS GENERALES&rdquo;, &ldquo;ACTIV. FINANC. PLANES SEGUROS Y PENS.&rdquo;,<br/> &ldquo;OTRAS ACTIV.RELAC. CON SALUD HUMANA&rdquo;, &ldquo;ACTIVIDADES DE HOSPITALES&rdquo;, &ldquo;RESTAURANTES, BARES Y CANTINAS.&rdquo;,<br/> &ldquo;ACTIVIDADES DE MEDICOS Y ODONTOLOGO&rdquo;, &ldquo;AGENCIAS DE VIAJES Y GUIAS TURISTIC.&rdquo;, &ldquo;ACABADO DE PROD. TEXTILES.&rdquo;,<br/> &ldquo;HOTELES, CAMPAMENTOS Y OTROS.&rdquo;, &ldquo;VTA. MAY. PRODUCTOS TEXTILES.&rdquo;, &ldquo;FAB. OTROS PROD. TEXTILES NEOP.&rdquo;,<br/> &ldquo;VTA. MIN. PRODUCTOS TEXTILES, CALZADO.&rdquo;, &ldquo;VTA. MIN. ALIMENTOS, BEBIDAS, TABACO.&rdquo;, &ldquo;VTA. MIN. EN ALMACENES NO ESPECIALIZ.&rdquo;,<br/> &ldquo;VTA. MIN. OTROS PRODUCTOS EN ALMACEN.&rdquo;, &ldquo;VTA. MIN. EN PUESTOS DE VENTA.&rdquo;, &ldquo;VTA. MAY. ALIMENTOS, BEBIDAS Y TABACO.&rdquo;,<br/> &ldquo;FAB. DE PRENDAS DE VESTIR.&rdquo;)<br/>vec1 &lt;- list(c(&ldquo;ACTIVIDADES DE HOSPITALES&rdquo;, &ldquo;OTRAS ACTIV.RELAC. CON SALUD HUMANA&rdquo;, &ldquo;ACTIVIDADES DE MEDICOS Y ODONTOLOGO&rdquo;),<br/> c(&ldquo;ACTIVIDADES DE HOSPITALES&rdquo;, &ldquo;OTRAS ACTIV.RELAC. CON SALUD HUMANA&rdquo;, &ldquo;ACTIVIDADES DE MEDICOS Y ODONTOLOGO&rdquo;),<br/> c(&ldquo;ACTIVIDADES DE HOSPITALES&rdquo;, &ldquo;OTRAS ACTIV.RELAC. CON SALUD HUMANA&rdquo;, &ldquo;ACTIVIDADES DE MEDICOS Y ODONTOLOGO&rdquo;),<br/> c(&ldquo;ACTIVIDADES DE HOSPITALES&rdquo;, &ldquo;OTRAS ACTIV.RELAC. CON SALUD HUMANA&rdquo;, &ldquo;ACTIVIDADES DE MEDICOS Y ODONTOLOGO&rdquo;),<br/> c(&ldquo;ACTIVIDADES DE HOSPITALES&rdquo;, &ldquo;OTRAS ACTIV.RELAC. CON SALUD HUMANA&rdquo;, &ldquo;ACTIVIDADES DE MEDICOS Y ODONTOLOGO&rdquo;),<br/> c(&ldquo;VTA. MIN. OTROS PRODUCTOS EN ALMACEN.&rdquo;, &ldquo;VTA. MIN. EN ALMACENES NO ESPECIALIZ.&rdquo;, &ldquo;VTA. MAY. DE OTROS PRODUCTOS.&rdquo;, &ldquo;OTROS TIPOS DE VENTA AL POR MENOR.&rdquo;),<br/> c(&ldquo;ACTIVIDADES DE HOSPITALES&rdquo;, &ldquo;OTRAS ACTIV.RELAC. CON SALUD HUMANA&rdquo;, &ldquo;ACTIVIDADES DE MEDICOS Y ODONTOLOGO&rdquo;),<br/> c(&ldquo;RESTAURANTES, BARES Y CANTINAS.&rdquo;, &ldquo;HOTELES, CAMPAMENTOS Y OTROS.&rdquo;, &ldquo;OTRAS ACTIVID.ENTRETENIMIENTO NCP.&rdquo;, &ldquo;ACTIV.TEATRALES, MUSICALES Y OTRAS.&rdquo;, &ldquo;OTRAS ACTIVIDADES DE ESPARCIMIENTO&rdquo;),<br/> c(&ldquo;FAB. DE PRENDAS DE VESTIR.&rdquo;, &ldquo;VTA. MIN. PRODUCTOS TEXTILES, CALZADO.&rdquo;, &ldquo;FAB. DE ARTICULOS DE PIEL.&rdquo;),<br/> c(&ldquo;VTA. MAY. DE OTROS PRODUCTOS.&rdquo;, &ldquo;RESTAURANTES, BARES Y CANTINAS.&rdquo;, &ldquo;AGENCIAS DE VIAJES Y GUIAS TURISTIC.&rdquo;, &ldquo;VTA. MAY. PRODUCTOS TEXTILES.&rdquo;, &ldquo;ACTIV.TEATRALES, MUSICALES Y OTRAS.&rdquo;, &ldquo;VTA. MIN. EN ALMACENES NO ESPECIALIZ.&rdquo;),<br/> c(&ldquo;FAB. TEJIDOS Y ART DE PUNTO.&rdquo;, &ldquo;VTA. MAY. PRODUCTOS TEXTILES.&rdquo;),<br/> c(&ldquo;VTA. MIN. PRODUCTOS TEXTILES, CALZADO.&rdquo;, &ldquo;VTA. MAY. PRODUCTOS TEXTILES.&rdquo;, &ldquo;FAB. TEJIDOS Y ART DE PUNTO.&rdquo;),<br/> c(&ldquo;FAB. TEJIDOS Y ART DE PUNTO.&rdquo;, &ldquo;VTA. MAY. PRODUCTOS TEXTILES.&rdquo;, &ldquo;FAB. DE CALZADO.&rdquo;),<br/> c(&ldquo;VTA. MAY. DE OTROS PRODUCTOS.&rdquo;),<br/> c(&ldquo;VTA. MAY. DE OTROS PRODUCTOS.&rdquo;),<br/> c(&ldquo;VTA. MAY. DE OTROS PRODUCTOS.&rdquo;),<br/> c(&ldquo;VTA. MAY. DE OTROS PRODUCTOS.&rdquo;),<br/> c(&ldquo;VTA. MAY. DE OTROS PRODUCTOS.&rdquo;),<br/> c(&ldquo;VTA. MIN. PRODUCTOS TEXTILES, CALZADO.&rdquo;, &ldquo;VTA. MAY. PRODUCTOS TEXTILES.&rdquo;, &ldquo;FAB. TEJIDOS Y ART DE PUNTO.&rdquo;))</p>\n<p>cpes3$ind1 &lt;- ifelse(cpes3$AP_RECEPTOR %in% ciu1 | cpes3$AS1_RECEPTOR %in% ciu1 | cpes3$AS2_RECEPTOR %in% ciu1,1,0)</p>\n<p>aux0 &lt;- cpes3 %&gt;% filter(ind1 == 0)<br/>aux1 &lt;- cpes3 %&gt;% filter(ind1 == 1)</p>\n<p>for (i in 1:length(ciu1)) {<br/> # i=1<br/> aux1 &lt;- aux1 %&gt;% filter(!((AP_RECEPTOR == ciu1[i] | AS1_RECEPTOR == ciu1[i] | AS2_RECEPTOR == ciu1[i]) &amp;<br/> (AP_EMISOR %in% vec1<a href=\"./i.html\">i</a> | AS1_EMISOR %in% vec1<a href=\"./i.html\">i</a> | AS2_EMISOR %in% vec1<a href=\"./i.html\">i</a>)))<br/>}</p>\n<p>MD_Factura &lt;- bind_rows(aux1, aux0)</p>\n<h1>Creacion y transformacion de varaibles</h1>\n<h1>Creacion: Fechas - Dia Semana, Dia Mes</h1>\n<p>MD_Factura$FEC_EMICPE &lt;- strptime(MD_Factura$FEC_EMICPE, &ldquo;%Y-%m-%d %H:%M:%S&rdquo;)</p>\n<h1>MD_Factura$FEC_EMICPE &lt;- strptime(MD_Factura$FEC_EMICPE, &ldquo;%Y-%m-%d&rdquo;)</h1>\n<p>MD_Factura$dia_semana &lt;- format(MD_Factura$FEC_EMICPE,&ldquo;%A&rdquo;)<br/>MD_Factura$dia_mes &lt;- format(MD_Factura$FEC_EMICPE,&ldquo;%e&rdquo;)<br/>MD_Factura$FEC_EMICPE &lt;- as.character(MD_Factura$FEC_EMICPE)</p>\n<h1>Transformacion de montos a variables numericas</h1>\n<p>MD_Factura$MTO_IMPCPE &lt;- as.numeric(MD_Factura$MTO_IMPCPE)<br/>MD_Factura$MTO_IGVCPE &lt;- as.numeric(MD_Factura$MTO_IGVCPE)</p>\n<h1>Creacion de variable &ldquo;Segmento del mes&rdquo;</h1>\n<p>MD_Factura$dia_mes &lt;- as.numeric(MD_Factura$dia_mes)<br/>MD_Factura$dia_mes_cat &lt;- ifelse(MD_Factura$dia_mes&lt;=3, &ldquo;Inicio_mes[1-3]&rdquo; , #En la ultima semana tratan de igualar los ingresos para disminuir su IGV<br/> ifelse(MD_Factura$dia_mes&gt;=25, &ldquo;Fin_mes[25-31]&rdquo;, #En la ultima semana tratan de igualar los ingresos para disminuir su IGV<br/> &ldquo;Otros[4-24]&rdquo;))</p>\n<p>fwrite(MD_Factura,&ldquo;mod_MD_Factura_enero_19.csv&rdquo;, row.names = F)</p>\n<p>#&mdash;&mdash;-3. Cargar Matriz de Datos (nivel Factura) - Unir facturas con detalle &mdash;&mdash;&mdash;<br/>rm(list = ls())<br/>gc()<br/>library(tidyverse)<br/>library(data.table)<br/>library(stringi)<br/>library(SnowballC)<br/>library(corpus)<br/>library(tictoc)<br/>memory.limit(size = 12000)<br/>MatrizD &lt;- fread(&ldquo;mod_MD_Factura_enero_19.csv&rdquo;)<br/>MatrizD$NUM_RUC=as.character(MatrizD$NUM_RUC)<br/>MatrizD$NUM_SERIECPE=as.character(MatrizD$NUM_SERIECPE)<br/>MatrizD$NUM_CPE=as.character(MatrizD$NUM_CPE)</p>\n<p>cpes &lt;- fread(&ldquo;mod_cpes_limpio_enero_19.csv&rdquo;, colClasses = list(character=1:5))</p>\n<p>CPEjoin &lt;- inner_join(cpes,MatrizD, by = c(&ldquo;NUM_RUC&rdquo;,&ldquo;NUM_SERIECPE&rdquo;,&ldquo;NUM_CPE&rdquo;)) ### JOINN</p>\n<p>CPEjoin &lt;- fread(&ldquo;mod_CPEjoin_enero_2019_2.csv&rdquo;, colClasses = list(character=1:6))<br/>names(CPEjoin) &lt;- c(&ldquo;NUM_RUC&rdquo;,&ldquo;NUM_SERIECPE&rdquo;,&ldquo;NUM_CPE&rdquo;,&ldquo;COD_TIPOCOMP&rdquo;,&ldquo;NUM_DOCIDENTI&rdquo;,&ldquo;COD_MON&rdquo;,&ldquo;MTO_IMPCPE&rdquo;,&ldquo;MTO_IGVCPE&rdquo;,&ldquo;MTO_TOTAL&rdquo;,&ldquo;FEC_EMICPE&rdquo;,&ldquo;COD_ACT_PRINC&rdquo;,&ldquo;AP_EMISOR&rdquo;,&ldquo;AS1_EMISOR&rdquo;,&ldquo;AS2_EMISOR&rdquo;,&ldquo;RS_EMISOR&rdquo;,&ldquo;CONDICION&rdquo;,&ldquo;ESTADO&rdquo; ,&ldquo;TIPO_EMP&rdquo;,&ldquo;COND_DOMICILIO&rdquo;,&ldquo;UBIGEO_EMIS&rdquo;,&ldquo;CATEGO_OBJETIVO&rdquo;,&ldquo;ACTIVIDAD_ECONOMICA&rdquo;,&ldquo;LLAVE&rdquo;,&ldquo;COD_AP_RECEP&rdquo;,&ldquo;AP_RECEPTOR&rdquo;,&ldquo;AS1_RECEPTOR&rdquo;,&ldquo;AS2_RECEPTOR&rdquo;,&ldquo;RS_RECEPTOR&rdquo;,&ldquo;TIP_EMP_RECEP&rdquo;,&ldquo;UBIGEO_RECEP&rdquo;,&ldquo;COND_DOM_RECEP&rdquo;,&ldquo;CONDICION_RECEP&rdquo;,&ldquo;ESTADO_RECEP&rdquo;,&ldquo;IND1&rdquo;,&ldquo;DIA_SEMANA&rdquo;,&ldquo;DIA_MES&rdquo;,&ldquo;DES_DETITM&rdquo;)</p>\n<p>CPEjoin &lt;- subset(CPEjoin, DES_DETITM != &ldquo;\\N&rdquo;)<br/>CPEjoin &lt;- subset(CPEjoin, DES_DETITM != &quot;&quot;)<br/>rm(MatrizD, cpes)<br/>gc()</p>\n<p>fwrite(CPEjoin, &ldquo;mod_CPEjoin_enero_2019_2.csv&rdquo;, row.names = F)</p>\n<p>Llaves &lt;-<br/> CPEjoin %&gt;%<br/> group_by(LLAVE,AP_RECEPTOR, AS1_RECEPTOR, AS2_RECEPTOR) %&gt;%<br/> summarise(Nitems = n(), Descripcion = paste(DES_DETITM, collapse = &ldquo; &rdquo;))<br/>rm(CPEjoin)<br/>gc()</p>\n<p>fwrite(Llaves, &ldquo;mod_Llaves_2.csv&rdquo;, row.names = F)</p>\n<p>Llaves$Descripcion &lt;- trimws(Llaves$Descripcion)<br/>Llaves &lt;- Llaves[Llaves$Descripcion != &quot;&quot;,]</p>\n<p>datosLL &lt;- NULL<br/>tokenLL &lt;- NULL<br/>palabras_llave_R &lt;- list()</p>\n<p>for (i in 1:length(Llaves$Descripcion)) {<br/> datosLL &lt;- data_frame(txt=Llaves$Descripcion[i])<br/> tokenLL &lt;- as.data.frame(text_tokens(datosLL$txt, stemmer = &ldquo;sp&rdquo;))<br/> names(tokenLL) &lt;- &ldquo;word&rdquo;<br/> tokenLL$word &lt;- as.character(tokenLL$word)<br/> palabras_llave_R<a href=\"./i.html\">i</a> &lt;- as.data.frame(tokenLL %&gt;% count(word,sort = T))<br/> palabras_llave_R<a href=\"./i.html\">i</a>$llave &lt;- Llaves$LLAVE[i]<br/> palabras_llave_R<a href=\"./i.html\">i</a>$apy &lt;- Llaves$AP_RECEPTOR[i]<br/> palabras_llave_R<a href=\"./i.html\">i</a>$as1 &lt;- Llaves$AS1_RECEPTOR[i]<br/> palabras_llave_R<a href=\"./i.html\">i</a>$as2 &lt;- Llaves$AS2_RECEPTOR[i]<br/> if(i%%10000==0) {print(i)}<br/>}<br/>save(palabras_llave_R, file = &ldquo;mod_palabras_llave_R_enero_19_1.RData&rdquo;)<br/>rm(datosLL, tokenLL, Llaves)<br/>gc()</p>\n<p>#&mdash;&mdash;&mdash;- Indicador ProporciÃ³n de DIFERENCIAS (palabrasRECEPTOR vs palabrasCIIU) &mdash;&mdash;&ndash;<br/>rm(list = ls())<br/>gc()<br/>library(tidyverse)<br/>library(data.table)<br/>library(stringi)<br/>library(SnowballC)<br/>library(corpus)<br/>library(tictoc)<br/>library(tidytext)</p>\n<p>memory.limit(size = 12000)</p>\n<p>load(&ldquo;mod_palabras_llave_R_enero_19_1.RData&rdquo;)<br/>P_ll_r &lt;- do.call(rbind.data.frame, palabras_llave_R)<br/>P_ll_r &lt;- P_ll_r %&gt;% filter(nchar(word)&gt;=3)<br/>rm(palabras_llave_R)<br/>gc()<br/>Wr &lt;- fread(&ldquo;Words_gnd2.csv&rdquo;)<br/>Wr$cwords &lt;- as.character(Wr$cwords)<br/>Wr$APY &lt;- as.character(Wr$APY)<br/>Wr$APY &lt;- stri_trans_tolower(Wr$APY)<br/>Wr$control &lt;- 1</p>\n<p>PrWr &lt;- left_join(P_ll_r,Wr,by=c(&ldquo;word&rdquo;=&ldquo;cwords&rdquo;,&ldquo;apy&rdquo;=&ldquo;APY&rdquo;))<br/>PrWr$control[is.na(PrWr$control)] &lt;- 0<br/>table(PrWr$control)</p>\n<p>PrWr2 &lt;- left_join(P_ll_r,Wr,by=c(&ldquo;word&rdquo;=&ldquo;cwords&rdquo;,&ldquo;as1&rdquo;=&ldquo;APY&rdquo;))<br/>PrWr2$control[is.na(PrWr2$control)] &lt;- 0<br/>table(PrWr2$control)</p>\n<p>PrWr3 &lt;- left_join(P_ll_r,Wr,by=c(&ldquo;word&rdquo;=&ldquo;cwords&rdquo;,&ldquo;as2&rdquo;=&ldquo;APY&rdquo;))<br/>PrWr3$control[is.na(PrWr3$control)] &lt;- 0<br/>table(PrWr3$control)</p>\n<p>PrWr$control &lt;- ifelse(PrWr$control + PrWr2$control + PrWr3$control == 0, 0, 1)</p>\n<p>LlavesR &lt;- PrWr %&gt;% group_by(llave) %&gt;% summarise(N=n(), Suma = sum(control), PropCom = Suma/n(), PropDif = (n()-Suma)/n() )<br/>LlavesR &lt;- as.data.frame(LlavesR)<br/>rm(PrWr, PrWr2, PrWr3, P_ll_r, Wr)<br/>gc()<br/>fwrite(LlavesR, &ldquo;mod_LlavesR201901.csv&rdquo;, row.names = F)</p>\n<p>#&mdash;&mdash;&mdash;- CosntrucciÃ³n de output Final &mdash;&mdash;-<br/>facturas &lt;- fread(&ldquo;mod_CPEjoin_enero_2019_2.csv&rdquo;)<br/>detalles &lt;- facturas %&gt;% select(LLAVE, DES_DETITM)<br/>facturas &lt;- facturas %&gt;% select(LLAVE, COD_MON,MTO_IMPCPE, MTO_IGVCPE, MTO_TOTAL, FEC_EMICPE, NUM_RUC, AP_EMISOR, AS1_EMISOR,<br/> AS2_EMISOR, RS_EMISOR, CONDICION, ESTADO, TIPO_EMP, #tamano,dia_mes_cat<br/> COND_DOMICILIO, UBIGEO_EMIS, NUM_DOCIDENTI, AP_RECEPTOR, AS1_RECEPTOR, AS2_RECEPTOR,<br/> RS_RECEPTOR, UBIGEO_RECEP, COND_DOM_RECEP, CONDICION_RECEP, ESTADO_RECEP,<br/> DIA_SEMANA, DIA_MES, TIP_EMP_RECEP)<br/>facturas &lt;- unique(facturas)</p>\n<p>detalles &lt;- detalles %&gt;% group_by(LLAVE) %&gt;% summarise(Nitems = n(),<br/> Descripcion = paste(DES_DETITM, collapse = &ldquo; ** &rdquo;))</p>\n<p>facturas &lt;- inner_join(facturas, detalles, by = c(&ldquo;LLAVE&rdquo;))<br/>facturas &lt;- inner_join(facturas, LlavesR, by = c(&ldquo;LLAVE&rdquo;=&ldquo;llave&rdquo;))<br/>facturas$NUM_RUC &lt;- as.character(facturas$NUM_RUC)<br/>facturas$NUM_DOCIDENTI &lt;- as.character(facturas$NUM_DOCIDENTI)</p>\n<p>regimen &lt;- fread(&ldquo;regimen.txt&rdquo;)<br/>facturas &lt;- inner_join(facturas, regimen, by=c(&ldquo;NUM_DOCIDENTI&rdquo;=&ldquo;vfp_numruc&rdquo;))</p>\n<p>facturas &lt;- facturas %&gt;% filter(regimen != &ldquo;REGIMEN RUS&rdquo;)<br/>facturas &lt;- facturas %&gt;% filter(regimen != &ldquo;REGIMEN ESPECIAL&rdquo;)</p>\n<p>facturas$MTO_IGVCPE &lt;- as.numeric(facturas$MTO_IGVCPE)<br/>facturas$MTO_IMPCPE &lt;- as.numeric(facturas$MTO_IMPCPE)</p>\n<p>#Revisar porque la ecuación está incorrecto debería de ser MTO_TOTAL + MTO_IGVCPE = MTO_IMPCPE</p>\n<p>#facturas$MTO_TOTAL &lt;- facturas$MTO_IGVCPE + facturas$MTO_IMPCPE</p>\n<p>tip_camb &lt;- 3.3473 #Promedio diario del mes de enero del tipo de cambio según la SUNAT<br/>facturas$MTO_IMPCPE &lt;- ifelse(facturas$COD_MON==&ldquo;usd&rdquo;, facturas$MTO_IMPCPE*tip_camb, facturas$MTO_IMPCPE)<br/>facturas$MTO_IGVCPE &lt;- ifelse(facturas$COD_MON==&ldquo;usd&rdquo;, facturas$MTO_IGVCPE*tip_camb, facturas$MTO_IGVCPE)<br/>facturas$MTO_TOTAL &lt;- ifelse(facturas$COD_MON==&ldquo;usd&rdquo;, facturas$MTO_TOTAL*tip_camb, facturas$MTO_TOTAL)</p>\n<p>fwrite(facturas, &ldquo;mod_fact_gnd_enero_2019_3.csv&rdquo;, row.names = F)</p>\n<p>####PRIMERA SALIDA CON LOS FILTROS DE SIEMPRE</p>\n<p>#&mdash;&ndash;Salida - de 100pre&mdash;-<br/>rm(list = ls())<br/>gc()<br/>library(tidyverse)<br/>library(data.table)<br/>library(stringi)<br/>library(dummies)<br/>library(SnowballC)<br/>library(corpus)<br/>library(tictoc)<br/>memory.limit(size = 12000)</p>\n<p>salida &lt;- fread(&ldquo;mod_fact_gnd_enero_2019_3.csv&rdquo;)<br/>salida &lt;- salida %&gt;% filter(MTO_TOTAL&gt;=0.05*4200)<br/>salida &lt;- salida %&gt;% filter(PropDif&gt;0.2)</p>\n<p>dependencia &lt;- fread(&ldquo;dependencia.csv&rdquo;)</p>\n<p>salida &lt;- inner_join(salida, dependencia,by=c(&ldquo;NUM_DOCIDENTI&rdquo; = &ldquo;RUC&rdquo;))<br/>salida &lt;- salida %&gt;% filter(DEPENDENCIA!=&ldquo;0011&rdquo;)<br/>rm(dependencia)<br/>gc()</p>\n<p>aux3 &lt;- fread(&ldquo;vts_dec_men_pdt.csv&rdquo;)</p>\n<h1>Para las facturas</h1>\n<p>aux4 &lt;- salida %&gt;% group_by(NUM_DOCIDENTI) %&gt;% summarise(MTO_GND = sum(MTO_TOTAL))</p>\n<p>aux5 &lt;- inner_join(aux4, aux3, by=c(&ldquo;NUM_DOCIDENTI&rdquo; = &ldquo;n_doc_declado&rdquo;))<br/>aux5$rat1 &lt;- ifelse(aux5$MTO_VTAS_DEC==0,1,aux5$MTO_GND/aux5$MTO_VTAS_DEC)</p>\n<p>salida1 &lt;- inner_join(salida, aux5, by = &ldquo;NUM_DOCIDENTI&rdquo;)<br/>salida2 &lt;- salida1 %&gt;% filter(rat1&gt;0.1)</p>\n<p>fwrite(salida2, &ldquo;mod_fact_gnd_enero_19_CLASICA.csv&rdquo;, row.names = F)</p>\n<p>#&mdash;&ndash;Otros filtros&mdash;-<br/>rm(list = ls())<br/>gc()<br/>library(tidyverse)<br/>library(data.table)<br/>library(stringi)<br/>library(dummies)<br/>library(SnowballC)<br/>library(corpus)<br/>library(tictoc)<br/>memory.limit(size = 12000)</p>\n<p>salida &lt;- fread(&ldquo;mod_fact_gnd_enero_2019_3.csv&rdquo;)</p>\n<p>blanca &lt;- c(&ldquo;valor minimo mensual&rdquo;, &ldquo;desarrollo comerc&rdquo;, &ldquo;intercambio tarj&rdquo;,<br/> &ldquo;porcentual men&rdquo;, &ldquo;gasto comun fijo&rdquo;, &ldquo;prediales&rdquo;, &ldquo;inversion publicitaria&rdquo;,<br/> &ldquo;vales compra&rdquo;, &ldquo;variable mensual&rdquo;, &ldquo;renta fija mensual&rdquo;, &ldquo;adelanto resultado consorcio&rdquo;,<br/> &ldquo;venta inmueble&rdquo;, &ldquo;rancho&rdquo;, &ldquo;contrato suscrito&rdquo;, &ldquo;redencion puntos&rdquo;, &ldquo;despacho centralizado&rdquo;,<br/> &ldquo;alimentacion personal&rdquo;, &ldquo;comision recaudacion&rdquo;, &ldquo;alimentacion comedor&rdquo;, &ldquo;acuerdo auspicio&rdquo;,<br/> &ldquo;alquiler local&rdquo;, &ldquo;publicidad promociones&rdquo;, &ldquo;ambulancia urbana&rdquo;, &ldquo;cesion tda&rdquo;,<br/> &ldquo;promociones diversas&rdquo;, &ldquo;renta minima&rdquo;)</p>\n<h1>View(salida[grep(&ldquo;cesion tda&rdquo;, salida$Descripcion),])</h1>\n<p>quitar &lt;- NULL<br/>for (i in blanca) {<br/> a &lt;- grep(i, salida$Descripcion)<br/> quitar &lt;- c(quitar,a)<br/>}<br/>quitar &lt;- unique(quitar)<br/>salida &lt;- salida[-quitar,]</p>\n<p>actividades &lt;- c(&ldquo;EXT. DE MIN. METALIFEROS NO FERROSOS.&rdquo;, &ldquo;CONSTRUCCION EDIFICIOS COMPLETOS.&rdquo;)<br/>aux1 &lt;- salida %&gt;% filter(AP_RECEPTOR %in% actividades | AS1_RECEPTOR %in% actividades | AS2_RECEPTOR %in% actividades)<br/>aux1 &lt;- aux1[-grep(&ldquo;alimentac&rdquo;, aux1$Descripcion),]<br/>aux2 &lt;- salida %&gt;% filter(!(AP_RECEPTOR %in% actividades | AS1_RECEPTOR %in% actividades | AS2_RECEPTOR %in% actividades))</p>\n<p>salida &lt;- rbind(aux1, aux2)</p>\n<h1>fwrite(salida, &ldquo;borrar.csv&rdquo;, row.names = F)</h1>\n<h1>aux &lt;- salida %&gt;% group_by(AP_RECEPTOR) %&gt;% summarise(Mediana_mto_tot = median(MTO_TOTAL),</h1>\n<h1>Promedio_mto_tot = mean(MTO_TOTAL),</h1>\n<h1>Des_est_mto_to = sd(MTO_TOTAL),</h1>\n<h1>p5 = quantile(MTO_TOTAL,0.05),</h1>\n<h1>p10 = quantile(MTO_TOTAL,0.10),</h1>\n<h1>p15 = quantile(MTO_TOTAL,0.15),</h1>\n<h1>p25 = quantile(MTO_TOTAL,0.25),</h1>\n<h1>p35 = quantile(MTO_TOTAL,0.35),</h1>\n<h1>p45 = quantile(MTO_TOTAL,0.45),</h1>\n<h1>p55 = quantile(MTO_TOTAL,0.55),</h1>\n<h1>p65 = quantile(MTO_TOTAL,0.65),</h1>\n<h1>p75 = quantile(MTO_TOTAL,0.75),</h1>\n<h1>p85 = quantile(MTO_TOTAL,0.85),</h1>\n<h1>p95 = quantile(MTO_TOTAL,0.95),</h1>\n<h1>p99 = quantile(MTO_TOTAL,0.99))</h1>\n<h1>fwrite(aux, &ldquo;compras_x_ciiu.csv&rdquo;, row.names = F)</h1>\n<p>salida &lt;- salida %&gt;% filter(MTO_TOTAL&gt;5 &amp; MTO_TOTAL&lt;200000)</p>\n<h1>salida &lt;- salida %&gt;% filter(MTO_TOTAL&gt;=0.05*4150)</h1>\n<p>salida &lt;- salida %&gt;% filter(PropDif&gt;0.3)</p>\n<p>dependencia &lt;- fread(&ldquo;dependencia.csv&rdquo;)</p>\n<p>salida &lt;- inner_join(salida, dependencia,by=c(&ldquo;NUM_DOCIDENTI&rdquo; = &ldquo;RUC&rdquo;))<br/>salida &lt;- salida %&gt;% filter(DEPENDENCIA!=&ldquo;0011&rdquo;)<br/>rm(dependencia)<br/>gc()</p>\n<p>aux &lt;- salida %&gt;% group_by(NUM_DOCIDENTI) %&gt;% summarise(MTO_TOT_GND = sum(MTO_TOTAL))<br/>salida &lt;- inner_join(salida, aux, by = &ldquo;NUM_DOCIDENTI&rdquo;)</p>\n<p>fwrite(salida, &ldquo;mod_salida_gnd_ene_19_I.csv&rdquo;, row.names = F)</p>\n<p>salida &lt;- fread(&ldquo;mod_fact_gnd_enero_2019_3.csv&rdquo;,colClasses = list(character=7:18))</p>\n<h1>Lectura de ficha con correos</h1>\n<p>Ficha_Nacional &lt;- fread(&ldquo;ficha_nacional_luis.unl&rdquo;, sep = &ldquo;|&rdquo;, colClasses = rep(&ldquo;character&rdquo;, 19),<br/> select = c(&ldquo;ruc&rdquo;, &ldquo;telef_1&rdquo;, &ldquo;telef_2&rdquo;, &ldquo;correo_1&rdquo;, &ldquo;correo_2&rdquo;))</p>\n<p>#Ficha_Nacional &lt;- Ficha_Nacional %&gt;% select(ruc, telef_1, telef_2, correo_1, correo_2)</p>\n<p>names(Ficha_Nacional)<br/>gc()</p>\n<p>#salida$NUM_DOCIDENTI &lt;- as.character(salida$NUM_DOCIDENTI)</p>\n<p>salida2 &lt;- inner_join(salida, Ficha_Nacional, by = c(&ldquo;NUM_DOCIDENTI&rdquo; = &ldquo;ruc&rdquo;))<br/>fwrite(salida2, &ldquo;mod_salida_gnd_ene_19_I_I.csv&rdquo;, row.names = F)</p>\n<p>final = fread(&ldquo;mod_salida_gnd_ene_19_I_I.csv&rdquo;)</p>\n<p>aux &lt;- salida2 %&gt;% select(NUM_DOCIDENTI, telef_1, telef_2, correo_1, correo_2)<br/>aux &lt;- unique(aux)<br/>View(table(aux$correo_1))</p>\n<p>View(aux %&gt;% filter(correo_1 == &quot;<a href=\"mailto:&#106;a&#110;&#x65;&#x74;&#x74;&#x37;&#54;&#x39;&#x40;h&#111;&#x74;&#109;a&#105;&#108;&#46;c&#111;m&#x22;&#41;\">&#106;a&#110;&#x65;&#x74;&#x74;&#x37;&#54;&#x39;&#x40;h&#111;&#x74;&#109;a&#105;&#108;&#46;c&#111;m&#x22;&#41;</a>)</p>\n<p>aux3 &lt;- fread(&ldquo;vts_dec_men_pdt.csv&rdquo;,colClasses = list(character=1))</p>\n<h1>Para las facturas</h1>\n<p>aux4 &lt;- salida %&gt;% group_by(NUM_DOCIDENTI) %&gt;% summarise(MTO_GND = sum(MTO_TOTAL))</p>\n<p>aux5 &lt;- inner_join(aux4, aux3, by=c(&ldquo;NUM_DOCIDENTI&rdquo; = &ldquo;n_doc_declado&rdquo;))<br/>aux5$rat1 &lt;- ifelse(aux5$MTO_VTAS_DEC==0,1,aux5$MTO_GND/aux5$MTO_VTAS_DEC)</p>\n<p>salida1 &lt;- inner_join(salida, aux5, by = &ldquo;NUM_DOCIDENTI&rdquo;)<br/>salida2 &lt;- salida1 %&gt;% filter(rat1&gt;=0.1)</p>\n<p>#salida2$NUM_RUC &lt;- as.character(salida2$NUM_RUC)</p>\n<p>sal1 &lt;- salida2 %&gt;% filter(NUM_RUC %in% c(&ldquo;20109072177&rdquo;, &ldquo;20100070970&rdquo;))<br/>filtros &lt;- c(&ldquo;alquil&rdquo;, &ldquo;desarrollo comerc&rdquo;, &ldquo;intercambio tarj&rdquo;,<br/> &ldquo;porcentual men&rdquo;, &ldquo;gasto comun fijo&rdquo;, &ldquo;prediales&rdquo;, &ldquo;inversion publicitaria&rdquo;,<br/> &ldquo;vales compra&rdquo;, &ldquo;variable mensual&rdquo;, &ldquo;renta fija mensual&rdquo;)<br/>quitar &lt;- NULL<br/>for (i in filtros) {<br/> a &lt;- grep(i, sal1$Descripcion)<br/> quitar &lt;- c(quitar,a)<br/>}<br/>quitar &lt;- unique(quitar)<br/>sal1 &lt;- sal1[-quitar,]</p>\n<p>sal2 &lt;- salida2 %&gt;% filter(!NUM_RUC %in% c(&ldquo;20109072177&rdquo;, &ldquo;20100070970&rdquo;))</p>\n<h1>aaa &lt;- grep(&ldquo;alquil&rdquo;, sal2$Descripcion)</h1>\n<h1>View(sal2[aaa,])</h1>\n<p>salida2 &lt;- rbind(sal1, sal2)</p>\n<p>fwrite(salida2, &ldquo;mod_fact_gnd_enero_19_5.csv&rdquo;, row.names = F)</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1552505970522_-785743298","id":"20190219-171825_801042720","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77596"},{"text":"%md\n# 1.1. Limpieza","dateUpdated":"2019-03-13T15:39:30-0400","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>1.1. Limpieza</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1552505970524_-788051791","id":"20190219-171851_1601704960","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77597"},{"title":"Cargar Data","text":"%livy2.pyspark\npalabras_llave_r = spark.sql('select * from ds02_gastos_no_deducibles.201811_palabras_llave_r')","user":"jrodriguez","dateUpdated":"2019-03-13T15:42:14-0400","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970526_-787282294","id":"20190219-173332_1174343323","dateCreated":"2019-03-13T15:39:30-0400","dateStarted":"2019-03-13T15:42:14-0400","dateFinished":"2019-03-13T15:42:15-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:77598"},{"text":"%livy2.pyspark\npalabras_llave_r.count()","dateUpdated":"2019-03-13T15:39:30-0400","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"407395"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0682<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0682/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0682/</a>"}]},"apps":[],"jobName":"paragraph_1552505970527_-787667042","id":"20190220-115200_1602885295","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77599"},{"title":"Función para eliminar tildes","text":"%livy2.pyspark\nfrom pyspark.sql.types import StringType, IntegerType, StructType, StructField\nfrom pyspark.sql.functions import udf, col\nimport unicodedata\n\nclass Test():\n    def __init__(self,df):\n        self.df = df\n    \n    def clearAccents(self,columns):\n        validCols = [c for (c,t) in filter(lambda t: t[1] == 'string', self.df.dtypes)]\n        if (columns == \"*\"): columns = validCols[:]\n            \n        def remove_accents(inputStr):\n            nfkdStr = unicodedata.normalize('NFKD', inputStr)\n            withOutAccents = u\"\".join([c for c in nfkdStr if not unicodedata.combining(c)])\n            return  withOutAccents\n        \n        function = udf(lambda x: remove_accents(x) if x != None else x, StringType())\n        exprs = [function(col(c)).alias(c) if (c in columns) and (c in validCols) else c for c in self.df.columns]\n        self.df = self.df.select(*exprs)","dateUpdated":"2019-03-13T15:42:21-0400","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0682<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0682/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0682/</a>"}]},"apps":[],"jobName":"paragraph_1552505970528_-801902752","id":"20190219-173443_441722144","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77600"},{"title":"Funciones para limpieza","text":"%livy2.pyspark\nfrom pyspark.sql import functions as f\ndef clean_column_row(value):\n    if type(value)!=str:  \n        return value\n    value = value.strip()\n    value = value.lower()\n    if len(value)==0:\n        return None\n    return value\n\nclean_column = f.udf(clean_column_row,'string')\n\ndef depure_string(col):\n    if type(col)!=str:\n        return col\n    return f.regexp_replace(f.regexp_replace(f.regexp_replace(col,\"\\?\",\"o\"),\"[^a-z]\", \" \"),\"\\\\s+\", \" \")","user":"jrodriguez","dateUpdated":"2019-03-13T15:42:22-0400","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970530_-801133254","id":"20190220-083926_748866323","dateCreated":"2019-03-13T15:39:30-0400","dateStarted":"2019-03-13T15:42:22-0400","dateFinished":"2019-03-13T15:42:23-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:77601"},{"title":"Aplicación de Funciones","text":"%livy2.pyspark\n#Tdata = Test(palabras_llave_r)\n#Tdata.clearAccents(columns = \"*\")\n#palabras_llave_r = Tdata.df\npalabras_llave_r = palabras_llave_r.withColumn('descripcion',clean_column('descripcion'))\npalabras_llave_r = palabras_llave_r.withColumn('descripcion',depure_string('descripcion'))\n\n\npalabras_llave_r.count()","user":"jrodriguez","dateUpdated":"2019-03-13T15:42:26-0400","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"407395"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970531_-801518003","id":"20190220-093129_1793172602","dateCreated":"2019-03-13T15:39:30-0400","dateStarted":"2019-03-13T15:42:26-0400","dateFinished":"2019-03-13T15:42:39-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:77602"},{"text":"%livy2.pyspark\n\nfrom pyspark.ml.feature import RegexTokenizer, StopWordsRemover\nfrom pyspark.ml import Pipeline\n\nregexTokenizer = RegexTokenizer(inputCol = 'descripcion', outputCol = 'words', pattern='\\\\W')\n\nadd_stopwords = [\"Add word 1\", \"Add word 2\"]\nstopwordsSpanish = StopWordsRemover.loadDefaultStopWords(\"spanish\")\n\nstopwordsRemover1 = StopWordsRemover(inputCol = \"words\", outputCol = \"filtered1\").setStopWords(add_stopwords)\nstopwordsRemover2 = StopWordsRemover(inputCol = \"filtered1\", outputCol = \"filtered\").setStopWords(stopwordsSpanish)\n\npipeline = Pipeline(stages = [regexTokenizer,stopwordsRemover1,stopwordsRemover2])\npipelineFit = pipeline.fit(palabras_llave_r)\npalabras_llave_r = pipelineFit.transform(palabras_llave_r)\n\npalabras_llave_r.write.format(\"parquet\").saveAsTable(\"ds02_gastos_no_deducibles.201811_palabras_llave_r_tabla\")\n\n","user":"jrodriguez","dateUpdated":"2019-03-13T15:43:53-0400","config":{"tableHide":true,"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"'Output column words already exists.'\nTraceback (most recent call last):\n  File \"/usr/hdp/current/spark2-client/python/lib/pyspark.zip/pyspark/ml/base.py\", line 105, in transform\n    return self._transform(dataset)\n  File \"/usr/hdp/current/spark2-client/python/lib/pyspark.zip/pyspark/ml/pipeline.py\", line 193, in _transform\n    dataset = t.transform(dataset)\n  File \"/usr/hdp/current/spark2-client/python/lib/pyspark.zip/pyspark/ml/base.py\", line 105, in transform\n    return self._transform(dataset)\n  File \"/usr/hdp/current/spark2-client/python/lib/pyspark.zip/pyspark/ml/wrapper.py\", line 281, in _transform\n    return DataFrame(self._java_obj.transform(dataset._jdf), dataset.sql_ctx)\n  File \"/usr/hdp/current/spark2-client/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py\", line 1133, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n  File \"/usr/hdp/current/spark2-client/python/lib/pyspark.zip/pyspark/sql/utils.py\", line 79, in deco\n    raise IllegalArgumentException(s.split(': ', 1)[1], stackTrace)\npyspark.sql.utils.IllegalArgumentException: 'Output column words already exists.'\n"}]},"apps":[],"jobName":"paragraph_1552505970533_-803826496","id":"20190228-173805_1299650905","dateCreated":"2019-03-13T15:39:30-0400","dateStarted":"2019-03-13T15:43:28-0400","dateFinished":"2019-03-13T15:43:29-0400","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:77603"},{"text":"%livy2.pyspark\npalabras_llave_r.write.format(\"parquet\").saveAsTable(\"ds02_gastos_no_deducibles.201811_palabras_llave_r_tabla\")","user":"jrodriguez","dateUpdated":"2019-03-13T15:43:49-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552506192382_528679894","id":"20190313-154312_2129769663","dateCreated":"2019-03-13T15:43:12-0400","dateStarted":"2019-03-13T15:43:49-0400","dateFinished":"2019-03-13T15:44:22-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:77604"},{"text":"%livy2.sql\nselect count(distinct llave_cpe),count(*),count(distinct rec_act_principal) from ds02_gastos_no_deducibles.201811_palabras_llave_r_tabla","dateUpdated":"2019-03-13T15:39:30-0400","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"table","height":84,"optionOpen":false}}},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(DISTINCT llave_cpe)\tcount(1)\tcount(DISTINCT rec_act_principal)\n407395\t407395\t281"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970534_-802672250","id":"20190313-151256_576084695","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77605"},{"text":"%livy2.pyspark\npalabras_llave_r.count()\n","dateUpdated":"2019-03-13T15:39:30-0400","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"407395"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0682<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0682/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0682/</a>"}]},"apps":[],"jobName":"paragraph_1552505970535_-803056998","id":"20190313-132019_1406946","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77606"},{"text":"%livy2.pyspark\nfrom pyspark.sql.functions import explode, desc\n\ndata_word = palabras_llave_r.select(palabras_llave_r.llave_cpe,palabras_llave_r.rec_act_principal,palabras_llave_r.rec_act_secun1,palabras_llave_r.rec_act_secun2,explode(palabras_llave_r.filtered).alias('word'))\ndata_word = data_word.groupBy('llave_cpe','rec_act_principal','rec_act_secun1','rec_act_secun2','word').count().filter(f.length(data_word.word)>=3)\ndata_word.write.format(\"parquet\").saveAsTable(\"ds02_gastos_no_deducibles.201811_p_ll_r\")","user":"jrodriguez","dateUpdated":"2019-03-13T15:44:30-0400","config":{"tableHide":true,"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970537_-805365492","id":"20190220-114805_553250527","dateCreated":"2019-03-13T15:39:30-0400","dateStarted":"2019-03-13T15:44:31-0400","dateFinished":"2019-03-13T15:44:59-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:77607"},{"text":"%livy2.pyspark\ndata_word.count()","dateUpdated":"2019-03-13T15:39:30-0400","config":{"tableHide":true,"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"name 'data_word' is not defined\nTraceback (most recent call last):\nNameError: name 'data_word' is not defined\n"}]},"apps":[],"jobName":"paragraph_1552505970538_-804211245","id":"20190313-132059_1672274235","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77608"},{"text":"%livy2.sql\nselect count(distinct llave_cpe), count(*) from ds02_gastos_no_deducibles.201811_p_ll_r","user":"jrodriguez","dateUpdated":"2019-03-13T15:45:04-0400","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"table","height":84,"optionOpen":false}}},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(DISTINCT llave_cpe)\tcount(1)\n406308\t3829698"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970539_-806519739","id":"20190313-151624_740685361","dateCreated":"2019-03-13T15:39:30-0400","dateStarted":"2019-03-13T15:45:04-0400","dateFinished":"2019-03-13T15:45:11-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:77609"},{"text":"%livy2.sql\nselect count(distinct llave_cpe), count(*)  from ds02_gastos_no_deducibles.201811_p_ll_r_V2_procesado\n","user":"jrodriguez","dateUpdated":"2019-03-13T15:56:30-0400","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"table","height":84,"optionOpen":false}}},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(DISTINCT llave_cpe)\tcount(1)\n406308\t3829698"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970541_-806904487","id":"20190306-105420_74745031","dateCreated":"2019-03-13T15:39:30-0400","dateStarted":"2019-03-13T15:56:30-0400","dateFinished":"2019-03-13T15:56:47-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:77610"},{"text":"%livy2.sql\ncreate table ds02_gastos_no_deducibles.201811_llaves_r_v2 as \nselect llave_cpe,count(*) as N, sum(control) as Suma, sum(control)/count(*) as PropCom, 1-(sum(control)/count(*)) as PropDif\nfrom\n    (select llave_cpe, rec_act_principal, rec_act_secun1, rec_act_secun2,count,word,stem,nvl(control1,0) as control1,nvl(control2,0) as control2,nvl(control3,0) as control3 ,\n        case when nvl(control1,0) + nvl(control2,0) + nvl(control3,0) >0 then 1 else 0 end as control\n    from ds02_gastos_no_deducibles.201811_p_ll_r_v2_procesado a\n    left join (select w.*, '1' as control1 from ds02_gastos_no_deducibles.words_gnd2_20181002 w) b on a.stem = b.cwords and trim(a.rec_act_principal) = trim(b.apy)\n    left join (select w.*, '1' as control2 from ds02_gastos_no_deducibles.words_gnd2_20181002 w) c on a.stem = c.cwords and trim(a.rec_act_secun1) = trim(c.apy)\n    left join (select w.*, '1' as control3 from ds02_gastos_no_deducibles.words_gnd2_20181002 w) d on a.stem = d.cwords and trim(a.rec_act_secun2) = trim(d.apy))\ngroup by llave_cpe\n","user":"jrodriguez","dateUpdated":"2019-03-13T15:57:28-0400","config":{"tableHide":true,"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970542_-805750241","id":"20190228-173055_569361108","dateCreated":"2019-03-13T15:39:30-0400","dateStarted":"2019-03-13T15:57:28-0400","dateFinished":"2019-03-13T15:57:42-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:77611"},{"text":"%livy2.sql\nselect * from ds02_gastos_no_deducibles.201811_llaves_r_v2","user":"jrodriguez","dateUpdated":"2019-03-13T15:58:11-0400","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"table","height":84,"optionOpen":false}}},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"llave_cpe\tN\tSuma\tPropCom\tPropDif\n01_20492092313_FT...\t84\t30\t0.35714285714285715\t0.6428571428571428\n01_20109072177_F2...\t52\t19\t0.36538461538461536\t0.6346153846153846\n01_20109072177_F6...\t23\t0\t0.0\t1.0\n01_20501781291_F1...\t7\t6\t0.8571428571428571\t0.1428571428571429\n01_20109072177_F2...\t156\t46\t0.2948717948717949\t0.7051282051282051\n01_20109072177_F3...\t24\t0\t0.0\t1.0\n01_20337564373_FP...\t22\t1\t0.045454545454545456\t0.9545454545454546\n01_20603558813_F0...\t8\t1\t0.125\t0.875\n01_20109072177_F3...\t8\t0\t0.0\t1.0\n01_20492092313_FT...\t74\t23\t0.3108108108108108\t0.6891891891891893\n01_20109072177_F2...\t20\t5\t0.25\t0.75\n01_20492092313_FT...\t34\t0\t0.0\t1.0\n01_20501781291_F1...\t5\t5\t1.0\t0.0\n01_20492092313_FT...\t38\t17\t0.4473684210526316\t0.5526315789473684\n01_20109072177_F2...\t16\t6\t0.375\t0.625\n01_20109072177_F6...\t63\t21\t0.3333333333333333\t0.6666666666666667\n01_20455725012_F9...\t10\t4\t0.4\t0.6\n01_20109072177_F6...\t36\t13\t0.3611111111111111\t0.6388888888888888\n01_20109072177_F2...\t34\t0\t0.0\t1.0\n01_20499859164_F0...\t11\t7\t0.6363636363636364\t0.36363636363636365\n01_20109072177_F6...\t18\t8\t0.4444444444444444\t0.5555555555555556\n01_20109072177_F2...\t31\t12\t0.3870967741935484\t0.6129032258064516\n01_20109072177_F6...\t27\t10\t0.37037037037037035\t0.6296296296296297\n01_20507775889_F0...\t3\t2\t0.6666666666666666\t0.33333333333333337\n01_20109072177_F2...\t40\t13\t0.325\t0.675\n01_20109072177_F2...\t15\t1\t0.06666666666666667\t0.9333333333333333\n01_20100128056_FB...\t7\t0\t0.0\t1.0\n01_20600654226_F0...\t12\t5\t0.4166666666666667\t0.5833333333333333\n01_20109072177_F2...\t68\t24\t0.35294117647058826\t0.6470588235294117\n01_20109072177_F2...\t21\t2\t0.09523809523809523\t0.9047619047619048\n01_20507179411_F0...\t15\t8\t0.5333333333333333\t0.4666666666666667\n01_20109072177_F2...\t9\t6\t0.6666666666666666\t0.33333333333333337\n01_20301806664_F0...\t15\t8\t0.5333333333333333\t0.4666666666666667\n01_20517738701_F2...\t10\t0\t0.0\t1.0\n01_20109072177_F3...\t12\t3\t0.25\t0.75\n01_20102309180_F0...\t11\t3\t0.2727272727272727\t0.7272727272727273\n01_20109072177_F2...\t28\t6\t0.21428571428571427\t0.7857142857142857\n01_20109072177_F6...\t82\t27\t0.32926829268292684\t0.6707317073170731\n01_20282804329_F0...\t167\t104\t0.6227544910179641\t0.3772455089820359\n01_20109072177_F2...\t2\t0\t0.0\t1.0\n01_20494756324_F0...\t13\t5\t0.38461538461538464\t0.6153846153846154\n01_20109072177_F2...\t116\t25\t0.21551724137931033\t0.7844827586206897\n01_20109072177_F6...\t57\t20\t0.3508771929824561\t0.6491228070175439\n01_20109072177_F6...\t12\t8\t0.6666666666666666\t0.33333333333333337\n01_20452430950_F1...\t12\t1\t0.08333333333333333\t0.9166666666666666\n01_20492092313_FT...\t45\t15\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F6...\t11\t6\t0.5454545454545454\t0.4545454545454546\n01_20109072177_F3...\t141\t39\t0.2765957446808511\t0.7234042553191489\n01_20109072177_FH...\t92\t28\t0.30434782608695654\t0.6956521739130435\n01_20109072177_F6...\t5\t1\t0.2\t0.8\n01_20109072177_F6...\t6\t4\t0.6666666666666666\t0.33333333333333337\n01_20109072177_F6...\t40\t0\t0.0\t1.0\n01_20109072177_F6...\t3\t0\t0.0\t1.0\n01_20322594489_E0...\t5\t3\t0.6\t0.4\n01_20136096592_F0...\t16\t6\t0.375\t0.625\n01_20109072177_F3...\t28\t10\t0.35714285714285715\t0.6428571428571428\n01_20109072177_F6...\t7\t3\t0.42857142857142855\t0.5714285714285714\n01_20506900248_F0...\t6\t1\t0.16666666666666666\t0.8333333333333334\n01_20109072177_F2...\t16\t1\t0.0625\t0.9375\n01_20477983708_F0...\t3\t3\t1.0\t0.0\n01_20109072177_F6...\t8\t1\t0.125\t0.875\n01_20109072177_F6...\t15\t4\t0.26666666666666666\t0.7333333333333334\n01_20109072177_F6...\t41\t0\t0.0\t1.0\n01_20109072177_F6...\t75\t25\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F2...\t36\t5\t0.1388888888888889\t0.8611111111111112\n01_20517738701_F2...\t10\t8\t0.8\t0.19999999999999996\n01_20109072177_F2...\t36\t4\t0.1111111111111111\t0.8888888888888888\n01_20109072177_F2...\t13\t2\t0.15384615384615385\t0.8461538461538461\n01_20109072177_F6...\t22\t6\t0.2727272727272727\t0.7272727272727273\n01_20455108838_FA...\t10\t3\t0.3\t0.7\n01_20109072177_F3...\t35\t10\t0.2857142857142857\t0.7142857142857143\n01_20109072177_F6...\t3\t0\t0.0\t1.0\n01_20454135432_F1...\t5\t4\t0.8\t0.19999999999999996\n01_20109072177_F2...\t14\t0\t0.0\t1.0\n01_20109072177_F6...\t89\t17\t0.19101123595505617\t0.8089887640449438\n01_20300745483_F0...\t8\t5\t0.625\t0.375\n01_20492092313_FT...\t48\t17\t0.3541666666666667\t0.6458333333333333\n01_20109072177_F6...\t33\t9\t0.2727272727272727\t0.7272727272727273\n01_20488387074_F0...\t14\t6\t0.42857142857142855\t0.5714285714285714\n01_20127550663_F0...\t18\t7\t0.3888888888888889\t0.6111111111111112\n01_20543722309_FC...\t21\t7\t0.3333333333333333\t0.6666666666666667\n01_20510885229_F1...\t7\t3\t0.42857142857142855\t0.5714285714285714\n01_20109072177_F7...\t19\t0\t0.0\t1.0\n01_20109072177_F2...\t71\t17\t0.23943661971830985\t0.7605633802816901\n01_20109072177_F6...\t4\t0\t0.0\t1.0\n01_20101087647_F0...\t8\t1\t0.125\t0.875\n01_20109072177_F2...\t118\t34\t0.288135593220339\t0.711864406779661\n01_20100178401_F1...\t4\t3\t0.75\t0.25\n01_20109072177_F2...\t27\t9\t0.3333333333333333\t0.6666666666666667\n01_20492092313_FT...\t45\t12\t0.26666666666666666\t0.7333333333333334\n01_20109072177_F2...\t66\t15\t0.22727272727272727\t0.7727272727272727\n01_20109072177_FA...\t6\t3\t0.5\t0.5\n01_20109072177_F2...\t67\t16\t0.23880597014925373\t0.7611940298507462\n01_20109072177_F6...\t9\t4\t0.4444444444444444\t0.5555555555555556\n01_20546300693_F0...\t8\t2\t0.25\t0.75\n01_20109072177_F2...\t35\t13\t0.37142857142857144\t0.6285714285714286\n01_20109072177_F6...\t3\t0\t0.0\t1.0\n01_20109072177_F3...\t7\t1\t0.14285714285714285\t0.8571428571428572\n01_20492092313_FT...\t120\t34\t0.2833333333333333\t0.7166666666666667\n01_15475322565_F0...\t18\t6\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F2...\t19\t4\t0.21052631578947367\t0.7894736842105263\n01_20394723259_F0...\t18\t5\t0.2777777777777778\t0.7222222222222222\n01_20109072177_F6...\t2\t0\t0.0\t1.0\n01_20138470530_F0...\t10\t3\t0.3\t0.7\n01_20109072177_F2...\t12\t0\t0.0\t1.0\n01_20114803228_F6...\t18\t9\t0.5\t0.5\n01_20517738701_F2...\t33\t26\t0.7878787878787878\t0.21212121212121215\n01_20100207941_F2...\t2\t1\t0.5\t0.5\n01_20512451056_F0...\t4\t2\t0.5\t0.5\n01_20109072177_FS...\t7\t5\t0.7142857142857143\t0.2857142857142857\n01_20109072177_F6...\t4\t1\t0.25\t0.75\n01_20109072177_F2...\t49\t10\t0.20408163265306123\t0.7959183673469388\n01_20101904874_F0...\t3\t0\t0.0\t1.0\n01_20109072177_F6...\t20\t5\t0.25\t0.75\n01_20494756324_F0...\t13\t2\t0.15384615384615385\t0.8461538461538461\n01_20109072177_F2...\t2\t0\t0.0\t1.0\n01_20109072177_F3...\t30\t5\t0.16666666666666666\t0.8333333333333334\n01_20100122368_F0...\t4\t3\t0.75\t0.25\n01_20110168803_F0...\t3\t3\t1.0\t0.0\n01_20109072177_F3...\t62\t22\t0.3548387096774194\t0.6451612903225806\n01_20109072177_F6...\t119\t22\t0.18487394957983194\t0.8151260504201681\n01_20517738701_F0...\t3\t0\t0.0\t1.0\n01_20109072177_F6...\t63\t0\t0.0\t1.0\n01_20109072177_F2...\t14\t2\t0.14285714285714285\t0.8571428571428572\n01_20109072177_F3...\t46\t20\t0.43478260869565216\t0.5652173913043479\n01_20101087647_F0...\t14\t6\t0.42857142857142855\t0.5714285714285714\n01_20109072177_F2...\t40\t11\t0.275\t0.725\n01_20109072177_F2...\t28\t11\t0.39285714285714285\t0.6071428571428572\n01_20109072177_F6...\t12\t2\t0.16666666666666666\t0.8333333333333334\n01_20231843460_F0...\t20\t7\t0.35\t0.65\n01_20109072177_F2...\t88\t22\t0.25\t0.75\n01_20452430950_F1...\t11\t0\t0.0\t1.0\n01_20302757641_F1...\t4\t2\t0.5\t0.5\n01_20109072177_F3...\t23\t9\t0.391304347826087\t0.6086956521739131\n01_20109072177_F3...\t6\t0\t0.0\t1.0\n01_20109072177_F6...\t13\t8\t0.6153846153846154\t0.3846153846153846\n01_20507775889_F0...\t3\t2\t0.6666666666666666\t0.33333333333333337\n01_20109072177_F3...\t14\t0\t0.0\t1.0\n01_20109072177_F6...\t151\t65\t0.4304635761589404\t0.5695364238410596\n01_20109072177_F6...\t38\t17\t0.4473684210526316\t0.5526315789473684\n01_20109072177_F3...\t5\t0\t0.0\t1.0\n01_20109072177_F6...\t27\t8\t0.2962962962962963\t0.7037037037037037\n01_20109072177_F3...\t23\t0\t0.0\t1.0\n01_20109072177_F0...\t5\t0\t0.0\t1.0\n01_20492092313_FT...\t19\t10\t0.5263157894736842\t0.4736842105263158\n01_20563027607_F1...\t28\t2\t0.07142857142857142\t0.9285714285714286\n01_20511414408_F1...\t2\t2\t1.0\t0.0\n01_20109072177_F2...\t47\t12\t0.2553191489361702\t0.7446808510638299\n01_20109072177_F2...\t111\t29\t0.26126126126126126\t0.7387387387387387\n01_20109072177_F2...\t7\t4\t0.5714285714285714\t0.4285714285714286\n01_20109072177_F2...\t59\t0\t0.0\t1.0\n01_20303368877_F1...\t3\t1\t0.3333333333333333\t0.6666666666666667\n01_20100123330_FK...\t8\t0\t0.0\t1.0\n01_20109072177_F2...\t3\t0\t0.0\t1.0\n01_20511414408_F1...\t12\t5\t0.4166666666666667\t0.5833333333333333\n01_20109072177_F2...\t24\t14\t0.5833333333333334\t0.41666666666666663\n01_20537469341_F0...\t7\t3\t0.42857142857142855\t0.5714285714285714\n01_20109072177_F2...\t36\t14\t0.3888888888888889\t0.6111111111111112\n01_20109072177_F2...\t14\t4\t0.2857142857142857\t0.7142857142857143\n01_20109072177_F6...\t16\t6\t0.375\t0.625\n01_20109072177_F6...\t30\t12\t0.4\t0.6\n01_20109072177_F3...\t16\t3\t0.1875\t0.8125\n01_20544478096_E0...\t5\t2\t0.4\t0.6\n01_20100121809_F2...\t6\t6\t1.0\t0.0\n01_20109072177_F2...\t35\t15\t0.42857142857142855\t0.5714285714285714\n01_20109072177_F2...\t9\t2\t0.2222222222222222\t0.7777777777777778\n01_20392980157_F0...\t3\t1\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F3...\t153\t48\t0.3137254901960784\t0.6862745098039216\n01_20109072177_F3...\t42\t15\t0.35714285714285715\t0.6428571428571428\n01_20517737560_F4...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F2...\t23\t3\t0.13043478260869565\t0.8695652173913043\n01_20490643142_F0...\t10\t1\t0.1\t0.9\n01_20492092313_FT...\t112\t39\t0.3482142857142857\t0.6517857142857143\n01_20109072177_F3...\t15\t0\t0.0\t1.0\n01_20601835470_F0...\t4\t0\t0.0\t1.0\n01_20109072177_F6...\t5\t2\t0.4\t0.6\n01_20109072177_F2...\t13\t2\t0.15384615384615385\t0.8461538461538461\n01_20492092313_FT...\t107\t39\t0.3644859813084112\t0.6355140186915889\n01_20109072177_F6...\t9\t4\t0.4444444444444444\t0.5555555555555556\n01_20100121809_F2...\t6\t6\t1.0\t0.0\n01_20109072177_F6...\t76\t21\t0.27631578947368424\t0.7236842105263157\n01_20109072177_F6...\t5\t1\t0.2\t0.8\n01_20517738701_F2...\t4\t2\t0.5\t0.5\n01_20136096592_F0...\t5\t3\t0.6\t0.4\n01_20109072177_FH...\t72\t23\t0.3194444444444444\t0.6805555555555556\n01_20109072177_F6...\t7\t3\t0.42857142857142855\t0.5714285714285714\n01_20109072177_F6...\t34\t0\t0.0\t1.0\n01_20453957749_F0...\t6\t5\t0.8333333333333334\t0.16666666666666663\n01_20109072177_F3...\t32\t6\t0.1875\t0.8125\n01_20409382909_F0...\t3\t1\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F2...\t11\t0\t0.0\t1.0\n01_20461665820_F2...\t58\t37\t0.6379310344827587\t0.3620689655172413\n01_20477983708_F9...\t2\t0\t0.0\t1.0\n01_20109072177_F6...\t69\t23\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F2...\t4\t0\t0.0\t1.0\n01_20109072177_F3...\t17\t3\t0.17647058823529413\t0.8235294117647058\n01_20109072177_F6...\t41\t0\t0.0\t1.0\n01_20109072177_F6...\t3\t0\t0.0\t1.0\n01_20109072177_F6...\t40\t0\t0.0\t1.0\n01_20109072177_F6...\t5\t2\t0.4\t0.6\n01_20109072177_F3...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20492092313_FT...\t10\t5\t0.5\t0.5\n01_20505018509_F9...\t11\t8\t0.7272727272727273\t0.2727272727272727\n01_20109072177_F2...\t39\t0\t0.0\t1.0\n01_20504680623_F0...\t4\t2\t0.5\t0.5\n01_20109072177_F0...\t5\t0\t0.0\t1.0\n01_20109072177_F3...\t20\t4\t0.2\t0.8\n01_20109072177_F2...\t90\t28\t0.3111111111111111\t0.6888888888888889\n01_20109072177_F2...\t8\t0\t0.0\t1.0\n01_20109072177_F6...\t28\t6\t0.21428571428571427\t0.7857142857142857\n01_20600989325_FA...\t10\t1\t0.1\t0.9\n01_20429683581_FA...\t18\t2\t0.1111111111111111\t0.8888888888888888\n01_20109072177_F2...\t14\t0\t0.0\t1.0\n01_20492092313_FT...\t8\t1\t0.125\t0.875\n01_20109072177_F2...\t30\t6\t0.2\t0.8\n01_20109072177_F2...\t84\t26\t0.30952380952380953\t0.6904761904761905\n01_20100121809_F2...\t6\t6\t1.0\t0.0\n01_20109072177_F6...\t9\t4\t0.4444444444444444\t0.5555555555555556\n01_20301356952_F0...\t8\t2\t0.25\t0.75\n01_20109072177_F3...\t9\t3\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F6...\t19\t0\t0.0\t1.0\n01_20109072177_F2...\t43\t15\t0.3488372093023256\t0.6511627906976745\n01_20109072177_F6...\t9\t5\t0.5555555555555556\t0.4444444444444444\n01_20100123330_F1...\t6\t1\t0.16666666666666666\t0.8333333333333334\n01_20477983708_F0...\t8\t5\t0.625\t0.375\n01_20109072177_F3...\t16\t3\t0.1875\t0.8125\n01_10063228716_E0...\t4\t0\t0.0\t1.0\n01_20109072177_F2...\t40\t0\t0.0\t1.0\n01_20109072177_F6...\t25\t8\t0.32\t0.6799999999999999\n01_20297451023_FF...\t8\t4\t0.5\t0.5\n01_20109072177_F2...\t33\t0\t0.0\t1.0\n01_20507775889_F0...\t3\t2\t0.6666666666666666\t0.33333333333333337\n01_20109072177_F6...\t8\t2\t0.25\t0.75\n01_20454135432_F1...\t5\t4\t0.8\t0.19999999999999996\n01_20109072177_F2...\t26\t9\t0.34615384615384615\t0.6538461538461539\n01_20101869947_F0...\t6\t0\t0.0\t1.0\n01_20109072177_F6...\t49\t18\t0.3673469387755102\t0.6326530612244898\n01_20226013696_F0...\t12\t8\t0.6666666666666666\t0.33333333333333337\n01_20109072177_F6...\t3\t0\t0.0\t1.0\n01_20109072177_F2...\t22\t0\t0.0\t1.0\n01_20109072177_F6...\t4\t0\t0.0\t1.0\n01_20517738701_F2...\t4\t2\t0.5\t0.5\n01_20109072177_F6...\t23\t7\t0.30434782608695654\t0.6956521739130435\n01_20492092313_FT...\t96\t24\t0.25\t0.75\n01_20109072177_F6...\t36\t13\t0.3611111111111111\t0.6388888888888888\n01_20109072177_F6...\t24\t0\t0.0\t1.0\n01_20109072177_F2...\t4\t2\t0.5\t0.5\n01_20109072177_FA...\t52\t19\t0.36538461538461536\t0.6346153846153846\n01_20109072177_F2...\t19\t0\t0.0\t1.0\n01_20109072177_F6...\t9\t1\t0.1111111111111111\t0.8888888888888888\n01_20109072177_F2...\t25\t0\t0.0\t1.0\n01_20109072177_F2...\t44\t12\t0.2727272727272727\t0.7272727272727273\n01_20109072177_F2...\t18\t9\t0.5\t0.5\n01_20109072177_F6...\t29\t6\t0.20689655172413793\t0.7931034482758621\n01_20109072177_F6...\t34\t9\t0.2647058823529412\t0.7352941176470589\n01_20109072177_F2...\t10\t1\t0.1\t0.9\n01_20109072177_F2...\t10\t1\t0.1\t0.9\n01_20492092313_FT...\t21\t5\t0.23809523809523808\t0.7619047619047619\n01_20109072177_F2...\t22\t3\t0.13636363636363635\t0.8636363636363636\n01_20109072177_F6...\t10\t0\t0.0\t1.0\n01_20109072177_F2...\t21\t8\t0.38095238095238093\t0.6190476190476191\n01_20507775889_F0...\t3\t1\t0.3333333333333333\t0.6666666666666667\n01_20555113731_E0...\t4\t2\t0.5\t0.5\n01_20138998780_F0...\t3\t1\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F6...\t43\t19\t0.4418604651162791\t0.5581395348837209\n01_20109072177_F6...\t2\t0\t0.0\t1.0\n01_20551058043_E0...\t6\t0\t0.0\t1.0\n01_20109072177_F2...\t2\t0\t0.0\t1.0\n01_20115635388_F1...\t9\t3\t0.3333333333333333\t0.6666666666666667\n01_20100122368_F0...\t4\t3\t0.75\t0.25\n01_20100032610_F0...\t1\t0\t0.0\t1.0\n01_20109072177_F2...\t10\t2\t0.2\t0.8\n01_20109072177_F6...\t2\t0\t0.0\t1.0\n01_20109072177_F3...\t97\t25\t0.25773195876288657\t0.7422680412371134\n01_20109072177_F2...\t76\t25\t0.32894736842105265\t0.6710526315789473\n01_20109072177_F2...\t5\t2\t0.4\t0.6\n01_20109072177_F6...\t11\t1\t0.09090909090909091\t0.9090909090909091\n01_20600862295_F0...\t7\t2\t0.2857142857142857\t0.7142857142857143\n01_20531705875_F0...\t11\t0\t0.0\t1.0\n01_20109072177_F6...\t4\t1\t0.25\t0.75\n01_20109072177_F2...\t4\t0\t0.0\t1.0\n01_20530032061_F0...\t38\t5\t0.13157894736842105\t0.868421052631579\n01_20109072177_F6...\t34\t12\t0.35294117647058826\t0.6470588235294117\n01_20109072177_F3...\t16\t2\t0.125\t0.875\n01_20330025213_FM...\t6\t1\t0.16666666666666666\t0.8333333333333334\n01_20109072177_F3...\t39\t11\t0.28205128205128205\t0.717948717948718\n01_20109072177_F3...\t43\t19\t0.4418604651162791\t0.5581395348837209\n01_20109072177_F6...\t14\t3\t0.21428571428571427\t0.7857142857142857\n01_20600135563_FF...\t7\t3\t0.42857142857142855\t0.5714285714285714\n01_20109072177_F6...\t44\t22\t0.5\t0.5\n01_20109072177_F2...\t59\t26\t0.4406779661016949\t0.5593220338983051\n01_20511035059_F0...\t2\t0\t0.0\t1.0\n01_20509778974_F0...\t2\t2\t1.0\t0.0\n01_20502301552_F1...\t15\t6\t0.4\t0.6\n01_20109072177_F6...\t2\t0\t0.0\t1.0\n01_20109072177_F6...\t1\t0\t0.0\t1.0\n01_20107463705_F4...\t14\t12\t0.8571428571428571\t0.1428571428571429\n01_20109072177_F3...\t3\t1\t0.3333333333333333\t0.6666666666666667\n01_20100121809_F2...\t3\t3\t1.0\t0.0\n01_20109072177_F2...\t9\t3\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F6...\t87\t21\t0.2413793103448276\t0.7586206896551724\n01_20492092313_FT...\t45\t20\t0.4444444444444444\t0.5555555555555556\n01_20109072177_F6...\t34\t12\t0.35294117647058826\t0.6470588235294117\n01_20109072177_FA...\t6\t1\t0.16666666666666666\t0.8333333333333334\n01_20109072177_F3...\t24\t8\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F3...\t8\t6\t0.75\t0.25\n01_20505018509_F9...\t14\t11\t0.7857142857142857\t0.2142857142857143\n01_20428080671_F4...\t5\t3\t0.6\t0.4\n01_20121563160_F0...\t2\t1\t0.5\t0.5\n01_20109072177_F2...\t53\t0\t0.0\t1.0\n01_20232860767_F0...\t13\t5\t0.38461538461538464\t0.6153846153846154\n01_20109072177_F3...\t3\t1\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F2...\t120\t28\t0.23333333333333334\t0.7666666666666666\n01_20601486874_F0...\t10\t4\t0.4\t0.6\n01_20109072177_F2...\t4\t0\t0.0\t1.0\n01_20109072177_F6...\t92\t35\t0.3804347826086957\t0.6195652173913043\n01_20109072177_F6...\t12\t6\t0.5\t0.5\n01_20109072177_F2...\t14\t3\t0.21428571428571427\t0.7857142857142857\n01_20109072177_F2...\t58\t25\t0.43103448275862066\t0.5689655172413793\n01_20109072177_F6...\t38\t7\t0.18421052631578946\t0.8157894736842105\n01_20109072177_F6...\t32\t11\t0.34375\t0.65625\n01_20500732891_F0...\t37\t8\t0.21621621621621623\t0.7837837837837838\n01_20109072177_F2...\t16\t0\t0.0\t1.0\n01_20428080671_F4...\t5\t3\t0.6\t0.4\n01_20109072177_F6...\t8\t0\t0.0\t1.0\n01_20109072177_F6...\t46\t14\t0.30434782608695654\t0.6956521739130435\n01_20100121809_F6...\t12\t1\t0.08333333333333333\t0.9166666666666666\n01_20109072177_F2...\t5\t3\t0.6\t0.4\n01_20493387597_F0...\t9\t3\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F2...\t119\t32\t0.2689075630252101\t0.73109243697479\n01_20100054184_F0...\t5\t4\t0.8\t0.19999999999999996\n01_20109072177_F2...\t32\t10\t0.3125\t0.6875\n01_20553136521_E0...\t8\t2\t0.25\t0.75\n01_20544180941_FF...\t10\t6\t0.6\t0.4\n01_20109072177_F3...\t32\t0\t0.0\t1.0\n01_20109072177_F3...\t40\t9\t0.225\t0.775\n01_20109072177_F2...\t30\t10\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F6...\t24\t0\t0.0\t1.0\n01_20294213156_F0...\t6\t4\t0.6666666666666666\t0.33333333333333337\n01_20524404321_F0...\t11\t2\t0.18181818181818182\t0.8181818181818181\n01_20109072177_F6...\t94\t30\t0.3191489361702128\t0.6808510638297872\n01_20109072177_F6...\t16\t5\t0.3125\t0.6875\n01_10478085155_E0...\t6\t1\t0.16666666666666666\t0.8333333333333334\n01_20109072177_F2...\t39\t7\t0.1794871794871795\t0.8205128205128205\n01_20109072177_F3...\t18\t0\t0.0\t1.0\n01_20109072177_F2...\t34\t0\t0.0\t1.0\n01_20109072177_F2...\t3\t3\t1.0\t0.0\n01_20109072177_F2...\t7\t3\t0.42857142857142855\t0.5714285714285714\n01_20109072177_F6...\t27\t0\t0.0\t1.0\n01_20109072177_F6...\t35\t14\t0.4\t0.6\n01_20109072177_F3...\t36\t13\t0.3611111111111111\t0.6388888888888888\n01_20299369782_F4...\t8\t5\t0.625\t0.375\n01_20109072177_F2...\t2\t2\t1.0\t0.0\n01_20109072177_F2...\t9\t0\t0.0\t1.0\n01_20109072177_F3...\t32\t8\t0.25\t0.75\n01_20109072177_F2...\t16\t3\t0.1875\t0.8125\n01_20553264520_F0...\t24\t6\t0.25\t0.75\n01_20600432363_F3...\t12\t5\t0.4166666666666667\t0.5833333333333333\n01_20109072177_F3...\t53\t13\t0.24528301886792453\t0.7547169811320755\n01_20109072177_F3...\t4\t0\t0.0\t1.0\n01_20100207941_F1...\t6\t5\t0.8333333333333334\t0.16666666666666663\n01_20109072177_F6...\t9\t5\t0.5555555555555556\t0.4444444444444444\n01_20109072177_F2...\t5\t1\t0.2\t0.8\n01_20109072177_F2...\t11\t5\t0.45454545454545453\t0.5454545454545454\n01_20109072177_F3...\t11\t4\t0.36363636363636365\t0.6363636363636364\n01_20109072177_F3...\t56\t17\t0.30357142857142855\t0.6964285714285714\n01_20517738701_F2...\t4\t1\t0.25\t0.75\n01_20109072177_F3...\t13\t1\t0.07692307692307693\t0.9230769230769231\n01_20109072177_F2...\t10\t0\t0.0\t1.0\n01_20109072177_F2...\t11\t0\t0.0\t1.0\n01_20109072177_F3...\t8\t2\t0.25\t0.75\n01_20419861236_FE...\t4\t1\t0.25\t0.75\n01_20109072177_F3...\t6\t3\t0.5\t0.5\n01_20109072177_F0...\t4\t0\t0.0\t1.0\n01_20492092313_FT...\t8\t4\t0.5\t0.5\n01_20109072177_F2...\t13\t6\t0.46153846153846156\t0.5384615384615384\n01_20431062870_F1...\t4\t1\t0.25\t0.75\n01_20109072177_F2...\t41\t19\t0.4634146341463415\t0.5365853658536586\n01_20109072177_F2...\t40\t14\t0.35\t0.65\n01_20109072177_F2...\t6\t1\t0.16666666666666666\t0.8333333333333334\n01_20492092313_FT...\t21\t4\t0.19047619047619047\t0.8095238095238095\n01_20517737560_F4...\t21\t15\t0.7142857142857143\t0.2857142857142857\n01_20109072177_F0...\t5\t0\t0.0\t1.0\n01_20109072177_F2...\t18\t4\t0.2222222222222222\t0.7777777777777778\n01_20600593685_F0...\t8\t1\t0.125\t0.875\n01_20109072177_F3...\t5\t1\t0.2\t0.8\n01_20492092313_FT...\t15\t0\t0.0\t1.0\n01_20492092313_FT...\t84\t51\t0.6071428571428571\t0.3928571428571429\n01_20548605793_E0...\t3\t0\t0.0\t1.0\n01_20109072177_F2...\t31\t0\t0.0\t1.0\n01_10249945051_F0...\t10\t4\t0.4\t0.6\n01_20109072177_F2...\t1\t0\t0.0\t1.0\n01_20109072177_F2...\t39\t14\t0.358974358974359\t0.641025641025641\n01_20100123330_FK...\t4\t0\t0.0\t1.0\n01_20109072177_F3...\t5\t0\t0.0\t1.0\n01_20109072177_F6...\t2\t1\t0.5\t0.5\n01_20550851530_F0...\t1\t0\t0.0\t1.0\n01_20109072177_F3...\t13\t4\t0.3076923076923077\t0.6923076923076923\n01_20109072177_F6...\t31\t13\t0.41935483870967744\t0.5806451612903225\n01_20568932880_F0...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F2...\t4\t0\t0.0\t1.0\n01_20452430950_F1...\t34\t5\t0.14705882352941177\t0.8529411764705882\n01_20502802683_F0...\t12\t3\t0.25\t0.75\n01_20109072177_F6...\t6\t0\t0.0\t1.0\n01_20109072177_FH...\t56\t13\t0.23214285714285715\t0.7678571428571428\n01_20517738701_F2...\t8\t2\t0.25\t0.75\n01_20107695584_F1...\t3\t3\t1.0\t0.0\n01_20492092313_FT...\t76\t34\t0.4473684210526316\t0.5526315789473684\n01_20601494052_E0...\t12\t1\t0.08333333333333333\t0.9166666666666666\n01_20109072177_F3...\t7\t2\t0.2857142857142857\t0.7142857142857143\n01_20109072177_F3...\t3\t0\t0.0\t1.0\n01_20109072177_F3...\t12\t4\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F2...\t21\t1\t0.047619047619047616\t0.9523809523809523\n01_20109072177_F3...\t2\t1\t0.5\t0.5\n01_20109072177_F6...\t27\t8\t0.2962962962962963\t0.7037037037037037\n01_20109072177_F2...\t8\t4\t0.5\t0.5\n01_20100054184_F0...\t4\t3\t0.75\t0.25\n01_20109072177_F3...\t12\t2\t0.16666666666666666\t0.8333333333333334\n01_20562703706_E0...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F0...\t2\t1\t0.5\t0.5\n01_20109072177_F6...\t28\t13\t0.4642857142857143\t0.5357142857142857\n01_20109072177_F3...\t1\t0\t0.0\t1.0\n01_20109072177_F6...\t40\t0\t0.0\t1.0\n01_20109072177_F2...\t7\t1\t0.14285714285714285\t0.8571428571428572\n01_20109072177_F2...\t7\t5\t0.7142857142857143\t0.2857142857142857\n01_20109072177_F3...\t25\t8\t0.32\t0.6799999999999999\n01_20109072177_F6...\t43\t13\t0.3023255813953488\t0.6976744186046512\n01_20600213203_FF...\t3\t0\t0.0\t1.0\n01_20100349061_F0...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F2...\t24\t0\t0.0\t1.0\n01_20109072177_F6...\t7\t0\t0.0\t1.0\n01_20109072177_F2...\t23\t10\t0.43478260869565216\t0.5652173913043479\n01_20109072177_F2...\t3\t0\t0.0\t1.0\n01_20109072177_F6...\t31\t9\t0.2903225806451613\t0.7096774193548387\n01_20109072177_F6...\t4\t0\t0.0\t1.0\n01_20109072177_F3...\t2\t1\t0.5\t0.5\n01_20109072177_F6...\t18\t0\t0.0\t1.0\n01_20552702523_F0...\t24\t6\t0.25\t0.75\n01_10266169669_F0...\t13\t1\t0.07692307692307693\t0.9230769230769231\n01_20109072177_F6...\t3\t0\t0.0\t1.0\n01_20100176964_F1...\t2\t2\t1.0\t0.0\n01_20492092313_FT...\t30\t10\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F2...\t15\t0\t0.0\t1.0\n01_20109072177_F6...\t48\t19\t0.3958333333333333\t0.6041666666666667\n01_20517738701_F2...\t30\t25\t0.8333333333333334\t0.16666666666666663\n01_15522568527_F0...\t9\t7\t0.7777777777777778\t0.2222222222222222\n01_20109072177_F2...\t34\t5\t0.14705882352941177\t0.8529411764705882\n01_20109072177_F6...\t14\t0\t0.0\t1.0\n01_20568932880_F0...\t26\t6\t0.23076923076923078\t0.7692307692307692\n01_20109072177_F3...\t6\t3\t0.5\t0.5\n01_20109072177_F3...\t4\t0\t0.0\t1.0\n01_20109072177_F2...\t11\t5\t0.45454545454545453\t0.5454545454545454\n01_20109072177_F3...\t6\t1\t0.16666666666666666\t0.8333333333333334\n01_20517738701_F2...\t6\t0\t0.0\t1.0\n01_20109072177_F6...\t7\t2\t0.2857142857142857\t0.7142857142857143\n01_20100207941_F1...\t9\t7\t0.7777777777777778\t0.2222222222222222\n01_20109072177_F0...\t6\t0\t0.0\t1.0\n01_20109072177_F6...\t12\t0\t0.0\t1.0\n01_20109072177_F7...\t2\t0\t0.0\t1.0\n01_20115635388_F1...\t15\t0\t0.0\t1.0\n01_20138470530_F0...\t8\t2\t0.25\t0.75\n01_20543722309_FC...\t8\t0\t0.0\t1.0\n01_20544547756_F0...\t4\t1\t0.25\t0.75\n01_20109072177_F2...\t8\t0\t0.0\t1.0\n01_20109072177_F2...\t7\t2\t0.2857142857142857\t0.7142857142857143\n01_20512794417_F0...\t8\t2\t0.25\t0.75\n01_20101904874_F0...\t6\t1\t0.16666666666666666\t0.8333333333333334\n01_20109072177_F2...\t5\t1\t0.2\t0.8\n01_20512451056_F0...\t10\t4\t0.4\t0.6\n01_20109072177_F2...\t19\t5\t0.2631578947368421\t0.736842105263158\n01_20109072177_F3...\t11\t0\t0.0\t1.0\n01_20109072177_F6...\t13\t7\t0.5384615384615384\t0.46153846153846156\n01_20109072177_F3...\t2\t0\t0.0\t1.0\n01_20109072177_F6...\t26\t0\t0.0\t1.0\n01_20109072177_F6...\t3\t0\t0.0\t1.0\n01_20492092313_FT...\t19\t4\t0.21052631578947367\t0.7894736842105263\n01_20424044203_F2...\t3\t0\t0.0\t1.0\n01_20109072177_F6...\t24\t9\t0.375\t0.625\n01_20126294353_F0...\t15\t4\t0.26666666666666666\t0.7333333333333334\n01_20109072177_F6...\t8\t3\t0.375\t0.625\n01_20109072177_F2...\t32\t11\t0.34375\t0.65625\n01_20109072177_F0...\t2\t0\t0.0\t1.0\n01_20109072177_F6...\t6\t0\t0.0\t1.0\n01_20109072177_F2...\t7\t3\t0.42857142857142855\t0.5714285714285714\n01_20551924131_F0...\t7\t3\t0.42857142857142855\t0.5714285714285714\n01_20505125844_F0...\t13\t8\t0.6153846153846154\t0.3846153846153846\n01_20109072177_F6...\t7\t3\t0.42857142857142855\t0.5714285714285714\n01_20109072177_F2...\t34\t0\t0.0\t1.0\n01_20507264108_F0...\t3\t3\t1.0\t0.0\n01_20109072177_F2...\t23\t11\t0.4782608695652174\t0.5217391304347826\n01_20109072177_F2...\t9\t4\t0.4444444444444444\t0.5555555555555556\n01_20109072177_F2...\t30\t8\t0.26666666666666666\t0.7333333333333334\n01_20109072177_F2...\t12\t4\t0.3333333333333333\t0.6666666666666667\n01_20507775889_F0...\t4\t3\t0.75\t0.25\n01_20507775889_F0...\t3\t3\t1.0\t0.0\n01_20109072177_F6...\t24\t8\t0.3333333333333333\t0.6666666666666667\n01_10009666261_F0...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20112378864_F0...\t10\t2\t0.2\t0.8\n01_20493172396_FF...\t4\t3\t0.75\t0.25\n01_20109072177_F2...\t30\t0\t0.0\t1.0\n01_20109072177_F6...\t21\t8\t0.38095238095238093\t0.6190476190476191\n01_20109072177_F6...\t7\t3\t0.42857142857142855\t0.5714285714285714\n01_20109072177_FS...\t7\t5\t0.7142857142857143\t0.2857142857142857\n01_20600311744_F0...\t9\t5\t0.5555555555555556\t0.4444444444444444\n01_20546806783_F0...\t5\t0\t0.0\t1.0\n01_20109072177_F6...\t7\t0\t0.0\t1.0\n01_20424044203_F1...\t14\t0\t0.0\t1.0\n01_20109072177_F3...\t3\t0\t0.0\t1.0\n01_20109072177_F2...\t5\t0\t0.0\t1.0\n01_20109072177_F2...\t103\t39\t0.3786407766990291\t0.6213592233009708\n01_20109072177_F6...\t26\t6\t0.23076923076923078\t0.7692307692307692\n01_20505897812_F0...\t7\t0\t0.0\t1.0\n01_20109072177_F2...\t5\t0\t0.0\t1.0\n01_20109072177_F0...\t3\t0\t0.0\t1.0\n01_20109072177_F3...\t7\t3\t0.42857142857142855\t0.5714285714285714\n01_20109072177_F6...\t18\t0\t0.0\t1.0\n01_20109072177_F6...\t7\t3\t0.42857142857142855\t0.5714285714285714\n01_20109072177_FA...\t7\t2\t0.2857142857142857\t0.7142857142857143\n01_20109072177_F3...\t14\t7\t0.5\t0.5\n01_20109072177_F3...\t87\t32\t0.367816091954023\t0.632183908045977\n01_20419861236_FS...\t5\t4\t0.8\t0.19999999999999996\n01_20109072177_F2...\t15\t5\t0.3333333333333333\t0.6666666666666667\n01_20107695584_F1...\t5\t2\t0.4\t0.6\n01_20507264108_F0...\t3\t3\t1.0\t0.0\n01_20109072177_F3...\t12\t2\t0.16666666666666666\t0.8333333333333334\n01_20297426428_F0...\t9\t2\t0.2222222222222222\t0.7777777777777778\n01_20109072177_F2...\t49\t17\t0.3469387755102041\t0.653061224489796\n01_20109072177_F6...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20107463705_F3...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F7...\t12\t3\t0.25\t0.75\n01_20101452281_F0...\t5\t2\t0.4\t0.6\n01_20109072177_F3...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F2...\t3\t0\t0.0\t1.0\n01_20109072177_F6...\t40\t14\t0.35\t0.65\n01_20109072177_F6...\t28\t5\t0.17857142857142858\t0.8214285714285714\n01_20517738701_F2...\t7\t5\t0.7142857142857143\t0.2857142857142857\n01_20517738701_F2...\t5\t2\t0.4\t0.6\n01_20109072177_F2...\t18\t5\t0.2777777777777778\t0.7222222222222222\n01_20544206410_F4...\t7\t2\t0.2857142857142857\t0.7142857142857143\n01_20117357113_FT...\t3\t3\t1.0\t0.0\n01_20429683581_FA...\t8\t0\t0.0\t1.0\n01_20109072177_F6...\t3\t1\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F6...\t15\t0\t0.0\t1.0\n01_20492092313_FT...\t8\t4\t0.5\t0.5\n01_20109072177_F3...\t12\t3\t0.25\t0.75\n01_20136096592_F0...\t7\t6\t0.8571428571428571\t0.1428571428571429\n01_20109072177_FA...\t6\t1\t0.16666666666666666\t0.8333333333333334\n01_20600337751_F0...\t6\t0\t0.0\t1.0\n01_20109072177_F6...\t3\t0\t0.0\t1.0\n01_20109072177_FA...\t5\t4\t0.8\t0.19999999999999996\n01_20541144278_F0...\t5\t3\t0.6\t0.4\n01_20109072177_F3...\t24\t0\t0.0\t1.0\n01_20543301206_F0...\t2\t1\t0.5\t0.5\n01_20109072177_F6...\t5\t2\t0.4\t0.6\n01_20517738701_F2...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F2...\t9\t9\t1.0\t0.0\n01_20510885229_F1...\t9\t4\t0.4444444444444444\t0.5555555555555556\n01_20109072177_F3...\t12\t0\t0.0\t1.0\n01_20109072177_F6...\t17\t3\t0.17647058823529413\t0.8235294117647058\n01_20109072177_F3...\t38\t6\t0.15789473684210525\t0.8421052631578947\n01_20109072177_F6...\t2\t0\t0.0\t1.0\n01_20369796314_F0...\t4\t4\t1.0\t0.0\n01_20552342489_FE...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F6...\t20\t0\t0.0\t1.0\n01_20505897812_F0...\t4\t1\t0.25\t0.75\n01_20603358857_F0...\t8\t2\t0.25\t0.75\n01_20109072177_F2...\t44\t14\t0.3181818181818182\t0.6818181818181819\n01_20603053321_E0...\t3\t0\t0.0\t1.0\n01_20107695584_F1...\t7\t3\t0.42857142857142855\t0.5714285714285714\n01_20109072177_F3...\t8\t4\t0.5\t0.5\n01_20109072177_F2...\t10\t5\t0.5\t0.5\n01_15451419002_F0...\t6\t4\t0.6666666666666666\t0.33333333333333337\n01_20109072177_F6...\t2\t1\t0.5\t0.5\n01_20109072177_F2...\t26\t5\t0.19230769230769232\t0.8076923076923077\n01_20493387597_F0...\t9\t5\t0.5555555555555556\t0.4444444444444444\n01_20507775889_F0...\t4\t3\t0.75\t0.25\n01_20601989701_F0...\t3\t0\t0.0\t1.0\n01_20100251176_F1...\t4\t3\t0.75\t0.25\n01_20109072177_F6...\t35\t10\t0.2857142857142857\t0.7142857142857143\n01_20109072177_F2...\t24\t6\t0.25\t0.75\n01_20109072177_F2...\t7\t0\t0.0\t1.0\n01_20109072177_F6...\t16\t6\t0.375\t0.625\n01_20109072177_F6...\t26\t9\t0.34615384615384615\t0.6538461538461539\n01_20492092313_FT...\t72\t19\t0.2638888888888889\t0.7361111111111112\n01_20109072177_F2...\t2\t0\t0.0\t1.0\n01_20109072177_F6...\t13\t1\t0.07692307692307693\t0.9230769230769231\n01_20507775889_F0...\t8\t2\t0.25\t0.75\n01_20109072177_F2...\t14\t6\t0.42857142857142855\t0.5714285714285714\n01_20492092313_FT...\t8\t3\t0.375\t0.625\n01_20525904424_F0...\t5\t1\t0.2\t0.8\n01_20603139926_E0...\t12\t0\t0.0\t1.0\n01_20600380614_F0...\t10\t4\t0.4\t0.6\n01_20100207941_F1...\t6\t5\t0.8333333333333334\t0.16666666666666663\n01_20507264108_F0...\t3\t3\t1.0\t0.0\n01_20109072177_F3...\t21\t0\t0.0\t1.0\n01_20600901401_F0...\t2\t2\t1.0\t0.0\n01_20109072177_F2...\t10\t5\t0.5\t0.5\n01_20100128056_F5...\t5\t2\t0.4\t0.6\n01_20109072177_F2...\t6\t0\t0.0\t1.0\n01_20551944833_FF...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_10238336045_F0...\t2\t1\t0.5\t0.5\n01_20109072177_F2...\t23\t0\t0.0\t1.0\n01_20109072177_F6...\t12\t6\t0.5\t0.5\n01_20109072177_F2...\t3\t0\t0.0\t1.0\n01_20101951872_F7...\t8\t2\t0.25\t0.75\n01_20109072177_F6...\t25\t5\t0.2\t0.8\n01_20109072177_F3...\t9\t4\t0.4444444444444444\t0.5555555555555556\n01_20523880749_F0...\t10\t0\t0.0\t1.0\n01_20109072177_F6...\t11\t5\t0.45454545454545453\t0.5454545454545454\n01_20549406531_F0...\t6\t4\t0.6666666666666666\t0.33333333333333337\n01_20109072177_F3...\t13\t4\t0.3076923076923077\t0.6923076923076923\n01_20107463705_F3...\t17\t3\t0.17647058823529413\t0.8235294117647058\n01_20109072177_F6...\t2\t0\t0.0\t1.0\n01_20109072177_F6...\t2\t1\t0.5\t0.5\n01_20109072177_F2...\t10\t0\t0.0\t1.0\n01_20109072177_F6...\t12\t5\t0.4166666666666667\t0.5833333333333333\n01_20109072177_F2...\t12\t0\t0.0\t1.0\n01_20109072177_F2...\t11\t4\t0.36363636363636365\t0.6363636363636364\n01_20109072177_F3...\t5\t2\t0.4\t0.6\n01_20109072177_F6...\t4\t0\t0.0\t1.0\n01_20109072177_F3...\t9\t2\t0.2222222222222222\t0.7777777777777778\n01_20109072177_F3...\t8\t4\t0.5\t0.5\n01_20109072177_F2...\t3\t0\t0.0\t1.0\n01_20109072177_F6...\t1\t0\t0.0\t1.0\n01_20109072177_F3...\t2\t0\t0.0\t1.0\n01_20109072177_F6...\t16\t0\t0.0\t1.0\n01_20109072177_F2...\t16\t6\t0.375\t0.625\n01_20109072177_F3...\t5\t0\t0.0\t1.0\n01_20109072177_F2...\t23\t8\t0.34782608695652173\t0.6521739130434783\n01_20517738701_F2...\t7\t4\t0.5714285714285714\t0.4285714285714286\n01_20109072177_F6...\t7\t0\t0.0\t1.0\n01_20101165389_F1...\t9\t7\t0.7777777777777778\t0.2222222222222222\n01_20109072177_F3...\t36\t4\t0.1111111111111111\t0.8888888888888888\n01_20600892470_F3...\t7\t0\t0.0\t1.0\n01_20109072177_F7...\t9\t1\t0.1111111111111111\t0.8888888888888888\n01_20227553236_F0...\t5\t0\t0.0\t1.0\n01_20483432951_F1...\t5\t4\t0.8\t0.19999999999999996\n01_20217265917_E0...\t6\t1\t0.16666666666666666\t0.8333333333333334\n01_20428080671_F3...\t4\t0\t0.0\t1.0\n01_20550025176_F0...\t1\t1\t1.0\t0.0\n01_20507264108_F0...\t3\t3\t1.0\t0.0\n01_20109072177_F6...\t11\t3\t0.2727272727272727\t0.7272727272727273\n01_20109072177_F2...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F6...\t3\t2\t0.6666666666666666\t0.33333333333333337\n01_20526231202_F0...\t4\t2\t0.5\t0.5\n01_20109072177_F2...\t21\t3\t0.14285714285714285\t0.8571428571428572\n01_20109072177_F6...\t14\t0\t0.0\t1.0\n01_20109072177_F2...\t3\t1\t0.3333333333333333\t0.6666666666666667\n01_20100178401_F1...\t4\t3\t0.75\t0.25\n01_20109072177_F2...\t41\t0\t0.0\t1.0\n01_20109072177_F2...\t24\t6\t0.25\t0.75\n01_20109072177_F2...\t17\t4\t0.23529411764705882\t0.7647058823529411\n01_20109072177_F3...\t5\t4\t0.8\t0.19999999999999996\n01_20507775889_F0...\t3\t2\t0.6666666666666666\t0.33333333333333337\n01_20517738701_F0...\t4\t2\t0.5\t0.5\n01_20109072177_F2...\t3\t2\t0.6666666666666666\t0.33333333333333337\n01_20109072177_F6...\t12\t4\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F3...\t18\t0\t0.0\t1.0\n01_20452430950_F1...\t16\t6\t0.375\t0.625\n01_20109072177_F6...\t5\t2\t0.4\t0.6\n01_20109072177_F6...\t32\t11\t0.34375\t0.65625\n01_20100178401_F1...\t8\t8\t1.0\t0.0\n01_20115635388_F1...\t3\t1\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F3...\t8\t1\t0.125\t0.875\n01_20109072177_F3...\t13\t5\t0.38461538461538464\t0.6153846153846154\n01_20109072177_F6...\t7\t1\t0.14285714285714285\t0.8571428571428572\n01_20109072177_F2...\t31\t10\t0.3225806451612903\t0.6774193548387097\n01_20549253360_F0...\t15\t2\t0.13333333333333333\t0.8666666666666667\n01_20109072177_F2...\t12\t0\t0.0\t1.0\n01_20517738701_F0...\t2\t0\t0.0\t1.0\n01_20512164073_F0...\t4\t3\t0.75\t0.25\n01_20109072177_F3...\t6\t0\t0.0\t1.0\n01_20109072177_F6...\t22\t6\t0.2727272727272727\t0.7272727272727273\n01_20109072177_F6...\t6\t1\t0.16666666666666666\t0.8333333333333334\n01_20109072177_F6...\t17\t0\t0.0\t1.0\n01_20109072177_F2...\t24\t10\t0.4166666666666667\t0.5833333333333333\n01_20109072177_F6...\t12\t0\t0.0\t1.0\n01_20492092313_FT...\t21\t14\t0.6666666666666666\t0.33333333333333337\n01_20602963315_F0...\t5\t2\t0.4\t0.6\n01_20517738701_F2...\t5\t2\t0.4\t0.6\n01_20109072177_F6...\t25\t5\t0.2\t0.8\n01_20507264108_F0...\t3\t3\t1.0\t0.0\n01_20544547756_F0...\t4\t1\t0.25\t0.75\n01_20109072177_FA...\t6\t1\t0.16666666666666666\t0.8333333333333334\n01_20369796314_F0...\t3\t3\t1.0\t0.0\n01_20109072177_F3...\t10\t1\t0.1\t0.9\n01_20109072177_F6...\t19\t6\t0.3157894736842105\t0.6842105263157895\n01_20109072177_FA...\t6\t0\t0.0\t1.0\n01_20109072177_F6...\t17\t9\t0.5294117647058824\t0.47058823529411764\n01_20602763685_E0...\t7\t3\t0.42857142857142855\t0.5714285714285714\n01_20109072177_F2...\t2\t0\t0.0\t1.0\n01_20109072177_F2...\t33\t9\t0.2727272727272727\t0.7272727272727273\n01_20109072177_F6...\t5\t3\t0.6\t0.4\n01_20109072177_F2...\t14\t0\t0.0\t1.0\n01_20109072177_F2...\t22\t0\t0.0\t1.0\n01_20109072177_F3...\t11\t0\t0.0\t1.0\n01_20535757659_F0...\t3\t1\t0.3333333333333333\t0.6666666666666667\n01_20429683581_FO...\t2\t1\t0.5\t0.5\n01_20109072177_F2...\t12\t3\t0.25\t0.75\n01_20107695584_F1...\t4\t4\t1.0\t0.0\n01_20109072177_F2...\t1\t0\t0.0\t1.0\n01_20109072177_F6...\t33\t9\t0.2727272727272727\t0.7272727272727273\n01_20109072177_F6...\t2\t0\t0.0\t1.0\n01_20100122368_F0...\t4\t3\t0.75\t0.25\n01_20107695584_F1...\t3\t3\t1.0\t0.0\n01_20109072177_F2...\t8\t3\t0.375\t0.625\n01_20109072177_F2...\t5\t1\t0.2\t0.8\n01_20117357113_FT...\t5\t4\t0.8\t0.19999999999999996\n01_20100128056_FX...\t4\t0\t0.0\t1.0\n01_20109072177_F6...\t3\t1\t0.3333333333333333\t0.6666666666666667\n01_20138998780_F9...\t9\t0\t0.0\t1.0\n01_20109072177_F6...\t2\t0\t0.0\t1.0\n01_20529162678_F0...\t2\t0\t0.0\t1.0\n01_20544357621_F0...\t26\t6\t0.23076923076923078\t0.7692307692307692\n01_20505238703_F0...\t6\t1\t0.16666666666666666\t0.8333333333333334\n01_20109072177_F6...\t8\t3\t0.375\t0.625\n01_20109072177_F2...\t34\t11\t0.3235294117647059\t0.6764705882352942\n01_20515634682_F0...\t7\t3\t0.42857142857142855\t0.5714285714285714\n01_20517738701_F2...\t9\t4\t0.4444444444444444\t0.5555555555555556\n01_20109072177_F2...\t7\t2\t0.2857142857142857\t0.7142857142857143\n01_20109072177_F3...\t17\t7\t0.4117647058823529\t0.5882352941176471\n01_20570793471_F0...\t2\t2\t1.0\t0.0\n01_20101087647_F0...\t5\t1\t0.2\t0.8\n01_20109072177_F2...\t25\t7\t0.28\t0.72\n01_20507775889_F0...\t17\t12\t0.7058823529411765\t0.2941176470588235\n01_20600849833_F0...\t2\t1\t0.5\t0.5\n01_20517738701_F2...\t7\t3\t0.42857142857142855\t0.5714285714285714\n01_20505238703_F0...\t6\t4\t0.6666666666666666\t0.33333333333333337\n01_20107463705_F3...\t9\t6\t0.6666666666666666\t0.33333333333333337\n01_20109072177_F6...\t10\t6\t0.6\t0.4\n01_20100128056_F1...\t5\t1\t0.2\t0.8\n01_20109072177_F2...\t28\t12\t0.42857142857142855\t0.5714285714285714\n01_20603099878_F0...\t7\t2\t0.2857142857142857\t0.7142857142857143\n01_20109072177_F3...\t27\t13\t0.48148148148148145\t0.5185185185185186\n01_20507264108_F0...\t3\t3\t1.0\t0.0\n01_20109072177_F2...\t22\t0\t0.0\t1.0\n01_20553849242_F0...\t8\t5\t0.625\t0.375\n01_20175508610_F0...\t6\t5\t0.8333333333333334\t0.16666666666666663\n01_20601824265_F0...\t5\t1\t0.2\t0.8\n01_20388829452_FS...\t2\t1\t0.5\t0.5\n01_20109072177_F6...\t2\t1\t0.5\t0.5\n01_20109072177_F6...\t7\t4\t0.5714285714285714\t0.4285714285714286\n01_20109072177_FA...\t3\t3\t1.0\t0.0\n01_20109072177_F2...\t2\t0\t0.0\t1.0\n01_20109072177_F6...\t2\t0\t0.0\t1.0\n01_20515696441_F0...\t10\t3\t0.3\t0.7\n01_20175508610_F0...\t5\t5\t1.0\t0.0\n01_20109072177_F2...\t5\t0\t0.0\t1.0\n01_20517738701_F2...\t4\t2\t0.5\t0.5\n01_20100123330_FK...\t13\t3\t0.23076923076923078\t0.7692307692307692\n01_20109072177_F6...\t2\t1\t0.5\t0.5\n01_20554902953_E0...\t6\t0\t0.0\t1.0\n01_20489627427_F0...\t4\t2\t0.5\t0.5\n01_20109072177_F6...\t8\t2\t0.25\t0.75\n01_20109072177_F2...\t7\t1\t0.14285714285714285\t0.8571428571428572\n01_20109072177_F2...\t56\t15\t0.26785714285714285\t0.7321428571428572\n01_20109072177_F6...\t7\t3\t0.42857142857142855\t0.5714285714285714\n01_20107463705_F3...\t6\t4\t0.6666666666666666\t0.33333333333333337\n01_20109072177_F6...\t19\t5\t0.2631578947368421\t0.736842105263158\n01_20109072177_F6...\t5\t0\t0.0\t1.0\n01_20178974620_F0...\t7\t5\t0.7142857142857143\t0.2857142857142857\n01_20109072177_F6...\t15\t2\t0.13333333333333333\t0.8666666666666667\n01_20549624953_E0...\t5\t0\t0.0\t1.0\n01_20432168213_F7...\t8\t2\t0.25\t0.75\n01_20109072177_F6...\t33\t0\t0.0\t1.0\n01_20109072177_FA...\t8\t3\t0.375\t0.625\n01_20109072177_F3...\t14\t3\t0.21428571428571427\t0.7857142857142857\n01_20109072177_F2...\t21\t8\t0.38095238095238093\t0.6190476190476191\n01_20109072177_FA...\t3\t1\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F2...\t27\t8\t0.2962962962962963\t0.7037037037037037\n01_20109072177_FA...\t8\t1\t0.125\t0.875\n01_20126294353_F0...\t4\t3\t0.75\t0.25\n01_20109072177_F6...\t10\t4\t0.4\t0.6\n01_20507264108_F0...\t3\t3\t1.0\t0.0\n01_20109072177_F2...\t5\t1\t0.2\t0.8\n01_20109072177_F2...\t9\t5\t0.5555555555555556\t0.4444444444444444\n01_20101951872_F7...\t9\t1\t0.1111111111111111\t0.8888888888888888\n01_20101098681_F0...\t4\t4\t1.0\t0.0\n01_20109072177_FA...\t4\t2\t0.5\t0.5\n01_20517738701_F0...\t4\t0\t0.0\t1.0\n01_20507775889_F0...\t4\t3\t0.75\t0.25\n01_20337889167_F0...\t1\t1\t1.0\t0.0\n01_20494756324_F0...\t12\t3\t0.25\t0.75\n01_20109072177_F2...\t2\t0\t0.0\t1.0\n01_20109072177_F6...\t3\t0\t0.0\t1.0\n01_20544547756_F0...\t4\t1\t0.25\t0.75\n01_20429683581_FA...\t4\t1\t0.25\t0.75\n01_20109072177_F2...\t5\t0\t0.0\t1.0\n01_20109072177_F6...\t6\t1\t0.16666666666666666\t0.8333333333333334\n01_20254281531_E0...\t6\t3\t0.5\t0.5\n01_20517738701_F2...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20507775889_F0...\t3\t1\t0.3333333333333333\t0.6666666666666667\n01_20556626902_F0...\t8\t3\t0.375\t0.625\n01_20109072177_F2...\t2\t1\t0.5\t0.5\n01_20109072177_F6...\t3\t2\t0.6666666666666666\t0.33333333333333337\n01_20517737560_F4...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F6...\t2\t1\t0.5\t0.5\n01_20109072177_F0...\t7\t1\t0.14285714285714285\t0.8571428571428572\n01_20109072177_F3...\t7\t1\t0.14285714285714285\t0.8571428571428572\n01_20508167459_F0...\t7\t4\t0.5714285714285714\t0.4285714285714286\n01_20517738701_F2...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20517737560_F4...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F2...\t19\t6\t0.3157894736842105\t0.6842105263157895\n01_20109072177_F2...\t10\t3\t0.3\t0.7\n01_20109072177_F2...\t10\t0\t0.0\t1.0\n01_20480956401_E0...\t5\t1\t0.2\t0.8\n01_20452379661_E0...\t6\t5\t0.8333333333333334\t0.16666666666666663\n01_20109072177_F2...\t27\t11\t0.4074074074074074\t0.5925925925925926\n01_20117357113_FT...\t3\t3\t1.0\t0.0\n01_20109072177_F2...\t15\t3\t0.2\t0.8\n01_20109072177_F2...\t2\t2\t1.0\t0.0\n01_20512164073_F0...\t4\t3\t0.75\t0.25\n01_20109072177_F6...\t8\t0\t0.0\t1.0\n01_20109072177_F2...\t17\t0\t0.0\t1.0\n01_20510885229_F1...\t6\t4\t0.6666666666666666\t0.33333333333333337\n01_20109072177_F2...\t16\t0\t0.0\t1.0\n01_20136096592_F0...\t3\t3\t1.0\t0.0\n01_20107463705_F0...\t4\t4\t1.0\t0.0\n01_20109072177_F2...\t7\t1\t0.14285714285714285\t0.8571428571428572\n01_20153045021_FB...\t7\t1\t0.14285714285714285\t0.8571428571428572\n01_20109072177_F3...\t17\t8\t0.47058823529411764\t0.5294117647058824\n01_20109072177_F6...\t5\t2\t0.4\t0.6\n01_20109072177_F3...\t2\t0\t0.0\t1.0\n01_20109072177_F6...\t10\t0\t0.0\t1.0\n01_20109072177_F2...\t11\t2\t0.18181818181818182\t0.8181818181818181\n01_20109072177_F3...\t3\t0\t0.0\t1.0\n01_20109072177_F3...\t6\t0\t0.0\t1.0\n01_20517738701_F2...\t9\t3\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F2...\t26\t12\t0.46153846153846156\t0.5384615384615384\n01_20109072177_F6...\t10\t2\t0.2\t0.8\n01_20107463705_F3...\t3\t3\t1.0\t0.0\n01_20109072177_F6...\t8\t0\t0.0\t1.0\n01_10249945051_F0...\t8\t2\t0.25\t0.75\n01_20109072177_F6...\t14\t6\t0.42857142857142855\t0.5714285714285714\n01_20109072177_F6...\t5\t2\t0.4\t0.6\n01_20109072177_F3...\t11\t6\t0.5454545454545454\t0.4545454545454546\n01_20256697549_F0...\t6\t3\t0.5\t0.5\n01_20100162742_F5...\t3\t3\t1.0\t0.0\n01_20480708688_E0...\t2\t0\t0.0\t1.0\n01_20109072177_F6...\t4\t2\t0.5\t0.5\n01_20109072177_F3...\t9\t3\t0.3333333333333333\t0.6666666666666667\n01_20100251176_F1...\t15\t5\t0.3333333333333333\t0.6666666666666667\n01_20558710439_F0...\t11\t3\t0.2727272727272727\t0.7272727272727273\n01_20109072177_F3...\t14\t6\t0.42857142857142855\t0.5714285714285714\n01_20109072177_F2...\t3\t1\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F2...\t8\t2\t0.25\t0.75\n01_20107695584_F1...\t4\t4\t1.0\t0.0\n01_20109072177_F3...\t27\t0\t0.0\t1.0\n01_20109072177_F6...\t5\t0\t0.0\t1.0\n01_20117357113_FT...\t3\t3\t1.0\t0.0\n01_20109072177_F6...\t2\t0\t0.0\t1.0\n01_20109072177_F6...\t5\t2\t0.4\t0.6\n01_20109072177_F2...\t2\t1\t0.5\t0.5\n01_20536165771_F1...\t14\t6\t0.42857142857142855\t0.5714285714285714\n01_20109072177_F3...\t25\t11\t0.44\t0.56\n01_20507264108_F0...\t3\t3\t1.0\t0.0\n01_20109072177_F0...\t4\t1\t0.25\t0.75\n01_20109072177_F3...\t4\t4\t1.0\t0.0\n01_20109072177_F6...\t11\t2\t0.18181818181818182\t0.8181818181818181\n01_20507294198_F0...\t3\t3\t1.0\t0.0\n01_20109072177_F6...\t2\t0\t0.0\t1.0\n01_20101920721_F1...\t5\t2\t0.4\t0.6\n01_20109072177_F3...\t10\t3\t0.3\t0.7\n01_20126294353_F0...\t20\t13\t0.65\t0.35\n01_20109072177_F3...\t2\t0\t0.0\t1.0\n01_20107695584_F1...\t2\t2\t1.0\t0.0\n01_20109072177_F0...\t1\t0\t0.0\t1.0\n01_20517738701_F2...\t8\t0\t0.0\t1.0\n01_20109072177_F3...\t2\t0\t0.0\t1.0\n01_20517738701_F2...\t4\t2\t0.5\t0.5\n01_20131914416_F0...\t6\t6\t1.0\t0.0\n01_20109072177_F2...\t10\t0\t0.0\t1.0\n01_20109072177_F3...\t5\t0\t0.0\t1.0\n01_20450287475_F0...\t9\t3\t0.3333333333333333\t0.6666666666666667\n01_20326331962_F1...\t13\t2\t0.15384615384615385\t0.8461538461538461\n01_20501781291_F1...\t3\t3\t1.0\t0.0\n01_20109072177_F2...\t13\t4\t0.3076923076923077\t0.6923076923076923\n01_20601704464_F0...\t8\t3\t0.375\t0.625\n01_20100121809_F2...\t4\t4\t1.0\t0.0\n01_20109072177_FA...\t4\t2\t0.5\t0.5\n01_20109072177_F3...\t9\t4\t0.4444444444444444\t0.5555555555555556\n01_20553136521_E0...\t9\t2\t0.2222222222222222\t0.7777777777777778\n01_20517738701_F2...\t8\t2\t0.25\t0.75\n01_20337564373_FT...\t5\t2\t0.4\t0.6\n01_20109072177_F6...\t5\t2\t0.4\t0.6\n01_20109072177_F2...\t10\t0\t0.0\t1.0\n01_10088138622_F0...\t12\t4\t0.3333333333333333\t0.6666666666666667\n01_20476633932_F3...\t7\t1\t0.14285714285714285\t0.8571428571428572\n01_20517738701_F2...\t5\t0\t0.0\t1.0\n01_20481281815_F0...\t6\t3\t0.5\t0.5\n01_20100123330_FK...\t4\t2\t0.5\t0.5\n01_20109072177_F6...\t3\t1\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F2...\t3\t0\t0.0\t1.0\n01_20509913260_F0...\t3\t1\t0.3333333333333333\t0.6666666666666667\n01_20345841416_E0...\t2\t2\t1.0\t0.0\n01_20109072177_F2...\t1\t0\t0.0\t1.0\n01_20539056094_E0...\t8\t3\t0.375\t0.625\n01_20109072177_F0...\t5\t1\t0.2\t0.8\n01_20109072177_F3...\t21\t9\t0.42857142857142855\t0.5714285714285714\n01_20109072177_F3...\t6\t0\t0.0\t1.0\n01_20227729709_F0...\t2\t2\t1.0\t0.0\n01_20109072177_F2...\t42\t9\t0.21428571428571427\t0.7857142857142857\n01_20337889167_F0...\t4\t3\t0.75\t0.25\n01_10249945051_F0...\t4\t0\t0.0\t1.0\n01_20109072177_F2...\t19\t0\t0.0\t1.0\n01_20109072177_F3...\t12\t6\t0.5\t0.5\n01_20109072177_F6...\t53\t21\t0.39622641509433965\t0.6037735849056604\n01_20492092313_F1...\t4\t1\t0.25\t0.75\n01_20109072177_F2...\t15\t3\t0.2\t0.8\n01_20521988011_F0...\t12\t4\t0.3333333333333333\t0.6666666666666667\n01_20526452551_F0...\t6\t0\t0.0\t1.0\n01_20109072177_FA...\t5\t0\t0.0\t1.0\n01_20530184081_E0...\t19\t7\t0.3684210526315789\t0.631578947368421\n01_20550361109_F0...\t10\t3\t0.3\t0.7\n01_20514506630_F0...\t9\t4\t0.4444444444444444\t0.5555555555555556\n01_20109072177_F6...\t2\t1\t0.5\t0.5\n01_20100323002_F0...\t10\t4\t0.4\t0.6\n01_20109072177_F3...\t4\t0\t0.0\t1.0\n01_20454135432_F1...\t4\t4\t1.0\t0.0\n01_20109072177_F6...\t3\t1\t0.3333333333333333\t0.6666666666666667\n01_20517738701_F2...\t5\t2\t0.4\t0.6\n01_20109072177_F2...\t3\t0\t0.0\t1.0\n01_20109072177_F2...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F6...\t4\t0\t0.0\t1.0\n01_20109072177_F3...\t7\t0\t0.0\t1.0\n01_20109072177_F2...\t10\t1\t0.1\t0.9\n01_20517738701_F2...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F2...\t20\t0\t0.0\t1.0\n01_20107695584_F1...\t3\t2\t0.6666666666666666\t0.33333333333333337\n01_20109072177_F2...\t2\t0\t0.0\t1.0\n01_20109072177_F3...\t15\t6\t0.4\t0.6\n01_20600686691_F6...\t3\t2\t0.6666666666666666\t0.33333333333333337\n01_20109072177_FA...\t7\t1\t0.14285714285714285\t0.8571428571428572\n01_20510628501_F0...\t5\t0\t0.0\t1.0\n01_20518792360_FM...\t15\t2\t0.13333333333333333\t0.8666666666666667\n01_20429683581_FA...\t10\t1\t0.1\t0.9\n01_20483432951_F1...\t4\t1\t0.25\t0.75\n01_10411044781_E0...\t9\t1\t0.1111111111111111\t0.8888888888888888\n01_20100317967_F0...\t18\t0\t0.0\t1.0\n01_20109072177_F2...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20162580672_FA...\t5\t2\t0.4\t0.6\n01_20109072177_F2...\t10\t0\t0.0\t1.0\n01_20109072177_F6...\t9\t1\t0.1111111111111111\t0.8888888888888888\n01_20109072177_F6...\t8\t0\t0.0\t1.0\n01_20109072177_F3...\t13\t2\t0.15384615384615385\t0.8461538461538461\n01_20266603607_E0...\t4\t2\t0.5\t0.5\n01_20455437904_F0...\t3\t1\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F3...\t4\t2\t0.5\t0.5\n01_20109072177_F6...\t5\t1\t0.2\t0.8\n01_20505018509_F9...\t15\t13\t0.8666666666666667\t0.1333333333333333\n01_20137911982_F0...\t7\t1\t0.14285714285714285\t0.8571428571428572\n01_20109072177_F0...\t2\t0\t0.0\t1.0\n01_20109072177_F2...\t11\t1\t0.09090909090909091\t0.9090909090909091\n01_20109072177_F2...\t35\t10\t0.2857142857142857\t0.7142857142857143\n01_20109072177_F2...\t8\t0\t0.0\t1.0\n01_10222991213_E0...\t8\t3\t0.375\t0.625\n01_20109072177_F0...\t3\t0\t0.0\t1.0\n01_20100315751_F0...\t13\t0\t0.0\t1.0\n01_20109072177_F2...\t11\t0\t0.0\t1.0\n01_20109072177_F6...\t8\t3\t0.375\t0.625\n01_20347100316_F0...\t3\t0\t0.0\t1.0\n01_20109072177_F2...\t4\t0\t0.0\t1.0\n01_20109072177_F3...\t11\t3\t0.2727272727272727\t0.7272727272727273\n01_20109072177_F6...\t14\t5\t0.35714285714285715\t0.6428571428571428\n01_20303368877_F1...\t3\t2\t0.6666666666666666\t0.33333333333333337\n01_20109072177_F3...\t4\t0\t0.0\t1.0\n01_20109072177_F6...\t5\t4\t0.8\t0.19999999999999996\n01_20545547296_FE...\t3\t1\t0.3333333333333333\t0.6666666666666667\n01_20517738701_F2...\t8\t3\t0.375\t0.625\n01_20603343604_F0...\t6\t1\t0.16666666666666666\t0.8333333333333334\n01_20107463705_F3...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20522049761_F0...\t6\t1\t0.16666666666666666\t0.8333333333333334\n01_20109072177_F2...\t3\t0\t0.0\t1.0\n01_20109072177_FA...\t8\t4\t0.5\t0.5\n01_20109072177_F0...\t2\t0\t0.0\t1.0\n01_20109072177_F6...\t2\t0\t0.0\t1.0\n01_20109072177_F6...\t10\t0\t0.0\t1.0\n01_20109072177_F2...\t5\t0\t0.0\t1.0\n01_20109072177_F2...\t11\t6\t0.5454545454545454\t0.4545454545454546\n01_20490304101_F0...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F2...\t2\t0\t0.0\t1.0\n01_20109072177_F6...\t22\t7\t0.3181818181818182\t0.6818181818181819\n01_20109072177_F6...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20100317967_F0...\t14\t4\t0.2857142857142857\t0.7142857142857143\n01_20109072177_F6...\t11\t1\t0.09090909090909091\t0.9090909090909091\n01_20109072177_F3...\t3\t1\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F2...\t11\t1\t0.09090909090909091\t0.9090909090909091\n01_20529640162_E0...\t13\t2\t0.15384615384615385\t0.8461538461538461\n01_20101920721_F1...\t6\t1\t0.16666666666666666\t0.8333333333333334\n01_20517738701_F2...\t8\t0\t0.0\t1.0\n01_20109072177_F3...\t3\t1\t0.3333333333333333\t0.6666666666666667\n01_20175508610_F0...\t7\t7\t1.0\t0.0\n01_20109072177_FA...\t3\t3\t1.0\t0.0\n01_20109072177_F3...\t5\t3\t0.6\t0.4\n01_20109072177_F3...\t5\t1\t0.2\t0.8\n01_20109072177_F0...\t2\t0\t0.0\t1.0\n01_20492883957_F0...\t5\t2\t0.4\t0.6\n01_20100121809_F2...\t4\t4\t1.0\t0.0\n01_20600701747_F0...\t6\t2\t0.3333333333333333\t0.6666666666666667\n01_20109072177_F2...\t26\t10\t0.38461538461538464\t0.6153846153846154"},{"type":"HTML","data":"<div class=\"result-alert alert-warning\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button><strong>Output is truncated</strong> to 1000 rows. Learn more about <strong>zeppelin.livy.spark.sql.maxResult</strong></div>"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970544_-795746769","id":"20190313-151820_1828507869","dateCreated":"2019-03-13T15:39:30-0400","dateStarted":"2019-03-13T15:58:11-0400","dateFinished":"2019-03-13T15:58:12-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:77612"},{"text":"%livy2.sql\ncreate table ds02_gastos_no_deducibles.201902_regimen as\nselect distinct vfp_numruc,R_GENERAL,R_MYPE,R_ESPECIAL,R_RUS,R_TOTAL,\n    case when R_GENERAL = 1 then 'REGIMEN GENERAL'\n         when R_MYPE = 1 then 'REGIMEN MYPE TRIBUTARIO'\n         when R_ESPECIAL = 1 then 'REGIMEN ESPECIAL'\n         when R_RUS = 1 then 'REGIMEN RUS'\n         else 'R_OTROS'\n    end as REGIMEN\nfrom \n    (select a.vfp_numruc,R_GENERAL,R_MYPE,R_ESPECIAL,R_RUS,nvl(R_GENERAL,0)+nvl(R_MYPE,0)+nvl(R_ESPECIAL,0)+nvl(R_RUS,0) as R_TOTAL\n    from (select distinct vfp_numruc from db_tributario.vfp_20190213) a \n    left join (select vfp_numruc, 1 as R_GENERAL from db_tributario.vfp_20190213 where vfp_codtri in ('030301','033101','035101','034101') group by 1) b on a.vfp_numruc = b.vfp_numruc\n    left join (select vfp_numruc, 1 as R_MYPE from db_tributario.vfp_20190213 where vfp_codtri='031201') c on a.vfp_numruc = c.vfp_numruc\n    left join (select vfp_numruc, 1 as R_ESPECIAL from db_tributario.vfp_20190213 where vfp_codtri='031101') d on a.vfp_numruc = d.vfp_numruc\n    left join (select vfp_numruc, 1 as R_RUS from db_tributario.vfp_20190213 where substr(vfp_codtri,1,2) in ('04')) g on a.vfp_numruc = g.vfp_numruc\n    )\norder by 6 desc","dateUpdated":"2019-03-13T15:39:30-0400","config":{"tableHide":true,"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"apps":[],"jobName":"paragraph_1552505970545_-796131518","id":"20190304-120707_2081937195","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77613"},{"text":"%livy2.sql\nselect count(*),count(distinct vfp_numruc) from ds02_gastos_no_deducibles.201902_regimen","dateUpdated":"2019-03-13T15:39:30-0400","config":{"tableHide":false,"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"table","height":84,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(1)\tcount(DISTINCT vfp_numruc)\n12455237\t12455237"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970546_-794977272","id":"20190306-111442_888466210","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77614"},{"text":"%livy2.sql\ncreate table ds02_gastos_no_deducibles.201811_salida_v2 as\nselect a.*,nitems,descripcion,descripcion_limpio,n,suma,propcom,propdif,regimen\nfrom ds02_gastos_no_deducibles.201811_md_factura a\nleft join (select llave_cpe,count(*) as nitems,concat_ws(' ** ',collect_list(trim(des_detitm))) as descripcion  from ds02_gastos_no_deducibles.201811_md_detalle group by llave_cpe) b on a.llave_cpe = b.llave_cpe\nleft join (select llave_cpe,concat_ws(' ** ',collect_list(trim(descripcion))) as descripcion_limpio from ds02_gastos_no_deducibles.201811_palabras_llave_r_tabla group by llave_cpe) e on a.llave_cpe = e.llave_cpe\nleft join ds02_gastos_no_deducibles.201811_llaves_r_v2 c on a.llave_cpe = c.llave_cpe\nleft join ds02_gastos_no_deducibles.201902_regimen d on trim(a.rec_ruc) = trim(d.vfp_numruc)\nwhere regimen not in ('REGIMEN RUS','REGIMEN ESPECIAL') and rec_dependencia not in ('0011')","user":"jrodriguez","dateUpdated":"2019-03-13T16:00:31-0400","config":{"tableHide":true,"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970548_-797285765","id":"20190304-113214_524184676","dateCreated":"2019-03-13T15:39:30-0400","dateStarted":"2019-03-13T16:00:31-0400","dateFinished":"2019-03-13T16:01:48-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:77615"},{"text":"%livy2.sql\nselect count(a.llave_cpe),count(*),count(distinct rec_ruc),count(distinct emi_ruc) from ds02_gastos_no_deducibles.201811_salida a","user":"jrodriguez","dateUpdated":"2019-03-13T16:01:54-0400","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(llave_cpe)\tcount(1)\tcount(DISTINCT rec_ruc)\tcount(DISTINCT emi_ruc)\n255750\t255750\t63064\t4755"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970549_-797670514","id":"20190313-152717_922329321","dateCreated":"2019-03-13T15:39:30-0400","dateStarted":"2019-03-13T16:01:54-0400","dateFinished":"2019-03-13T16:01:58-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:77616"},{"text":"%livy2.sql\nselect count(a.llave_cpe),count(*),count(distinct rec_ruc),count(distinct emi_ruc) \nfrom ds02_gastos_no_deducibles.201811_md_factura a\nleft join (select llave_cpe,count(*) as nitems,concat_ws(' ** ',collect_list(trim(des_detitm))) as descripcion  from ds02_gastos_no_deducibles.201811_md_detalle group by llave_cpe) b on a.llave_cpe = b.llave_cpe\nleft join (select llave_cpe,concat_ws(' ** ',collect_list(trim(descripcion))) as descripcion_limpio from ds02_gastos_no_deducibles.201811_palabras_llave_r_tabla group by llave_cpe) e on a.llave_cpe = e.llave_cpe\nleft join ds02_gastos_no_deducibles.201811_llaves_r c on a.llave_cpe = c.llave_cpe\nleft join ds02_gastos_no_deducibles.201902_regimen d on trim(a.rec_ruc) = trim(d.vfp_numruc)","dateUpdated":"2019-03-13T15:39:30-0400","config":{"colWidth":6,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"table","height":94,"optionOpen":false}}},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(llave_cpe)\tcount(1)\tcount(DISTINCT rec_ruc)\tcount(DISTINCT emi_ruc)\n408150\t408150\t80459\t5208"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970551_-796901016","id":"20190313-152123_1966161005","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77617"},{"text":"%livy2.sql\nselect count(a.llave_cpe),count(*),count(distinct rec_ruc),count(distinct emi_ruc) \nfrom ds02_gastos_no_deducibles.201811_md_factura a\nleft join (select llave_cpe,count(*) as nitems,concat_ws(' ** ',collect_list(trim(des_detitm))) as descripcion  from ds02_gastos_no_deducibles.201811_md_detalle group by llave_cpe) b on a.llave_cpe = b.llave_cpe\nleft join (select llave_cpe,concat_ws(' ** ',collect_list(trim(descripcion))) as descripcion_limpio from ds02_gastos_no_deducibles.201811_palabras_llave_r_tabla group by llave_cpe) e on a.llave_cpe = e.llave_cpe\nleft join ds02_gastos_no_deducibles.201811_llaves_r c on a.llave_cpe = c.llave_cpe\nleft join ds02_gastos_no_deducibles.201902_regimen d on trim(a.rec_ruc) = trim(d.vfp_numruc)\nwhere regimen not in ('REGIMEN RUS','REGIMEN ESPECIAL')","dateUpdated":"2019-03-13T15:39:30-0400","config":{"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":6,"editorMode":"ace/mode/sql","editorHide":false,"results":{"0":{"graph":{"mode":"table","height":94,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(llave_cpe)\tcount(1)\tcount(DISTINCT rec_ruc)\tcount(DISTINCT emi_ruc)\n357723\t357723\t64341\t5113"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970552_-798824761","id":"20190313-152803_686792493","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77618"},{"text":"%livy2.sql\nselect count(a.llave_cpe),count(*),count(distinct rec_ruc),count(distinct emi_ruc) \nfrom ds02_gastos_no_deducibles.201811_md_factura a\nleft join (select llave_cpe,count(*) as nitems,concat_ws(' ** ',collect_list(trim(des_detitm))) as descripcion  from ds02_gastos_no_deducibles.201811_md_detalle group by llave_cpe) b on a.llave_cpe = b.llave_cpe\nleft join (select llave_cpe,concat_ws(' ** ',collect_list(trim(descripcion))) as descripcion_limpio from ds02_gastos_no_deducibles.201811_palabras_llave_r_tabla group by llave_cpe) e on a.llave_cpe = e.llave_cpe\nleft join ds02_gastos_no_deducibles.201811_llaves_r c on a.llave_cpe = c.llave_cpe\nleft join ds02_gastos_no_deducibles.201902_regimen d on trim(a.rec_ruc) = trim(d.vfp_numruc)\nwhere rec_dependencia not in ('0011')","dateUpdated":"2019-03-13T15:39:30-0400","config":{"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":6,"editorMode":"ace/mode/sql","editorHide":false,"results":{"0":{"graph":{"mode":"table","height":94,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(llave_cpe)\tcount(1)\tcount(DISTINCT rec_ruc)\tcount(DISTINCT emi_ruc)\n306177\t306177\t79182\t4858"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970554_-798055263","id":"20190313-152921_235294117","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77619"},{"text":"%livy2.sql\ncreate table ds02_gastos_no_deducibles.201811_vtspdt_cpe as\nselect rec_ruc,mto_impcpe_gnd,mto_vtas_dec,case when mto_vtas_dec = 0 then 1 else mto_impcpe_gnd/mto_vtas_dec end as rat1\nfrom (select rec_ruc, sum(mto_impcpe) as mto_impcpe_gnd from ds02_gastos_no_deducibles.201811_salida group by rec_ruc) a\ninner join ds02_gastos_no_deducibles.vts_dec_men_pdt_20180810 b on a.rec_ruc = b.n_doc_declado","dateUpdated":"2019-03-13T15:39:30-0400","config":{"tableHide":true,"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970555_-798440012","id":"20190305-174209_1948301418","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77620"},{"text":"%livy2.sql\ndrop table ds02_gastos_no_deducibles.201902_salidafinal","dateUpdated":"2019-03-13T15:39:30-0400","config":{"tableHide":true,"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"apps":[],"jobName":"paragraph_1552505970556_-800363756","id":"20190306-180025_1491697362","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77621"},{"text":"%livy2.sql\ncreate table ds02_gastos_no_deducibles.201811_salidafinal as\nselect a.*, b.mto_impcpe_gnd,b.mto_vtas_dec,b.rat1\nfrom ds02_gastos_no_deducibles.201811_salida a\nleft join ds02_gastos_no_deducibles.201811_vtspdt_cpe b on a.rec_ruc = b.rec_ruc\nwhere mto_impcpe_soles > 5 and mto_impcpe_soles < 200000\n    and propdif >0.3 and rat1>=0.1\n    and regexp_replace(descripcion_limpio,'valor minimo mensual|desarrollo comerc|intercambio tarj|porcentual men|gasto comun fijo|prediales|inversion publicitaria|vales compra|variable mensual|renta fija mensual|adelanto resultado consorcio|venta inmueble|rancho|contrato suscrito|redencion puntos|despacho centralizado|alimentacion personal|comision recaudacion|alimentacion comedor|acuerdo auspicio|alquiler local|publicidad promociones|ambulancia urbana|cesion tda|promociones diversas|renta minima|alquil|desarrollo comerc|intercambio tarj|porcentual men|gasto comun fijo|prediales|inversion publicitaria|vales compra|variable mensual|renta fija mensual','*eliminar*') not like '%*eliminar*%'\n    and( (rec_act_principal not in ('EXT. DE MIN. METALIFEROS NO FERROSOS.','CONSTRUCCION EDIFICIOS COMPLETOS.') and descripcion_limpio not like ('%alimentac%'))\n        or (rec_act_secun1 not in ('EXT. DE MIN. METALIFEROS NO FERROSOS.','CONSTRUCCION EDIFICIOS COMPLETOS.') and descripcion_limpio not like ('%alimentac%'))\n        or (rec_act_secun2 not in ('EXT. DE MIN. METALIFEROS NO FERROSOS.','CONSTRUCCION EDIFICIOS COMPLETOS.') and descripcion_limpio not like ('%alimentac%')) )\n    ","dateUpdated":"2019-03-13T15:39:30-0400","config":{"tableHide":true,"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970558_-799594258","id":"20190305-154558_1324820835","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77622"},{"text":"%livy2.sql\ndrop table ds02_gastos_no_deducibles.201902_salidafinalfinal","dateUpdated":"2019-03-13T15:39:30-0400","config":{"tableHide":true,"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"apps":[],"jobName":"paragraph_1552505970559_-799979007","id":"20190306-180157_569405185","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77623"},{"text":"%livy2.sql\ncreate table ds02_gastos_no_deducibles.201811_salidafinalfinal as\nselect count(*)\nfrom ds02_gastos_no_deducibles.201811_salidafinal\nwhere concat(trim(rec_act_principal),trim(emi_act_principal)) not in (\"PLANES DE SEGUROS DE VIDAACTIVIDADES DE HOSPITALES\",\"PLANES DE SEGUROS DE VIDAOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"PLANES DE SEGUROS DE VIDAACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"PLANES DE SEGUROS GENERALESACTIVIDADES DE HOSPITALES\",\"PLANES DE SEGUROS GENERALESOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"PLANES DE SEGUROS GENERALESACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.ACTIVIDADES DE HOSPITALES\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.OTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.ACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAACTIVIDADES DE HOSPITALES\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"ACTIVIDADES DE HOSPITALESACTIVIDADES DE HOSPITALES\",\"ACTIVIDADES DE HOSPITALESOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIVIDADES DE HOSPITALESACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"RESTAURANTES, BARES Y CANTINAS.VTA. MIN. OTROS PRODUCTOS EN ALMACEN.\",\"RESTAURANTES, BARES Y CANTINAS.VTA. MIN. EN ALMACENES NO ESPECIALIZ\",\"RESTAURANTES, BARES Y CANTINAS.OTROS TIPOS DE VENTA AL POR MENOR.\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOACTIVIDADES DE HOSPITALES\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.RESTAURANTES, BARES Y CANTINAS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.HOTELES, CAMPAMENTOS Y OTROS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.OTRAS ACTIVID.ENTRETENIMIENTO NCP.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.ACTIV.TEATRALES, MUSICALES Y OTRAS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.OTRAS ACTIVIDADES DE ESPARCIMIENTO\",\"ACABADO DE PROD. TEXTILES.FAB. DE PRENDAS DE VESTIR.\",\"ACABADO DE PROD. TEXTILES.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"ACABADO DE PROD. TEXTILES.FAB. DE ARTICULOS DE PIEL.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MAY. DE OTROS PRODUCTOS.\",\"HOTELES, CAMPAMENTOS Y OTROS.RESTAURANTES, BARES Y CANTINAS.\",\"HOTELES, CAMPAMENTOS Y OTROS.AGENCIAS DE VIAJES Y GUIAS TURISTIC.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MAY. PRODUCTOS TEXTILES.\",\"HOTELES, CAMPAMENTOS Y OTROS.ACTIV.TEATRALES, MUSICALES Y OTRAS.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MIN. EN ALMACENES NO ESPECIALIZ.\",\"VTA. MAY. PRODUCTOS TEXTILES.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MAY. PRODUCTOS TEXTILES.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. OTROS PROD. TEXTILES NEOP.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"FAB. OTROS PROD. TEXTILES NEOP.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. OTROS PROD. TEXTILES NEOP.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.VTA. MAY. PRODUCTOS TEXTILES.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.FAB. DE CALZADO.\",\"VTA. MIN. ALIMENTOS, BEBIDAS, TABACOVTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. EN ALMACENES NO ESPECIALIZ.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. OTROS PRODUCTOS EN ALMACEN.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. EN PUESTOS DE VENTA.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MAY. ALIMENTOS, BEBIDAS Y TABACO.VTA. MAY. DE OTROS PRODUCTOS.\",\"FAB. DE PRENDAS DE VESTIR.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"FAB. DE PRENDAS DE VESTIR.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. DE PRENDAS DE VESTIR.FAB. TEJIDOS Y ART DE PUNTO.\")\n\nand concat(trim(rec_act_principal),trim(emi_act_secun1)) not in (\"PLANES DE SEGUROS DE VIDAACTIVIDADES DE HOSPITALES\",\"PLANES DE SEGUROS DE VIDAOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"PLANES DE SEGUROS DE VIDAACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"PLANES DE SEGUROS GENERALESACTIVIDADES DE HOSPITALES\",\"PLANES DE SEGUROS GENERALESOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"PLANES DE SEGUROS GENERALESACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.ACTIVIDADES DE HOSPITALES\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.OTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.ACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAACTIVIDADES DE HOSPITALES\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"ACTIVIDADES DE HOSPITALESACTIVIDADES DE HOSPITALES\",\"ACTIVIDADES DE HOSPITALESOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIVIDADES DE HOSPITALESACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"RESTAURANTES, BARES Y CANTINAS.VTA. MIN. OTROS PRODUCTOS EN ALMACEN.\",\"RESTAURANTES, BARES Y CANTINAS.VTA. MIN. EN ALMACENES NO ESPECIALIZ\",\"RESTAURANTES, BARES Y CANTINAS.OTROS TIPOS DE VENTA AL POR MENOR.\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOACTIVIDADES DE HOSPITALES\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.RESTAURANTES, BARES Y CANTINAS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.HOTELES, CAMPAMENTOS Y OTROS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.OTRAS ACTIVID.ENTRETENIMIENTO NCP.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.ACTIV.TEATRALES, MUSICALES Y OTRAS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.OTRAS ACTIVIDADES DE ESPARCIMIENTO\",\"ACABADO DE PROD. TEXTILES.FAB. DE PRENDAS DE VESTIR.\",\"ACABADO DE PROD. TEXTILES.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"ACABADO DE PROD. TEXTILES.FAB. DE ARTICULOS DE PIEL.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MAY. DE OTROS PRODUCTOS.\",\"HOTELES, CAMPAMENTOS Y OTROS.RESTAURANTES, BARES Y CANTINAS.\",\"HOTELES, CAMPAMENTOS Y OTROS.AGENCIAS DE VIAJES Y GUIAS TURISTIC.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MAY. PRODUCTOS TEXTILES.\",\"HOTELES, CAMPAMENTOS Y OTROS.ACTIV.TEATRALES, MUSICALES Y OTRAS.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MIN. EN ALMACENES NO ESPECIALIZ.\",\"VTA. MAY. PRODUCTOS TEXTILES.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MAY. PRODUCTOS TEXTILES.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. OTROS PROD. TEXTILES NEOP.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"FAB. OTROS PROD. TEXTILES NEOP.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. OTROS PROD. TEXTILES NEOP.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.VTA. MAY. PRODUCTOS TEXTILES.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.FAB. DE CALZADO.\",\"VTA. MIN. ALIMENTOS, BEBIDAS, TABACOVTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. EN ALMACENES NO ESPECIALIZ.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. OTROS PRODUCTOS EN ALMACEN.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. EN PUESTOS DE VENTA.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MAY. ALIMENTOS, BEBIDAS Y TABACO.VTA. MAY. DE OTROS PRODUCTOS.\",\"FAB. DE PRENDAS DE VESTIR.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"FAB. DE PRENDAS DE VESTIR.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. DE PRENDAS DE VESTIR.FAB. TEJIDOS Y ART DE PUNTO.\")\n\nand  concat(trim(rec_act_principal),trim(emi_act_secun2)) not in (\"PLANES DE SEGUROS DE VIDAACTIVIDADES DE HOSPITALES\",\"PLANES DE SEGUROS DE VIDAOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"PLANES DE SEGUROS DE VIDAACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"PLANES DE SEGUROS GENERALESACTIVIDADES DE HOSPITALES\",\"PLANES DE SEGUROS GENERALESOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"PLANES DE SEGUROS GENERALESACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.ACTIVIDADES DE HOSPITALES\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.OTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.ACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAACTIVIDADES DE HOSPITALES\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"ACTIVIDADES DE HOSPITALESACTIVIDADES DE HOSPITALES\",\"ACTIVIDADES DE HOSPITALESOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIVIDADES DE HOSPITALESACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"RESTAURANTES, BARES Y CANTINAS.VTA. MIN. OTROS PRODUCTOS EN ALMACEN.\",\"RESTAURANTES, BARES Y CANTINAS.VTA. MIN. EN ALMACENES NO ESPECIALIZ\",\"RESTAURANTES, BARES Y CANTINAS.OTROS TIPOS DE VENTA AL POR MENOR.\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOACTIVIDADES DE HOSPITALES\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.RESTAURANTES, BARES Y CANTINAS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.HOTELES, CAMPAMENTOS Y OTROS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.OTRAS ACTIVID.ENTRETENIMIENTO NCP.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.ACTIV.TEATRALES, MUSICALES Y OTRAS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.OTRAS ACTIVIDADES DE ESPARCIMIENTO\",\"ACABADO DE PROD. TEXTILES.FAB. DE PRENDAS DE VESTIR.\",\"ACABADO DE PROD. TEXTILES.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"ACABADO DE PROD. TEXTILES.FAB. DE ARTICULOS DE PIEL.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MAY. DE OTROS PRODUCTOS.\",\"HOTELES, CAMPAMENTOS Y OTROS.RESTAURANTES, BARES Y CANTINAS.\",\"HOTELES, CAMPAMENTOS Y OTROS.AGENCIAS DE VIAJES Y GUIAS TURISTIC.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MAY. PRODUCTOS TEXTILES.\",\"HOTELES, CAMPAMENTOS Y OTROS.ACTIV.TEATRALES, MUSICALES Y OTRAS.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MIN. EN ALMACENES NO ESPECIALIZ.\",\"VTA. MAY. PRODUCTOS TEXTILES.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MAY. PRODUCTOS TEXTILES.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. OTROS PROD. TEXTILES NEOP.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"FAB. OTROS PROD. TEXTILES NEOP.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. OTROS PROD. TEXTILES NEOP.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.VTA. MAY. PRODUCTOS TEXTILES.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.FAB. DE CALZADO.\",\"VTA. MIN. ALIMENTOS, BEBIDAS, TABACOVTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. EN ALMACENES NO ESPECIALIZ.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. OTROS PRODUCTOS EN ALMACEN.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. EN PUESTOS DE VENTA.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MAY. ALIMENTOS, BEBIDAS Y TABACO.VTA. MAY. DE OTROS PRODUCTOS.\",\"FAB. DE PRENDAS DE VESTIR.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"FAB. DE PRENDAS DE VESTIR.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. DE PRENDAS DE VESTIR.FAB. TEJIDOS Y ART DE PUNTO.\")\n\nand concat(trim(rec_act_secun1),trim(emi_act_principal)) not in (\"PLANES DE SEGUROS DE VIDAACTIVIDADES DE HOSPITALES\",\"PLANES DE SEGUROS DE VIDAOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"PLANES DE SEGUROS DE VIDAACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"PLANES DE SEGUROS GENERALESACTIVIDADES DE HOSPITALES\",\"PLANES DE SEGUROS GENERALESOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"PLANES DE SEGUROS GENERALESACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.ACTIVIDADES DE HOSPITALES\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.OTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.ACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAACTIVIDADES DE HOSPITALES\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"ACTIVIDADES DE HOSPITALESACTIVIDADES DE HOSPITALES\",\"ACTIVIDADES DE HOSPITALESOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIVIDADES DE HOSPITALESACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"RESTAURANTES, BARES Y CANTINAS.VTA. MIN. OTROS PRODUCTOS EN ALMACEN.\",\"RESTAURANTES, BARES Y CANTINAS.VTA. MIN. EN ALMACENES NO ESPECIALIZ\",\"RESTAURANTES, BARES Y CANTINAS.OTROS TIPOS DE VENTA AL POR MENOR.\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOACTIVIDADES DE HOSPITALES\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.RESTAURANTES, BARES Y CANTINAS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.HOTELES, CAMPAMENTOS Y OTROS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.OTRAS ACTIVID.ENTRETENIMIENTO NCP.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.ACTIV.TEATRALES, MUSICALES Y OTRAS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.OTRAS ACTIVIDADES DE ESPARCIMIENTO\",\"ACABADO DE PROD. TEXTILES.FAB. DE PRENDAS DE VESTIR.\",\"ACABADO DE PROD. TEXTILES.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"ACABADO DE PROD. TEXTILES.FAB. DE ARTICULOS DE PIEL.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MAY. DE OTROS PRODUCTOS.\",\"HOTELES, CAMPAMENTOS Y OTROS.RESTAURANTES, BARES Y CANTINAS.\",\"HOTELES, CAMPAMENTOS Y OTROS.AGENCIAS DE VIAJES Y GUIAS TURISTIC.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MAY. PRODUCTOS TEXTILES.\",\"HOTELES, CAMPAMENTOS Y OTROS.ACTIV.TEATRALES, MUSICALES Y OTRAS.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MIN. EN ALMACENES NO ESPECIALIZ.\",\"VTA. MAY. PRODUCTOS TEXTILES.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MAY. PRODUCTOS TEXTILES.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. OTROS PROD. TEXTILES NEOP.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"FAB. OTROS PROD. TEXTILES NEOP.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. OTROS PROD. TEXTILES NEOP.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.VTA. MAY. PRODUCTOS TEXTILES.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.FAB. DE CALZADO.\",\"VTA. MIN. ALIMENTOS, BEBIDAS, TABACOVTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. EN ALMACENES NO ESPECIALIZ.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. OTROS PRODUCTOS EN ALMACEN.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. EN PUESTOS DE VENTA.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MAY. ALIMENTOS, BEBIDAS Y TABACO.VTA. MAY. DE OTROS PRODUCTOS.\",\"FAB. DE PRENDAS DE VESTIR.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"FAB. DE PRENDAS DE VESTIR.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. DE PRENDAS DE VESTIR.FAB. TEJIDOS Y ART DE PUNTO.\")\n\nand concat(trim(rec_act_secun1),trim(emi_act_secun1)) not in (\"PLANES DE SEGUROS DE VIDAACTIVIDADES DE HOSPITALES\",\"PLANES DE SEGUROS DE VIDAOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"PLANES DE SEGUROS DE VIDAACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"PLANES DE SEGUROS GENERALESACTIVIDADES DE HOSPITALES\",\"PLANES DE SEGUROS GENERALESOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"PLANES DE SEGUROS GENERALESACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.ACTIVIDADES DE HOSPITALES\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.OTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.ACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAACTIVIDADES DE HOSPITALES\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"ACTIVIDADES DE HOSPITALESACTIVIDADES DE HOSPITALES\",\"ACTIVIDADES DE HOSPITALESOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIVIDADES DE HOSPITALESACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"RESTAURANTES, BARES Y CANTINAS.VTA. MIN. OTROS PRODUCTOS EN ALMACEN.\",\"RESTAURANTES, BARES Y CANTINAS.VTA. MIN. EN ALMACENES NO ESPECIALIZ\",\"RESTAURANTES, BARES Y CANTINAS.OTROS TIPOS DE VENTA AL POR MENOR.\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOACTIVIDADES DE HOSPITALES\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.RESTAURANTES, BARES Y CANTINAS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.HOTELES, CAMPAMENTOS Y OTROS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.OTRAS ACTIVID.ENTRETENIMIENTO NCP.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.ACTIV.TEATRALES, MUSICALES Y OTRAS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.OTRAS ACTIVIDADES DE ESPARCIMIENTO\",\"ACABADO DE PROD. TEXTILES.FAB. DE PRENDAS DE VESTIR.\",\"ACABADO DE PROD. TEXTILES.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"ACABADO DE PROD. TEXTILES.FAB. DE ARTICULOS DE PIEL.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MAY. DE OTROS PRODUCTOS.\",\"HOTELES, CAMPAMENTOS Y OTROS.RESTAURANTES, BARES Y CANTINAS.\",\"HOTELES, CAMPAMENTOS Y OTROS.AGENCIAS DE VIAJES Y GUIAS TURISTIC.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MAY. PRODUCTOS TEXTILES.\",\"HOTELES, CAMPAMENTOS Y OTROS.ACTIV.TEATRALES, MUSICALES Y OTRAS.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MIN. EN ALMACENES NO ESPECIALIZ.\",\"VTA. MAY. PRODUCTOS TEXTILES.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MAY. PRODUCTOS TEXTILES.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. OTROS PROD. TEXTILES NEOP.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"FAB. OTROS PROD. TEXTILES NEOP.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. OTROS PROD. TEXTILES NEOP.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.VTA. MAY. PRODUCTOS TEXTILES.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.FAB. DE CALZADO.\",\"VTA. MIN. ALIMENTOS, BEBIDAS, TABACOVTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. EN ALMACENES NO ESPECIALIZ.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. OTROS PRODUCTOS EN ALMACEN.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. EN PUESTOS DE VENTA.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MAY. ALIMENTOS, BEBIDAS Y TABACO.VTA. MAY. DE OTROS PRODUCTOS.\",\"FAB. DE PRENDAS DE VESTIR.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"FAB. DE PRENDAS DE VESTIR.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. DE PRENDAS DE VESTIR.FAB. TEJIDOS Y ART DE PUNTO.\")\n\nand  concat(trim(rec_act_secun1),trim(emi_act_secun2)) not in (\"PLANES DE SEGUROS DE VIDAACTIVIDADES DE HOSPITALES\",\"PLANES DE SEGUROS DE VIDAOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"PLANES DE SEGUROS DE VIDAACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"PLANES DE SEGUROS GENERALESACTIVIDADES DE HOSPITALES\",\"PLANES DE SEGUROS GENERALESOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"PLANES DE SEGUROS GENERALESACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.ACTIVIDADES DE HOSPITALES\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.OTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.ACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAACTIVIDADES DE HOSPITALES\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"ACTIVIDADES DE HOSPITALESACTIVIDADES DE HOSPITALES\",\"ACTIVIDADES DE HOSPITALESOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIVIDADES DE HOSPITALESACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"RESTAURANTES, BARES Y CANTINAS.VTA. MIN. OTROS PRODUCTOS EN ALMACEN.\",\"RESTAURANTES, BARES Y CANTINAS.VTA. MIN. EN ALMACENES NO ESPECIALIZ\",\"RESTAURANTES, BARES Y CANTINAS.OTROS TIPOS DE VENTA AL POR MENOR.\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOACTIVIDADES DE HOSPITALES\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.RESTAURANTES, BARES Y CANTINAS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.HOTELES, CAMPAMENTOS Y OTROS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.OTRAS ACTIVID.ENTRETENIMIENTO NCP.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.ACTIV.TEATRALES, MUSICALES Y OTRAS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.OTRAS ACTIVIDADES DE ESPARCIMIENTO\",\"ACABADO DE PROD. TEXTILES.FAB. DE PRENDAS DE VESTIR.\",\"ACABADO DE PROD. TEXTILES.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"ACABADO DE PROD. TEXTILES.FAB. DE ARTICULOS DE PIEL.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MAY. DE OTROS PRODUCTOS.\",\"HOTELES, CAMPAMENTOS Y OTROS.RESTAURANTES, BARES Y CANTINAS.\",\"HOTELES, CAMPAMENTOS Y OTROS.AGENCIAS DE VIAJES Y GUIAS TURISTIC.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MAY. PRODUCTOS TEXTILES.\",\"HOTELES, CAMPAMENTOS Y OTROS.ACTIV.TEATRALES, MUSICALES Y OTRAS.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MIN. EN ALMACENES NO ESPECIALIZ.\",\"VTA. MAY. PRODUCTOS TEXTILES.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MAY. PRODUCTOS TEXTILES.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. OTROS PROD. TEXTILES NEOP.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"FAB. OTROS PROD. TEXTILES NEOP.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. OTROS PROD. TEXTILES NEOP.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.VTA. MAY. PRODUCTOS TEXTILES.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.FAB. DE CALZADO.\",\"VTA. MIN. ALIMENTOS, BEBIDAS, TABACOVTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. EN ALMACENES NO ESPECIALIZ.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. OTROS PRODUCTOS EN ALMACEN.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. EN PUESTOS DE VENTA.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MAY. ALIMENTOS, BEBIDAS Y TABACO.VTA. MAY. DE OTROS PRODUCTOS.\",\"FAB. DE PRENDAS DE VESTIR.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"FAB. DE PRENDAS DE VESTIR.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. DE PRENDAS DE VESTIR.FAB. TEJIDOS Y ART DE PUNTO.\")\n\n\nand concat(trim(rec_act_secun2),trim(emi_act_principal)) not in (\"PLANES DE SEGUROS DE VIDAACTIVIDADES DE HOSPITALES\",\"PLANES DE SEGUROS DE VIDAOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"PLANES DE SEGUROS DE VIDAACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"PLANES DE SEGUROS GENERALESACTIVIDADES DE HOSPITALES\",\"PLANES DE SEGUROS GENERALESOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"PLANES DE SEGUROS GENERALESACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.ACTIVIDADES DE HOSPITALES\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.OTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.ACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAACTIVIDADES DE HOSPITALES\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"ACTIVIDADES DE HOSPITALESACTIVIDADES DE HOSPITALES\",\"ACTIVIDADES DE HOSPITALESOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIVIDADES DE HOSPITALESACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"RESTAURANTES, BARES Y CANTINAS.VTA. MIN. OTROS PRODUCTOS EN ALMACEN.\",\"RESTAURANTES, BARES Y CANTINAS.VTA. MIN. EN ALMACENES NO ESPECIALIZ\",\"RESTAURANTES, BARES Y CANTINAS.OTROS TIPOS DE VENTA AL POR MENOR.\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOACTIVIDADES DE HOSPITALES\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.RESTAURANTES, BARES Y CANTINAS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.HOTELES, CAMPAMENTOS Y OTROS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.OTRAS ACTIVID.ENTRETENIMIENTO NCP.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.ACTIV.TEATRALES, MUSICALES Y OTRAS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.OTRAS ACTIVIDADES DE ESPARCIMIENTO\",\"ACABADO DE PROD. TEXTILES.FAB. DE PRENDAS DE VESTIR.\",\"ACABADO DE PROD. TEXTILES.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"ACABADO DE PROD. TEXTILES.FAB. DE ARTICULOS DE PIEL.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MAY. DE OTROS PRODUCTOS.\",\"HOTELES, CAMPAMENTOS Y OTROS.RESTAURANTES, BARES Y CANTINAS.\",\"HOTELES, CAMPAMENTOS Y OTROS.AGENCIAS DE VIAJES Y GUIAS TURISTIC.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MAY. PRODUCTOS TEXTILES.\",\"HOTELES, CAMPAMENTOS Y OTROS.ACTIV.TEATRALES, MUSICALES Y OTRAS.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MIN. EN ALMACENES NO ESPECIALIZ.\",\"VTA. MAY. PRODUCTOS TEXTILES.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MAY. PRODUCTOS TEXTILES.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. OTROS PROD. TEXTILES NEOP.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"FAB. OTROS PROD. TEXTILES NEOP.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. OTROS PROD. TEXTILES NEOP.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.VTA. MAY. PRODUCTOS TEXTILES.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.FAB. DE CALZADO.\",\"VTA. MIN. ALIMENTOS, BEBIDAS, TABACOVTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. EN ALMACENES NO ESPECIALIZ.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. OTROS PRODUCTOS EN ALMACEN.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. EN PUESTOS DE VENTA.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MAY. ALIMENTOS, BEBIDAS Y TABACO.VTA. MAY. DE OTROS PRODUCTOS.\",\"FAB. DE PRENDAS DE VESTIR.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"FAB. DE PRENDAS DE VESTIR.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. DE PRENDAS DE VESTIR.FAB. TEJIDOS Y ART DE PUNTO.\")\n\nand concat(trim(rec_act_secun2),trim(emi_act_secun1)) not in (\"PLANES DE SEGUROS DE VIDAACTIVIDADES DE HOSPITALES\",\"PLANES DE SEGUROS DE VIDAOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"PLANES DE SEGUROS DE VIDAACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"PLANES DE SEGUROS GENERALESACTIVIDADES DE HOSPITALES\",\"PLANES DE SEGUROS GENERALESOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"PLANES DE SEGUROS GENERALESACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.ACTIVIDADES DE HOSPITALES\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.OTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.ACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAACTIVIDADES DE HOSPITALES\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"ACTIVIDADES DE HOSPITALESACTIVIDADES DE HOSPITALES\",\"ACTIVIDADES DE HOSPITALESOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIVIDADES DE HOSPITALESACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"RESTAURANTES, BARES Y CANTINAS.VTA. MIN. OTROS PRODUCTOS EN ALMACEN.\",\"RESTAURANTES, BARES Y CANTINAS.VTA. MIN. EN ALMACENES NO ESPECIALIZ\",\"RESTAURANTES, BARES Y CANTINAS.OTROS TIPOS DE VENTA AL POR MENOR.\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOACTIVIDADES DE HOSPITALES\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.RESTAURANTES, BARES Y CANTINAS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.HOTELES, CAMPAMENTOS Y OTROS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.OTRAS ACTIVID.ENTRETENIMIENTO NCP.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.ACTIV.TEATRALES, MUSICALES Y OTRAS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.OTRAS ACTIVIDADES DE ESPARCIMIENTO\",\"ACABADO DE PROD. TEXTILES.FAB. DE PRENDAS DE VESTIR.\",\"ACABADO DE PROD. TEXTILES.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"ACABADO DE PROD. TEXTILES.FAB. DE ARTICULOS DE PIEL.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MAY. DE OTROS PRODUCTOS.\",\"HOTELES, CAMPAMENTOS Y OTROS.RESTAURANTES, BARES Y CANTINAS.\",\"HOTELES, CAMPAMENTOS Y OTROS.AGENCIAS DE VIAJES Y GUIAS TURISTIC.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MAY. PRODUCTOS TEXTILES.\",\"HOTELES, CAMPAMENTOS Y OTROS.ACTIV.TEATRALES, MUSICALES Y OTRAS.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MIN. EN ALMACENES NO ESPECIALIZ.\",\"VTA. MAY. PRODUCTOS TEXTILES.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MAY. PRODUCTOS TEXTILES.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. OTROS PROD. TEXTILES NEOP.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"FAB. OTROS PROD. TEXTILES NEOP.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. OTROS PROD. TEXTILES NEOP.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.VTA. MAY. PRODUCTOS TEXTILES.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.FAB. DE CALZADO.\",\"VTA. MIN. ALIMENTOS, BEBIDAS, TABACOVTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. EN ALMACENES NO ESPECIALIZ.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. OTROS PRODUCTOS EN ALMACEN.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. EN PUESTOS DE VENTA.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MAY. ALIMENTOS, BEBIDAS Y TABACO.VTA. MAY. DE OTROS PRODUCTOS.\",\"FAB. DE PRENDAS DE VESTIR.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"FAB. DE PRENDAS DE VESTIR.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. DE PRENDAS DE VESTIR.FAB. TEJIDOS Y ART DE PUNTO.\")\n\nand  concat(trim(rec_act_secun2),trim(emi_act_secun2)) not in (\"PLANES DE SEGUROS DE VIDAACTIVIDADES DE HOSPITALES\",\"PLANES DE SEGUROS DE VIDAOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"PLANES DE SEGUROS DE VIDAACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"PLANES DE SEGUROS GENERALESACTIVIDADES DE HOSPITALES\",\"PLANES DE SEGUROS GENERALESOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"PLANES DE SEGUROS GENERALESACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.ACTIVIDADES DE HOSPITALES\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.OTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIV. FINANC. PLANES SEGUROS Y PENS.ACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAACTIVIDADES DE HOSPITALES\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"OTRAS ACTIV.RELAC. CON SALUD HUMANAACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"ACTIVIDADES DE HOSPITALESACTIVIDADES DE HOSPITALES\",\"ACTIVIDADES DE HOSPITALESOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIVIDADES DE HOSPITALESACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"RESTAURANTES, BARES Y CANTINAS.VTA. MIN. OTROS PRODUCTOS EN ALMACEN.\",\"RESTAURANTES, BARES Y CANTINAS.VTA. MIN. EN ALMACENES NO ESPECIALIZ\",\"RESTAURANTES, BARES Y CANTINAS.OTROS TIPOS DE VENTA AL POR MENOR.\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOACTIVIDADES DE HOSPITALES\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOOTRAS ACTIV.RELAC. CON SALUD HUMANA\",\"ACTIVIDADES DE MEDICOS Y ODONTOLOGOACTIVIDADES DE MEDICOS Y ODONTOLOGO\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.RESTAURANTES, BARES Y CANTINAS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.HOTELES, CAMPAMENTOS Y OTROS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.OTRAS ACTIVID.ENTRETENIMIENTO NCP.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.ACTIV.TEATRALES, MUSICALES Y OTRAS.\",\"AGENCIAS DE VIAJES Y GUIAS TURISTIC.OTRAS ACTIVIDADES DE ESPARCIMIENTO\",\"ACABADO DE PROD. TEXTILES.FAB. DE PRENDAS DE VESTIR.\",\"ACABADO DE PROD. TEXTILES.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"ACABADO DE PROD. TEXTILES.FAB. DE ARTICULOS DE PIEL.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MAY. DE OTROS PRODUCTOS.\",\"HOTELES, CAMPAMENTOS Y OTROS.RESTAURANTES, BARES Y CANTINAS.\",\"HOTELES, CAMPAMENTOS Y OTROS.AGENCIAS DE VIAJES Y GUIAS TURISTIC.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MAY. PRODUCTOS TEXTILES.\",\"HOTELES, CAMPAMENTOS Y OTROS.ACTIV.TEATRALES, MUSICALES Y OTRAS.\",\"HOTELES, CAMPAMENTOS Y OTROS.VTA. MIN. EN ALMACENES NO ESPECIALIZ.\",\"VTA. MAY. PRODUCTOS TEXTILES.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MAY. PRODUCTOS TEXTILES.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. OTROS PROD. TEXTILES NEOP.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"FAB. OTROS PROD. TEXTILES NEOP.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. OTROS PROD. TEXTILES NEOP.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.FAB. TEJIDOS Y ART DE PUNTO.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.VTA. MAY. PRODUCTOS TEXTILES.\",\"VTA. MIN. PRODUCTOS TEXTILES, CALZADO.FAB. DE CALZADO.\",\"VTA. MIN. ALIMENTOS, BEBIDAS, TABACOVTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. EN ALMACENES NO ESPECIALIZ.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. OTROS PRODUCTOS EN ALMACEN.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MIN. EN PUESTOS DE VENTA.VTA. MAY. DE OTROS PRODUCTOS.\",\"VTA. MAY. ALIMENTOS, BEBIDAS Y TABACO.VTA. MAY. DE OTROS PRODUCTOS.\",\"FAB. DE PRENDAS DE VESTIR.VTA. MIN. PRODUCTOS TEXTILES, CALZADO.\",\"FAB. DE PRENDAS DE VESTIR.VTA. MAY. PRODUCTOS TEXTILES.\",\"FAB. DE PRENDAS DE VESTIR.FAB. TEJIDOS Y ART DE PUNTO.\")\n","dateUpdated":"2019-03-13T15:39:30-0400","config":{"tableHide":false,"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970561_-716103747","id":"20190305-164558_1880641833","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77624"},{"text":"%livy2.sql\nselect count(*) from ds02_gastos_no_deducibles.201811_salidafinalfinal","user":"jrodriguez","dateUpdated":"2019-03-13T18:05:13-0400","config":{"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(1)\n57692"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0694<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0694/</a>"}]},"apps":[],"jobName":"paragraph_1552505970562_-714949500","id":"20190306-173151_18776278","dateCreated":"2019-03-13T15:39:30-0400","dateStarted":"2019-03-13T18:05:13-0400","dateFinished":"2019-03-13T18:05:25-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:77625"},{"text":"%livy2.sql\n","dateUpdated":"2019-03-13T15:39:30-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552505970563_-715334249","id":"20190306-183130_2093267423","dateCreated":"2019-03-13T15:39:30-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77626"}],"name":"Users/jrodriguez/03MigraciónGND 201811 Sintilde","id":"2E6FWYNEQ","angularObjects":{"2CHS8UYQQ:shared_process":[],"2CKX6DGQZ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2CKX8WPU1:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2DA37NKGE:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}