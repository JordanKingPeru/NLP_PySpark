{"paragraphs":[{"text":"%md\n# Creación de matriz de datos para el clustering","user":"jrodriguez","dateUpdated":"2019-02-25T14:11:16-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Creación de matriz de datos para el clustering</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1551121840912_1082596114","id":"20190225-141040_1683943203","dateCreated":"2019-02-25T14:10:40-0500","dateStarted":"2019-02-25T14:11:16-0500","dateFinished":"2019-02-25T14:11:16-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:94520"},{"text":"%livy2.sql\nselect count(*) from ds12_potenciales_contribuyentes.md_cluster","user":"eyupanqui","dateUpdated":"2019-03-04T11:39:03-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(1)\n3467200"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0554<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0554/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0554/</a>"}]},"apps":[],"jobName":"paragraph_1551212728167_-903028365","id":"20190226-152528_1447170599","dateCreated":"2019-02-26T15:25:28-0500","dateStarted":"2019-03-04T11:39:03-0500","dateFinished":"2019-03-04T11:39:23-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:94521"},{"text":"%livy2.sql\ndrop table ds12_potenciales_contribuyentes.md_cluster","user":"eyupanqui","dateUpdated":"2019-02-28T15:01:44-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0434<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0434/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0434/</a>"}]},"apps":[],"jobName":"paragraph_1551384094118_-2088865489","id":"20190228-150134_1133222690","dateCreated":"2019-02-28T15:01:34-0500","dateStarted":"2019-02-28T15:01:44-0500","dateFinished":"2019-02-28T15:01:46-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:94522"},{"text":"%livy2.sql\ndrop table ds12_potenciales_contribuyentes.md_cluster","user":"eyupanqui","dateUpdated":"2019-02-28T15:15:19-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"org.apache.spark.sql.catalyst.analysis.NoSuchTableException: Table or view 'md_cluster' not found in database 'ds12_potenciales_contribuyentes';\n  at org.apache.spark.sql.catalyst.catalog.SessionCatalog.dropTable(SessionCatalog.scala:638)\n  at org.apache.spark.sql.execution.command.DropTableCommand.run(ddl.scala:212)\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:58)\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:56)\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.executeCollect(commands.scala:67)\n  at org.apache.spark.sql.Dataset.<init>(Dataset.scala:182)\n  at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:67)\n  at org.apache.spark.sql.SparkSession.sql(SparkSession.scala:636)\n  ... 50 elided"}]},"apps":[],"jobName":"paragraph_1551384513891_-2095040085","id":"20190228-150833_1370136776","dateCreated":"2019-02-28T15:08:33-0500","dateStarted":"2019-02-28T15:11:45-0500","dateFinished":"2019-02-28T15:11:46-0500","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:94523"},{"text":"%livy2.sql\ncreate table ds12_potenciales_contribuyentes.md_cluster as \nselect nro_doc,nro_columnas,edad,nvl(itf_ingreso,0) as itf_ingreso,nvl(itf_egresos,0) as itf_egresos, nvl(itf_transacciones,0) as itf_transacciones, nvl(pre_predios,0) as pre_predios,\n       nvl(pre_mto_autov,0) as pre_mto_autov, nvl(cpe_comprobantes_electronico,0) as cpe_comprobantes_electronico, nvl(cpe_mto_total_venta_real,0) as cpe_mto_total_venta_real, nvl(cpe_mto_total_igv_real,0) as cpe_mto_total_igv_real,\n       nvl(cpe_mto_total_venta_otroscpe,0) as cpe_mto_total_venta_otroscpe,nvl(rcc_prom_normal_6m,0) as rcc_prom_normal_6m, nvl(rcc_num_entrep_dic2018,0) as rcc_num_entrep_dic2018, \n       nvl(rosf_ord_ben,0) as rosf_ord_ben,nvl(rosf_ord_eje,0) as rosf_ord_eje,nvl(rosf_ben_eje,0) as rosf_ben_eje,nvl(rosf_ben_ord,0) as rosf_ben_ord, nvl(rosf_eje_ord,0) as rosf_eje_ord,nvl(rosf_eje_ben,0) as rosf_eje_ben, \n       nvl(mig_salida_peru,0) as mig_salida_peru,nvl(mig_entrada_pais,0) as mig_entrada_pais,nvl(mig_registos,0) as mig_registos,nvl(mig_porc_salidas_americas,0) as mig_porc_salidas_americas, nvl(mig_diferencia_dias,0) as mig_diferencia_dias,nvl(mig_prom_dias_viaje,0) as mig_prom_dias_viaje\nfrom ds12_potenciales_contribuyentes.md_potenciales_contribuyentes_positivos","user":"eyupanqui","dateUpdated":"2019-02-28T15:12:10-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0434<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0434/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0434/</a>"}]},"apps":[],"jobName":"paragraph_1550854274276_1978467338","id":"20190222-115114_599883511","dateCreated":"2019-02-22T11:51:14-0500","dateStarted":"2019-02-28T15:12:11-0500","dateFinished":"2019-02-28T15:12:37-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:94524"},{"text":"%livy2.pyspark\ndataset = spark.sql('select * from ds12_potenciales_contribuyentes.md_cluster')","user":"eyupanqui","dateUpdated":"2019-03-05T09:19:24-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0554<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0554/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0554/</a>"}]},"apps":[],"jobName":"paragraph_1550854296916_392563020","id":"20190222-115136_593104476","dateCreated":"2019-02-22T11:51:36-0500","dateStarted":"2019-03-05T09:19:24-0500","dateFinished":"2019-03-05T09:19:25-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:94525"},{"text":"%livy2.pyspark\ndataset.columns","user":"eyupanqui","dateUpdated":"2019-02-28T15:12:47-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['nro_doc', 'nro_columnas', 'edad', 'itf_ingreso', 'itf_egresos', 'itf_transacciones', 'pre_predios', 'pre_mto_autov', 'cpe_comprobantes_electronico', 'cpe_mto_total_venta_real', 'cpe_mto_total_igv_real', 'cpe_mto_total_venta_otroscpe', 'rcc_prom_normal_6m', 'rcc_num_entrep_dic2018', 'rosf_ord_ben', 'rosf_ord_eje', 'rosf_ben_eje', 'rosf_ben_ord', 'rosf_eje_ord', 'rosf_eje_ben', 'mig_salida_peru', 'mig_entrada_pais', 'mig_registos', 'mig_porc_salidas_americas', 'mig_diferencia_dias', 'mig_prom_dias_viaje']"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0434<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0434/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0434/</a>"}]},"apps":[],"jobName":"paragraph_1550855190192_-1293949061","id":"20190222-120630_2035555407","dateCreated":"2019-02-22T12:06:30-0500","dateStarted":"2019-02-28T15:12:47-0500","dateFinished":"2019-02-28T15:12:48-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:94526"},{"text":"%livy2.pyspark\nfrom pyspark.ml.linalg import Vectors\nfrom pyspark.ml.feature import VectorAssembler\n\nassembler = VectorAssembler(\n    inputCols=['nro_columnas', 'edad', 'itf_ingreso', 'itf_egresos', 'itf_transacciones', 'pre_predios', 'pre_mto_autov', 'cpe_comprobantes_electronico', 'cpe_mto_total_venta_real', 'cpe_mto_total_igv_real', 'cpe_mto_total_venta_otroscpe', 'rcc_prom_normal_6m', 'rcc_num_entrep_dic2018', 'rosf_ord_ben', 'rosf_ord_eje', 'rosf_ben_eje', 'rosf_ben_ord', 'rosf_eje_ord', 'rosf_eje_ben', 'mig_salida_peru', 'mig_entrada_pais', 'mig_registos', 'mig_porc_salidas_americas', 'mig_diferencia_dias', 'mig_prom_dias_viaje'],\n    outputCol= 'features_vector')\n\ndataset = assembler.transform(dataset)\n","user":"eyupanqui","dateUpdated":"2019-03-05T09:19:30-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0554<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0554/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0554/</a>"}]},"apps":[],"jobName":"paragraph_1550855500277_-719662328","id":"20190222-121140_78903960","dateCreated":"2019-02-22T12:11:40-0500","dateStarted":"2019-03-05T09:19:30-0500","dateFinished":"2019-03-05T09:19:31-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:94527"},{"text":"%livy2.pyspark\nfrom pyspark.ml.feature import StandardScaler\nscaler = StandardScaler(inputCol=\"features_vector\", outputCol=\"features\",\n                        withStd=True, withMean=True)\n\n# Compute summary statistics by fitting the StandardScaler\nscalerModel = scaler.fit(dataset)\n\n# Normalize each feature to have unit standard deviation.\ndataset = scalerModel.transform(dataset)\n","user":"eyupanqui","dateUpdated":"2019-03-05T09:19:39-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0554<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0554/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0554/</a>"}]},"apps":[],"jobName":"paragraph_1550855810298_1672966844","id":"20190222-121650_1379466342","dateCreated":"2019-02-22T12:16:50-0500","dateStarted":"2019-03-05T09:19:39-0500","dateFinished":"2019-03-05T09:20:06-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:94528"},{"text":"%livy2.pyspark\nfrom pyspark.ml.clustering import KMeans\n#from pyspark.ml.evaluation import ClusteringEvaluator\n\n# Trains a k-means model.\nkmeans = KMeans().setK(10).setSeed(1)\nmodel = kmeans.fit(dataset)\n\n# Make predictions\npredictions = model.transform(dataset)\n\n# Evaluate clustering by computing Silhouette score\n#evaluator = ClusteringEvaluator()\n\n#silhouette = evaluator.evaluate(predictions)\n#print(\"Silhouette with squared euclidean distance = \" + str(silhouette))\n\n# Shows the result.\n#centers = model.clusterCenters()\n#print(\"Cluster Centers: \")\n#for center in centers:\n#    print(center)","user":"eyupanqui","dateUpdated":"2019-03-05T09:20:35-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0554<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0554/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0554/</a>"}]},"apps":[],"jobName":"paragraph_1550856857769_-1345314422","id":"20190222-123417_1433265077","dateCreated":"2019-02-22T12:34:17-0500","dateStarted":"2019-03-05T09:20:35-0500","dateFinished":"2019-03-05T09:20:57-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:94529"},{"text":"%livy2.pyspark\npredictions.groupBy('prediction').count().show()","user":"eyupanqui","dateUpdated":"2019-02-28T15:19:37-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+-------+\n|prediction|  count|\n+----------+-------+\n|         1|1024531|\n|         6|     48|\n|         3|      1|\n|         5|1286829|\n|         9| 144769|\n|         4|    664|\n|         8|  42915|\n|         7|      3|\n|         2| 101822|\n|         0| 865618|\n+----------+-------+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0434<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0434/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0434/</a>"}]},"apps":[],"jobName":"paragraph_1550860224177_-1627512154","id":"20190222-133024_393334384","dateCreated":"2019-02-22T13:30:24-0500","dateStarted":"2019-02-28T15:19:37-0500","dateFinished":"2019-02-28T15:19:45-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:94530"},{"text":"%livy2.pyspark\npredictions.filter(predictions.prediction==8).show()","user":"rlinares","dateUpdated":"2019-02-22T13:54:13-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+------------+----+-----------+-----------+-----------------+-----------+-----------------+----------------------------+------------------------+----------------------+----------------------------+------------------+----------------------+--------------------+--------------------+----------+\n| nro_doc|nro_columnas|edad|itf_ingreso|itf_egresos|itf_transacciones|pre_predios|    pre_mto_autov|cpe_comprobantes_electronico|cpe_mto_total_venta_real|cpe_mto_total_igv_real|cpe_mto_total_venta_otroscpe|rcc_prom_normal_6m|rcc_num_entrep_dic2018|     features_vector|            features|prediction|\n+--------+------------+----+-----------+-----------+-----------------+-----------+-----------------+----------------------------+------------------------+----------------------+----------------------------+------------------+----------------------+--------------------+--------------------+----------+\n|09289393|           2|  50|        0.0|        0.0|                0|          2|5434824.409999999|                          13|                  2740.0|                   4.5|                         0.0|               0.0|                     0|(13,[0,1,5,6,7,8,...|[0.63398751551291...|         8|\n|06209210|           2|  53|     9800.0|        0.0|                1|          1|        5428069.1|                           0|                     0.0|                   0.0|                         0.0|               0.0|                     0|(13,[0,1,2,4,5,6]...|[0.63398751551291...|         8|\n|09222343|           3|  76|        0.0|        0.0|                2|          1|       4713938.44|                           0|                     0.0|                   0.0|                         0.0|             100.0|                     1|(13,[0,1,4,5,6,11...|[2.07021124851261...|         8|\n|10080125|           1|  44|        0.0|        0.0|                0|          1|       4713938.44|                           0|                     0.0|                   0.0|                         0.0|               0.0|                     0|(13,[0,1,5,6],[1....|[-0.8022362174867...|         8|\n|06565859|           1|  65|        0.0|        0.0|                0|          1|       9793846.44|                           0|                     0.0|                   0.0|                         0.0|               0.0|                     0|(13,[0,1,5,6],[1....|[-0.8022362174867...|         8|\n|20667053|           2|  48|        0.0|     6000.0|                1|          2|       4810549.24|                           0|                     0.0|                   0.0|                         0.0|               0.0|                     0|(13,[0,1,3,4,5,6]...|[0.63398751551291...|         8|\n|08616260|           1|  61|        0.0|        0.0|                0|          2|        5435877.2|                           0|                     0.0|                   0.0|                         0.0|               0.0|                     0|(13,[0,1,5,6],[1....|[-0.8022362174867...|         8|\n|28249585|           4|  68|        0.0|    31986.0|               12|          1|       5394204.66|                           1|                    60.0|                   0.0|                         0.0|             100.0|                     3|[4.0,68.0,0.0,319...|[3.50643498151231...|         8|\n|22671651|           1|  48|        0.0|        0.0|                0|         11|       6133580.97|                           0|                     0.0|                   0.0|                         0.0|               0.0|                     0|(13,[0,1,5,6],[1....|[-0.8022362174867...|         8|\n|10050957|           3|  44|        0.0|        0.0|                0|          3|       7808324.68|                           3|                  402.55|                 72.45|                         0.0|               0.0|                     1|[3.0,44.0,0.0,0.0...|[2.07021124851261...|         8|\n|08366908|           1|  63|        0.0|        0.0|                0|          1|       9793846.44|                           0|                     0.0|                   0.0|                         0.0|               0.0|                     0|(13,[0,1,5,6],[1....|[-0.8022362174867...|         8|\n|09931118|           1|  48|        0.0|        0.0|                0|          1|       5394204.66|                           0|                     0.0|                   0.0|                         0.0|               0.0|                     0|(13,[0,1,5,6],[1....|[-0.8022362174867...|         8|\n|47494361|           1|  27|        0.0|        0.0|                0|          1|        4711205.0|                           0|                     0.0|                   0.0|                         0.0|               0.0|                     0|(13,[0,1,5,6],[1....|[-0.8022362174867...|         8|\n|47524523|           2|  26|     3200.0|    12910.0|                5|          2|       9799806.66|                           0|                     0.0|                   0.0|                         0.0|               0.0|                     0|(13,[0,1,2,3,4,5,...|[0.63398751551291...|         8|\n|43727638|           4|  32|    11000.0|    28045.0|               33|          1|        4711205.0|                           2|                    9.32|    1.6800000000000002|                         0.0|             100.0|                     2|[4.0,32.0,11000.0...|[3.50643498151231...|         8|\n|20710688|           2|  42|     3000.0|     5000.0|                6|          1|       5394204.66|                           0|                     0.0|                   0.0|                         0.0|               0.0|                     0|(13,[0,1,2,3,4,5,...|[0.63398751551291...|         8|\n|09847480|           2|  48|        0.0|        0.0|                0|          1|       4713938.44|                           1|                    8.47|                  1.53|                         0.0|               0.0|                     0|(13,[0,1,5,6,7,8,...|[0.63398751551291...|         8|\n|10255612|           4|  61|     9600.0|    60800.0|                5|          1|       4713938.44|                           1|                     0.0|                   0.0|                      2987.5|               0.0|                     1|[4.0,61.0,9600.0,...|[3.50643498151231...|         8|\n|09652306|           3|  47|     5000.0|    19108.0|               14|          2|5402086.350000001|                           0|                     0.0|                   0.0|                         0.0|             100.0|                     1|[3.0,47.0,5000.0,...|[2.07021124851261...|         8|\n|43352524|           2|  68|        0.0|        0.0|                0|          1|    4.156845562E7|                           0|                     0.0|                   0.0|                         0.0|               0.0|                     1|(13,[0,1,5,6,12],...|[0.63398751551291...|         8|\n+--------+------------+----+-----------+-----------+-----------------+-----------+-----------------+----------------------------+------------------------+----------------------+----------------------------+------------------+----------------------+--------------------+--------------------+----------+\nonly showing top 20 rows"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0188<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0188/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0188/</a>"}]},"apps":[],"jobName":"paragraph_1550855373732_-897933529","id":"20190222-120933_955121276","dateCreated":"2019-02-22T12:09:33-0500","dateStarted":"2019-02-22T13:54:13-0500","dateFinished":"2019-02-22T13:54:16-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:94531"},{"text":"%livy2.pyspark\n","user":"eyupanqui","dateUpdated":"2019-03-05T09:34:32-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1551794624875_-1043132784","id":"20190305-090344_1110046804","dateCreated":"2019-03-05T09:03:44-0500","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:94532"},{"text":"%livy2.pyspark\npredictions.select('nro_doc','prediction').write.format(\"parquet\").saveAsTable(\"ds12_potenciales_contribuyentes.md_cluster_resultado_v2\")","user":"eyupanqui","dateUpdated":"2019-02-28T15:24:10-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0434<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0434/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0434/</a>"}]},"apps":[],"jobName":"paragraph_1550861572419_426380334","id":"20190222-135252_1238829032","dateCreated":"2019-02-22T13:52:52-0500","dateStarted":"2019-02-28T15:24:10-0500","dateFinished":"2019-02-28T15:24:36-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:94533"},{"text":"%livy2.pyspark\n\nfrom pyspark.ml.feature import PCA\nfrom pyspark.ml.linalg import Vectors\n\n\npca = PCA(k=6, inputCol=\"features\", outputCol=\"pcaFeatures\")\nmodel = pca.fit(predictions)\n\nresult = model.transform(predictions)\nresult.show(truncate=False)","user":"eyupanqui","dateUpdated":"2019-03-05T09:33:08-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+------------+----+-----------+-----------+-----------------+-----------+-------------+----------------------------+------------------------+----------------------+----------------------------+------------------+----------------------+------------+------------+------------+------------+------------+------------+---------------+----------------+------------+-------------------------+-------------------+-------------------+--------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------------------------------------------------------------------------------------------------------------------------+\n|nro_doc |nro_columnas|edad|itf_ingreso|itf_egresos|itf_transacciones|pre_predios|pre_mto_autov|cpe_comprobantes_electronico|cpe_mto_total_venta_real|cpe_mto_total_igv_real|cpe_mto_total_venta_otroscpe|rcc_prom_normal_6m|rcc_num_entrep_dic2018|rosf_ord_ben|rosf_ord_eje|rosf_ben_eje|rosf_ben_ord|rosf_eje_ord|rosf_eje_ben|mig_salida_peru|mig_entrada_pais|mig_registos|mig_porc_salidas_americas|mig_diferencia_dias|mig_prom_dias_viaje|features_vector                                                           |features                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |prediction|pcaFeatures                                                                                                                |\n+--------+------------+----+-----------+-----------+-----------------+-----------+-------------+----------------------------+------------------------+----------------------+----------------------------+------------------+----------------------+------------+------------+------------+------------+------------+------------+---------------+----------------+------------+-------------------------+-------------------+-------------------+--------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------------------------------------------------------------------------------------------------------------------------+\n|00000265|1           |75  |0.0        |0.0        |0                |0          |0.0          |11                          |3683.5699999999997      |357.53                |0.0                         |0.0               |0                     |0           |0           |0           |0           |0           |0           |0              |0               |0           |0.0                      |0                  |0.0                |(25,[0,1,7,8,9],[1.0,75.0,11.0,3683.5699999999997,357.53])                |[-0.7858441243939626,2.031619436058919,-0.0032257184379377093,-0.00416249354344102,-0.5539553129042483,-0.1738451720953279,-0.026189741828995982,0.32264470830528275,0.06896114379985706,0.04936382043561818,-0.005558846720903417,-0.6690300621849241,-0.7940176737047439,-0.09134567779980213,-0.10105711808528435,-0.09528982375700086,-0.09131973518764257,-0.06570738916072205,-0.0652269977759913,-0.04850540220146462,-0.04711613227458127,-0.047816301954024344,-0.28777610224360545,-0.17815885014261246,-0.16466902109782183]        |0         |[0.4253948008797104,0.1434698213298288,-1.1254853901760775,0.1902922808528767,-0.7013683894817349,0.10461128748880107]     |\n|00000892|1           |63  |0.0        |0.0        |0                |0          |0.0          |2                           |15.0                    |2.29                  |0.0                         |0.0               |0                     |0           |0           |0           |0           |0           |0           |0              |0               |0           |0.0                      |0                  |0.0                |(25,[0,1,7,8,9],[1.0,63.0,2.0,15.0,2.29])                                 |[-0.7858441243939626,1.3083804290293262,-0.0032257184379377093,-0.00416249354344102,-0.5539553129042483,-0.1738451720953279,-0.026189741828995982,-0.007007421302608468,-0.008923694683278745,-0.007447268455518617,-0.005558846720903417,-0.6690300621849241,-0.7940176737047439,-0.09134567779980213,-0.10105711808528435,-0.09528982375700086,-0.09131973518764257,-0.06570738916072205,-0.0652269977759913,-0.04850540220146462,-0.04711613227458127,-0.047816301954024344,-0.28777610224360545,-0.17815885014261246,-0.16466902109782183] |0         |[0.4431433159043334,0.1300813864950813,-1.1596575330503747,0.18321374083512248,-0.675555086178401,-0.010991107569229466]   |\n|00001692|1           |71  |0.0        |0.0        |0                |0          |0.0          |1                           |7.5                     |1.14                  |0.0                         |0.0               |0                     |0           |0           |0           |0           |0           |0           |0              |0               |0           |0.0                      |0                  |0.0                |(25,[0,1,7,8,9],[1.0,71.0,1.0,7.5,1.14])                                  |[-0.7858441243939626,1.7905397670490546,-0.0032257184379377093,-0.00416249354344102,-0.5539553129042483,-0.1738451720953279,-0.026189741828995982,-0.04363543570348526,-0.009082921926761498,-0.007631180042684497,-0.005558846720903417,-0.6690300621849241,-0.7940176737047439,-0.09134567779980213,-0.10105711808528435,-0.09528982375700086,-0.09131973518764257,-0.06570738916072205,-0.0652269977759913,-0.04850540220146462,-0.04711613227458127,-0.047816301954024344,-0.28777610224360545,-0.17815885014261246,-0.16466902109782183]  |0         |[0.43276928329212877,0.13764091259435993,-1.1401730262287502,0.18724360085086025,-0.6900584260551982,-0.014322258454474582]|\n|00001794|1           |58  |0.0        |0.0        |0                |0          |0.0          |2                           |24.3                    |3.71                  |0.0                         |0.0               |0                     |0           |0           |0           |0           |0           |0           |0              |0               |0           |0.0                      |0                  |0.0                |(25,[0,1,7,8,9],[1.0,58.0,2.0,24.3,3.71])                                 |[-0.7858441243939626,1.0070308427669958,-0.0032257184379377093,-0.00416249354344102,-0.5539553129042483,-0.1738451720953279,-0.026189741828995982,-0.007007421302608468,-0.008726252901360134,-0.0072201776261485735,-0.005558846720903417,-0.6690300621849241,-0.7940176737047439,-0.09134567779980213,-0.10105711808528435,-0.09528982375700086,-0.09131973518764257,-0.06570738916072205,-0.0652269977759913,-0.04850540220146462,-0.04711613227458127,-0.047816301954024344,-0.28777610224360545,-0.17815885014261246,-0.16466902109782183]|0         |[0.44972173179743213,0.12524095165230578,-1.1721096479325297,0.18063342613668235,-0.6662948753787741,-0.010261472042631102]|\n|00002088|1           |68  |0.0        |0.0        |0                |0          |0.0          |6                           |148.84999999999997      |18.82                 |0.0                         |0.0               |0                     |0           |0           |0           |0           |0           |0           |0              |0               |0           |0.0                      |0                  |0.0                |(25,[0,1,7,8,9],[1.0,68.0,6.0,148.84999999999997,18.82])                  |[-0.7858441243939626,1.6097300152916565,-0.0032257184379377093,-0.00416249354344102,-0.5539553129042483,-0.1738451720953279,-0.026189741828995982,0.1395046363008987,-0.0060820191445899036,-0.00480373929390818,-0.005558846720903417,-0.6690300621849241,-0.7940176737047439,-0.09134567779980213,-0.10105711808528435,-0.09528982375700086,-0.09131973518764257,-0.06570738916072205,-0.0652269977759913,-0.04850540220146462,-0.04711613227458127,-0.047816301954024344,-0.28777610224360545,-0.17815885014261246,-0.16466902109782183]    |0         |[0.43592961081930676,0.1356680148601391,-1.1454313672623897,0.18618860679931154,-0.6861072576965691,0.0020522061804707364] |\n|00003278|1           |73  |0.0        |0.0        |0                |0          |0.0          |12                          |302.52                  |52.459999999999994    |0.0                         |0.0               |0                     |0           |0           |0           |0           |0           |0           |0              |0               |0           |0.0                      |0                  |0.0                |(25,[0,1,7,8,9],[1.0,73.0,12.0,302.52,52.459999999999994])                |[-0.7858441243939626,1.9110796015539868,-0.0032257184379377093,-0.00416249354344102,-0.5539553129042483,-0.1738451720953279,-0.026189741828995982,0.3592727227061595,-0.0028195590771239753,5.760744384920042E-4,-0.005558846720903417,-0.6690300621849241,-0.7940176737047439,-0.09134567779980213,-0.10105711808528435,-0.09528982375700086,-0.09131973518764257,-0.06570738916072205,-0.0652269977759913,-0.04850540220146462,-0.04711613227458127,-0.047816301954024344,-0.28777610224360545,-0.17815885014261246,-0.16466902109782183]    |0         |[0.4284014303607974,0.1416279697076905,-1.1303154869980694,0.18936094321787647,-0.6973056092012979,0.02212521231590765]    |\n|00005496|1           |61  |0.0        |0.0        |0                |0          |0.0          |0                           |0.0                     |0.0                   |0.0                         |0.0               |1                     |0           |0           |0           |0           |0           |0           |0              |0               |0           |0.0                      |0                  |0.0                |(25,[0,1,12],[1.0,61.0,1.0])                                              |[-0.7858441243939626,1.187840594524394,-0.0032257184379377093,-0.00416249354344102,-0.5539553129042483,-0.1738451720953279,-0.026189741828995982,-0.08026345010436206,-0.009242149170244249,-0.007813492398657631,-0.005558846720903417,-0.6690300621849241,0.2077322216886156,-0.09134567779980213,-0.10105711808528435,-0.09528982375700086,-0.09131973518764257,-0.06570738916072205,-0.0652269977759913,-0.04850540220146462,-0.04711613227458127,-0.047816301954024344,-0.28777610224360545,-0.17815885014261246,-0.16466902109782183]    |0         |[0.3819351385421374,0.19337505779481104,-0.6724422952205933,0.1596659591159481,-0.5684549711034413,-0.020783636692973072]  |\n|00005959|1           |66  |0.0        |0.0        |0                |0          |0.0          |1                           |74.58                   |13.42                 |0.0                         |0.0               |0                     |0           |0           |0           |0           |0           |0           |0              |0               |0           |0.0                      |0                  |0.0                |(25,[0,1,7,8,9],[1.0,66.0,1.0,74.58,13.42])                               |[-0.7858441243939626,1.4891901807867243,-0.0032257184379377093,-0.00416249354344102,-0.5539553129042483,-0.1738451720953279,-0.026189741828995982,-0.04363543570348526,-0.007658793461051767,-0.005667324137991444,-0.005558846720903417,-0.6690300621849241,-0.7940176737047439,-0.09134567779980213,-0.10105711808528435,-0.09528982375700086,-0.09131973518764257,-0.06570738916072205,-0.0652269977759913,-0.04850540220146462,-0.04711613227458127,-0.047816301954024344,-0.28777610224360545,-0.17815885014261246,-0.16466902109782183]  |0         |[0.43933652491740127,0.1328027478273069,-1.152617076109916,0.18466332094557397,-0.6808143378256051,-0.011501707174238884]  |\n|00005977|1           |90  |0.0        |3000.0     |1                |0          |0.0          |0                           |0.0                     |0.0                   |0.0                         |0.0               |0                     |0           |0           |0           |0           |0           |0           |0              |0               |0           |0.0                      |0                  |0.0                |(25,[0,1,3,4],[1.0,90.0,3000.0,1.0])                                      |[-0.7858441243939626,2.93566819484591,-0.0032257184379377093,-0.003074432370668482,-0.38067498045791837,-0.1738451720953279,-0.026189741828995982,-0.08026345010436206,-0.009242149170244249,-0.007813492398657631,-0.005558846720903417,-0.6690300621849241,-0.7940176737047439,-0.09134567779980213,-0.10105711808528435,-0.09528982375700086,-0.09131973518764257,-0.06570738916072205,-0.0652269977759913,-0.04850540220146462,-0.04711613227458127,-0.047816301954024344,-0.28777610224360545,-0.17815885014261246,-0.16466902109782183]  |0         |[0.38747857579315537,0.16410653231417974,-1.0185799386424712,0.19008435142981228,-0.7050511161361062,-0.018849347306853035]|\n|00006754|1           |101 |0.0        |0.0        |0                |0          |0.0          |2                           |0.0                     |0.0                   |0.0                         |0.0               |0                     |0           |0           |0           |0           |0           |0           |0              |0               |0           |0.0                      |0                  |0.0                |(25,[0,1,7],[1.0,101.0,2.0])                                              |[-0.7858441243939626,3.5986372846230363,-0.0032257184379377093,-0.00416249354344102,-0.5539553129042483,-0.1738451720953279,-0.026189741828995982,-0.007007421302608468,-0.009242149170244249,-0.007813492398657631,-0.005558846720903417,-0.6690300621849241,-0.7940176737047439,-0.09134567779980213,-0.10105711808528435,-0.09528982375700086,-0.09131973518764257,-0.06570738916072205,-0.0652269977759913,-0.04850540220146462,-0.04711613227458127,-0.047816301954024344,-0.28777610224360545,-0.17815885014261246,-0.16466902109782183] |0         |[0.393137338750726,0.16687063013227207,-1.0650147776198433,0.20282414123342796,-0.7459466156436908,-0.01474300787903266]   |\n|00007018|1           |66  |0.0        |0.0        |0                |0          |0.0          |0                           |0.0                     |0.0                   |0.0                         |0.0               |1                     |0           |0           |0           |0           |0           |0           |0              |0               |0           |0.0                      |0                  |0.0                |(25,[0,1,12],[1.0,66.0,1.0])                                              |[-0.7858441243939626,1.4891901807867243,-0.0032257184379377093,-0.00416249354344102,-0.5539553129042483,-0.1738451720953279,-0.026189741828995982,-0.08026345010436206,-0.009242149170244249,-0.007813492398657631,-0.005558846720903417,-0.6690300621849241,0.2077322216886156,-0.09134567779980213,-0.10105711808528435,-0.09528982375700086,-0.09131973518764257,-0.06570738916072205,-0.0652269977759913,-0.04850540220146462,-0.04711613227458127,-0.047816301954024344,-0.28777610224360545,-0.17815885014261246,-0.16466902109782183]   |0         |[0.37535504967749433,0.19821581646586273,-0.659989064247053,0.16224627526518814,-0.5777175080929141,-0.02121374586295496]  |\n|00008904|1           |81  |4000.0     |0.0        |2                |0          |0.0          |0                           |0.0                     |0.0                   |0.0                         |0.0               |0                     |0           |0           |0           |0           |0           |0           |0              |0               |0           |0.0                      |0                  |0.0                |(25,[0,1,2,4],[1.0,81.0,4000.0,2.0])                                      |[-0.7858441243939626,2.3932389395737155,-0.0011910541610504416,-0.00416249354344102,-0.2073946480115885,-0.1738451720953279,-0.026189741828995982,-0.08026345010436206,-0.009242149170244249,-0.007813492398657631,-0.005558846720903417,-0.6690300621849241,-0.7940176737047439,-0.09134567779980213,-0.10105711808528435,-0.09528982375700086,-0.09131973518764257,-0.06570738916072205,-0.0652269977759913,-0.04850540220146462,-0.04711613227458127,-0.047816301954024344,-0.28777610224360545,-0.17815885014261246,-0.16466902109782183]  |0         |[0.37888377533608714,0.16364929356746422,-0.9662884168829168,0.17867016304684227,-0.6684631230830975,-0.018325645391698574]|\n|00009483|3           |55  |1000.0     |9377.0     |15               |0          |0.0          |1                           |25.0                    |0.0                   |0.0                         |50.0              |2                     |0           |0           |0           |0           |0           |0           |0              |0               |0           |0.0                      |0                  |0.0                |(25,[0,1,2,3,4,7,8,11,12],[3.0,55.0,1000.0,9377.0,15.0,1.0,25.0,50.0,2.0])|[1.934827075028036,0.8262210910095977,-0.002717052368715892,-7.615770044116565E-4,2.0452496737906998,-0.1738451720953279,-0.026189741828995982,-0.04363543570348526,-0.00871139169196841,-0.007813492398657631,-0.005558846720903417,0.4604803328955204,1.209482117081975,-0.09134567779980213,-0.10105711808528435,-0.09528982375700086,-0.09131973518764257,-0.06570738916072205,-0.0652269977759913,-0.04850540220146462,-0.04711613227458127,-0.047816301954024344,-0.28777610224360545,-0.17815885014261246,-0.16466902109782183]         |1         |[-0.43328319255424147,0.46199665941268203,2.7162128324216797,-0.127937840903769,0.5386676008381801,-0.02066225328974775]   |\n|00009612|1           |66  |0.0        |0.0        |0                |0          |0.0          |1                           |606.87                  |109.25                |0.0                         |0.0               |0                     |0           |0           |0           |0           |0           |0           |0              |0               |0           |0.0                      |0                  |0.0                |(25,[0,1,7,8,9],[1.0,66.0,1.0,606.87,109.25])                             |[-0.7858441243939626,1.4891901807867243,-0.0032257184379377093,-0.00416249354344102,-0.5539553129042483,-0.1738451720953279,-0.026189741828995982,-0.04363543570348526,0.003641882463406091,0.009658108382100999,-0.005558846720903417,-0.6690300621849241,-0.7940176737047439,-0.09134567779980213,-0.10105711808528435,-0.09528982375700086,-0.09131973518764257,-0.06570738916072205,-0.0652269977759913,-0.04850540220146462,-0.04711613227458127,-0.047816301954024344,-0.28777610224360545,-0.17815885014261246,-0.16466902109782183]    |0         |[0.4392351980170961,0.1328231264076193,-1.1525451182696362,0.1846635881317062,-0.6809594089018368,0.007284683920082514]    |\n|00022145|1           |69  |0.0        |0.0        |0                |0          |0.0          |0                           |0.0                     |0.0                   |0.0                         |0.0               |1                     |0           |0           |0           |0           |0           |0           |0              |0               |0           |0.0                      |0                  |0.0                |(25,[0,1,12],[1.0,69.0,1.0])                                              |[-0.7858441243939626,1.6699999325441226,-0.0032257184379377093,-0.00416249354344102,-0.5539553129042483,-0.1738451720953279,-0.026189741828995982,-0.08026345010436206,-0.009242149170244249,-0.007813492398657631,-0.005558846720903417,-0.6690300621849241,0.2077322216886156,-0.09134567779980213,-0.10105711808528435,-0.09528982375700086,-0.09131973518764257,-0.06570738916072205,-0.0652269977759913,-0.04850540220146462,-0.04711613227458127,-0.047816301954024344,-0.28777610224360545,-0.17815885014261246,-0.16466902109782183]   |0         |[0.37140699635870855,0.20112027166849375,-0.6525171256629287,0.16379446495473216,-0.5832750302865979,-0.021471811364944093]|\n|00022868|1           |56  |0.0        |0.0        |0                |0          |0.0          |1                           |450.0                   |0.0                   |0.0                         |0.0               |0                     |0           |0           |0           |0           |0           |0           |0              |0               |0           |0.0                      |0                  |0.0                |(25,[0,1,7,8],[1.0,56.0,1.0,450.0])                                       |[-0.7858441243939626,0.8864910082620637,-0.0032257184379377093,-0.00416249354344102,-0.5539553129042483,-0.1738451720953279,-0.026189741828995982,-0.04363543570348526,3.114854387208556E-4,-0.007813492398657631,-0.005558846720903417,-0.6690300621849241,-0.7940176737047439,-0.09134567779980213,-0.10105711808528435,-0.09528982375700086,-0.09131973518764257,-0.06570738916072205,-0.0652269977759913,-0.04850540220146462,-0.04711613227458127,-0.047816301954024344,-0.28777610224360545,-0.17815885014261246,-0.16466902109782183]   |0         |[0.4524562568196239,0.123125340073428,-1.1775177431863195,0.17950185222474435,-0.6623251832008805,-0.006534778277068013]   |\n|00023623|1           |63  |106400.0   |122683.0   |44               |0          |0.0          |0                           |0.0                     |0.0                   |0.0                         |0.0               |0                     |0           |0           |0           |0           |0           |0           |0              |0               |0           |0.0                      |0                  |0.0                |(25,[0,1,2,3,4],[1.0,63.0,106400.0,122683.0,44.0])                        |[-0.7858441243939626,1.3083804290293262,0.05089635132726361,0.04033304274297675,7.070379314734266,-0.1738451720953279,-0.026189741828995982,-0.08026345010436206,-0.009242149170244249,-0.007813492398657631,-0.005558846720903417,-0.6690300621849241,-0.7940176737047439,-0.09134567779980213,-0.10105711808528435,-0.09528982375700086,-0.09131973518764257,-0.06570738916072205,-0.0652269977759913,-0.04850540220146462,-0.04711613227458127,-0.047816301954024344,-0.28777610224360545,-0.17815885014261246,-0.16466902109782183]        |1         |[-0.4562740666000289,0.49301700792186565,2.1271194966943945,-0.15350385099438613,0.19006061809847724,-0.02739274075177908] |\n|00023654|1           |108 |0.0        |0.0        |0                |0          |0.0          |18                          |568.54                  |88.73000000000002     |0.0                         |0.0               |0                     |0           |0           |0           |0           |0           |0           |0              |0               |0           |0.0                      |0                  |0.0                |(25,[0,1,7,8,9],[1.0,108.0,18.0,568.54,88.73000000000002])                |[-0.7858441243939626,4.020526705390299,-0.0032257184379377093,-0.00416249354344102,-0.5539553129042483,-0.1738451720953279,-0.026189741828995982,0.5790408091114203,0.0028281250977135737,0.006376485974584598,-0.005558846720903417,-0.6690300621849241,-0.7940176737047439,-0.09134567779980213,-0.10105711808528435,-0.09528982375700086,-0.09131973518764257,-0.06570738916072205,-0.0652269977759913,-0.04850540220146462,-0.04711613227458127,-0.047816301954024344,-0.28777610224360545,-0.17815885014261246,-0.16466902109782183]      |0         |[0.3813780677958739,0.17663454846359708,-1.0404747983408016,0.20801501030300104,-0.7640953795305385,0.041596689735018594]  |\n|00024005|1           |56  |0.0        |0.0        |0                |0          |0.0          |0                           |0.0                     |0.0                   |0.0                         |0.0               |1                     |0           |0           |0           |0           |0           |0           |0              |0               |0           |0.0                      |0                  |0.0                |(25,[0,1,12],[1.0,56.0,1.0])                                              |[-0.7858441243939626,0.8864910082620637,-0.0032257184379377093,-0.00416249354344102,-0.5539553129042483,-0.1738451720953279,-0.026189741828995982,-0.08026345010436206,-0.009242149170244249,-0.007813492398657631,-0.005558846720903417,-0.6690300621849241,0.2077322216886156,-0.09134567779980213,-0.10105711808528435,-0.09528982375700086,-0.09131973518764257,-0.06570738916072205,-0.0652269977759913,-0.04850540220146462,-0.04711613227458127,-0.047816301954024344,-0.28777610224360545,-0.17815885014261246,-0.16466902109782183]   |0         |[0.3885152274067804,0.18853429912375935,-0.6848955261941334,0.15708564296670807,-0.5591924341139685,-0.020353527522991178] |\n|00027447|1           |60  |0.0        |0.0        |0                |0          |0.0          |1                           |113.5                   |0.0                   |0.0                         |0.0               |0                     |0           |0           |0           |0           |0           |0           |0              |0               |0           |0.0                      |0                  |0.0                |(25,[0,1,7,8],[1.0,60.0,1.0,113.5])                                       |[-0.7858441243939626,1.127570677271928,-0.0032257184379377093,-0.00416249354344102,-0.5539553129042483,-0.1738451720953279,-0.026189741828995982,-0.04363543570348526,-0.00683251021887194,-0.007813492398657631,-0.005558846720903417,-0.6690300621849241,-0.7940176737047439,-0.09134567779980213,-0.10105711808528435,-0.09528982375700086,-0.09131973518764257,-0.06570738916072205,-0.0652269977759913,-0.04850540220146462,-0.04711613227458127,-0.047816301954024344,-0.28777610224360545,-0.17815885014261246,-0.16466902109782183]    |0         |[0.4472330445006315,0.12699273949318823,-1.1675670280130932,0.18156670267368713,-0.6696931578874776,-0.011917484734293441] |\n+--------+------------+----+-----------+-----------+-----------------+-----------+-------------+----------------------------+------------------------+----------------------+----------------------------+------------------+----------------------+------------+------------+------------+------------+------------+------------+---------------+----------------+------------+-------------------------+-------------------+-------------------+--------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------------------------------------------------------------------------------------------------------------------------+\nonly showing top 20 rows"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0554<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0554/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0554/</a>"}]},"apps":[],"jobName":"paragraph_1550861755866_-1224320498","id":"20190222-135555_1226638597","dateCreated":"2019-02-22T13:55:55-0500","dateStarted":"2019-03-05T09:23:18-0500","dateFinished":"2019-03-05T09:23:52-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:94534"},{"text":"%livy2.pyspark\nmodel.explainedVariance","user":"eyupanqui","dateUpdated":"2019-03-05T09:25:03-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DenseVector([0.1986, 0.1313, 0.1015, 0.0767, 0.0765, 0.0696])"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0554<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0554/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0554/</a>"}]},"apps":[],"jobName":"paragraph_1551794651176_-18669057","id":"20190305-090411_1411011847","dateCreated":"2019-03-05T09:04:11-0500","dateStarted":"2019-03-05T09:25:03-0500","dateFinished":"2019-03-05T09:25:04-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:94535"},{"text":"%livy2.pyspark\nresult.write.format(\"parquet\").saveAsTable(\"ds12_potenciales_contribuyentes.md_matriz_PCA\")","user":"eyupanqui","dateUpdated":"2019-03-05T09:35:18-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0554<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0554/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0554/</a>"}]},"apps":[],"jobName":"paragraph_1551796475883_1455878076","id":"20190305-093435_810196412","dateCreated":"2019-03-05T09:34:35-0500","dateStarted":"2019-03-05T09:35:18-0500","dateFinished":"2019-03-05T09:35:59-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:94536"},{"text":"%livy2.pyspark\nfrom pyspark.ml.linalg import Vectors\nfrom pyspark.ml.feature import (VectorSizeHint, VectorAssembler)\n\ndataset = spark.createDataFrame(\n    [(0, 18, 1.0, Vectors.dense([0.0, 10.0, 0.5]), 1.0),\n     (0, 18, 1.0, Vectors.dense([0.0, 10.0]), 0.0)],\n    [\"id\", \"hour\", \"mobile\", \"userFeatures\", \"clicked\"])\n\nsizeHint = VectorSizeHint(\n    inputCol=\"userFeatures\",\n    handleInvalid=\"skip\",\n    size=3)\n\ndatasetWithSize = sizeHint.transform(dataset)\nprint(\"Rows where 'userFeatures' is not the right size are filtered out\")\ndatasetWithSize.show(truncate=False)\n\nassembler = VectorAssembler(\n    inputCols=[\"hour\", \"mobile\", \"userFeatures\"],\n    outputCol=\"features\")\n\n# This dataframe can be used by downstream transformers as before\noutput = assembler.transform(datasetWithSize)\nprint(\"Assembled columns 'hour', 'mobile', 'userFeatures' to vector column 'features'\")\noutput.select(\"features\", \"clicked\").show(truncate=False)\n","user":"eyupanqui","dateUpdated":"2019-03-05T09:30:21-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"cannot import name 'VectorSizeHint'\nTraceback (most recent call last):\nImportError: cannot import name 'VectorSizeHint'\n"}]},"apps":[],"jobName":"paragraph_1551794982958_-1506469507","id":"20190305-090942_1938120412","dateCreated":"2019-03-05T09:09:42-0500","dateStarted":"2019-03-05T09:30:07-0500","dateFinished":"2019-03-05T09:30:08-0500","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:94537"},{"text":"%livy2.pyspark\nmodel.explainedVariance\n\n","user":"eyupanqui","dateUpdated":"2019-03-05T09:13:14-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DenseVector([0.7944, 0.2056])"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1550675027106_0554<br/>Spark WebUI: <a href=\"http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0554/\">http://srvhadoop01.example.com:8088/proxy/application_1550675027106_0554/</a>"}]},"apps":[],"jobName":"paragraph_1551795066085_-142595953","id":"20190305-091106_1426879811","dateCreated":"2019-03-05T09:11:06-0500","dateStarted":"2019-03-05T09:13:14-0500","dateFinished":"2019-03-05T09:13:15-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:94538"},{"text":"%livy2.pyspark","user":"eyupanqui","dateUpdated":"2019-03-05T09:13:43-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1551795183589_1445833042","id":"20190305-091303_823970250","dateCreated":"2019-03-05T09:13:03-0500","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:94539"}],"name":"Users/eyupanqui/02pc_cluster","id":"2E6URJYA1","angularObjects":{"2CHS8UYQQ:shared_process":[],"2CKX6DGQZ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2CKX8WPU1:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2DA37NKGE:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}